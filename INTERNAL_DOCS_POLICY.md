# 内部文档管理规范

> **版本**: v1.0
> **创建日期**: 2025-11-11
> **适用于**: NeteaseMod-Claude 工作流内部维护

---

## 📋 目录结构分类

```
NeteaseMod-Claude/
├── markdown/                          # ✅ 公开发布（工作流知识库）
├── templates/                         # ✅ 公开发布（下游项目模板）
├── docs/                              # ✅ 公开发布（Git Submodule，官方文档）
├── lib/                               # ✅ 公开发布（核心库）
├── bin/                               # ✅ 公开发布（CLI工具）
├── README.md                          # ✅ 公开发布
├── CLAUDE.md                          # ✅ 公开发布
├── CHANGELOG.md                       # ✅ 公开发布
├── 开发包文档分析报告/               # ❌ 不发布（已添加到.gitignore）
├── *.internal.md                      # ❌ 不发布（内部笔记）
├── .internal-docs/                    # ❌ 不发布（其他内部资料）
├── 工作流系统性检查报告-*.md         # ❌ 不发布（内部检查报告）
├── 文档法律合规检查报告-*.md         # ❌ 不发布（内部合规报告）
├── 立即执行修复-完成报告.md          # ❌ 不发布（内部执行记录）
└── INTERNAL_DOCS_POLICY.md            # 本文件

```

---

## 🎯 分类规则

### ✅ 可公开发布

**核心内容**：
- `markdown/` - 工作流知识库（AI工作流指南、开发规范等）
- `templates/` - 下游MODSDK项目模板
- `docs/` - 官方文档（Git Submodule）
- `lib/`, `bin/` - 工作流生成器代码
- `README.md`, `CLAUDE.md`, `CHANGELOG.md` - 用户文档

**发布原则**：
- ✅ 内容基于官方文档或行业最佳实践
- ✅ 不包含任何反编译、逆向工程等敏感表述
- ✅ 不包含本地路径、敏感信息
- ✅ 不包含第三方版权内容

---

### ❌ 仅供内部参考

**禁止发布内容**：
- `开发包文档分析报告/` - 包含反编译分析结果
- `*.internal.md` - 内部笔记和草稿
- `.internal-docs/` - 其他内部资料
- `工作流系统性检查报告-*.md` - 内部质量检查报告
- `文档法律合规检查报告-*.md` - 内部合规审查
- `立即执行修复-完成报告.md` - 内部执行记录
- `检查报告索引.md` - 内部报告索引

**不发布原因**：
- 🔴 包含反编译、逆向工程等法律风险表述
- 🔴 包含本地文件路径（如 `D:\EcWork\3.5`）
- 🔴 包含内部开发过程记录（无用户价值）
- 🔴 可能包含敏感技术细节

---

## 🛡️ 发布前检查清单

### 检查1: 搜索禁止表述

```bash
# 在可发布目录中搜索禁止表述
grep -r "根据反编译\|逆向工程\|D:\\EcWork\\3\.5\|源码分析\|反编译代码" markdown/ templates/

# 预期结果: （无匹配结果）
# 如发现匹配: 必须修改或删除相关内容
```

**禁止表述列表**：
- ❌ "根据反编译"
- ❌ "逆向工程"
- ❌ "源码分析"
- ❌ "反编译代码"
- ❌ 本地路径（如 `D:\EcWork\3.5`）

---

### 检查2: 确认内部文件已隔离

```bash
# 检查Git跟踪的文件中是否包含内部文件
git ls-files | grep -i "开发包文档分析报告\|internal\|分析报告\|系统性检查报告\|合规检查报告\|修复-完成报告"

# 预期结果: （无匹配结果）
# 如发现匹配: 必须添加到.gitignore
```

---

### 检查3: 验证本地文件仍存在

```bash
# 确认内部文件在本地仍然可用（供维护者参考）
ls -la "开发包文档分析报告/" 2>/dev/null || echo "内部报告目录不存在"
ls -la 工作流系统性检查报告-*.md 2>/dev/null || echo "系统检查报告不存在"

# 预期结果: 显示文件列表（8个文件+报告）
```

---

### 检查4: 确认.gitignore生效

```bash
# 检查Git状态，确认内部文件未显示
git status

# 预期结果: 不应显示以下内容
#   - 开发包文档分析报告/
#   - *.internal.md
#   - 工作流系统性检查报告-*.md
#   - 文档法律合规检查报告-*.md
#   - 立即执行修复-完成报告.md
```

---

## 🔄 长期合规机制

### 自动化检查（CI/CD）

在 `.github/workflows/compliance-check.yml` 中添加自动检查（详见本项目CI/CD配置）。

**检查内容**：
1. ✅ 禁止表述检查（防止违规内容推送）
2. ✅ 敏感文件检查（防止内部文件泄露）
3. ✅ 路径检查（防止本地路径暴露）

---

## 📝 内部文档编写规范

### 规则1: 内部文档命名规范

**推荐格式**：
- `{主题}-{日期}.internal.md` - 临时内部笔记
- `{主题}-{日期}.md` - 永久内部报告（添加到.gitignore）

**示例**：
- ✅ `工作流系统性检查报告-20251111.md`
- ✅ `开发包文档分析.internal.md`
- ❌ `分析报告.md` （不明确，容易遗漏）

---

### 规则2: 内部文档存放位置

**目录规则**：
- 📁 `开发包文档分析报告/` - 反编译分析相关
- 📁 `.internal-docs/` - 其他内部资料
- 📄 根目录下的 `*.internal.md` 或 `*报告-*.md` - 临时报告

**全部添加到.gitignore**。

---

### 规则3: 内部文档顶部声明

在内部文档顶部添加声明（推荐）：

```markdown
> ⚠️ **内部文档 - 禁止公开发布**
>
> 本文档包含内部开发过程记录/敏感技术细节/反编译分析结果。
> 仅供工作流维护者参考，不得推送到公开仓库。
```

---

## 📚 可公开文档编写规范

### 规则1: 内容来源合法

**允许来源**：
- ✅ 网易MODSDK官方文档（docs/ submodule）
- ✅ 软件工程最佳实践（ECS架构、设计模式等）
- ✅ 行业通用知识（Python语法、Git使用等）
- ✅ 个人经验总结（基于官方文档的实践）

**禁止来源**：
- ❌ 反编译结果
- ❌ 逆向工程分析
- ❌ 第三方版权内容（未经授权）

---

### 规则2: 添加文档来源声明（可选）

在核心文档顶部添加声明（增强合规性）：

```markdown
<!--
📋 文档来源声明
本文档基于网易MODSDK官方文档和软件工程最佳实践编写。
所有技术内容均源自官方API文档或行业通用知识。
-->
```

---

### 规则3: 避免敏感表述

**禁止表述**：
- ❌ "根据反编译"、"逆向工程"
- ❌ "分析源码发现"、"反编译代码显示"
- ❌ 本地路径（如 `D:\EcWork\3.5`）

**推荐表述**：
- ✅ "根据官方文档"
- ✅ "参考MODSDK Wiki"
- ✅ "软件工程最佳实践"

---

## 🔍 常见问题（FAQ）

### Q1: 如何判断一个文档是否可以公开发布？

**检查清单**：
1. ✅ 内容来源合法（官方文档、最佳实践）
2. ✅ 不包含反编译、逆向工程表述
3. ✅ 不包含本地路径、敏感信息
4. ✅ 对用户有实际价值（非内部流程记录）

**如果全部满足**：可以发布
**如果任一不满足**：添加到.gitignore

---

### Q2: 内部报告需要保留多久？

**推荐策略**：
- 📁 `开发包文档分析报告/` - 永久保留（供参考）
- 📄 `*检查报告-*.md` - 保留1年后归档
- 📄 `*.internal.md` - 任务完成后可删除

---

### Q3: 如果不小心推送了敏感内容怎么办？

**紧急处理流程**：
1. ⚠️ 立即使用 `git filter-branch` 或 `git filter-repo` 从历史中删除
2. ⚠️ 强制推送到远程仓库（`git push --force`）
3. ⚠️ 通知所有协作者重新克隆仓库
4. ⚠️ 在GitHub上检查Releases是否包含敏感内容

**预防措施**：
- ✅ 始终运行发布前检查清单
- ✅ 启用CI/CD自动检查
- ✅ 定期审查Git历史

---

## 🎯 总结

### 核心原则

1. **双层隔离**：公开内容与内部内容严格分离
2. **自动化检查**：CI/CD防止违规内容推送
3. **定期审查**：每次发布前运行检查清单

### 关键操作

- ✅ 新建内部文档：使用 `.internal.md` 或添加到专用目录
- ✅ 发布前检查：运行本文档的检查清单
- ✅ 定期审查：每月检查.gitignore是否完整

---

**文档版本**: v1.0
**创建日期**: 2025-11-11
**维护者**: NeteaseMod-Claude 项目组

---

**相关资源**：
- [CLAUDE.md](./CLAUDE.md) - 工作流开发指南
- [.gitignore](./.gitignore) - Git忽略规则
- [.github/workflows/compliance-check.yml](./.github/workflows/compliance-check.yml) - CI/CD合规检查
