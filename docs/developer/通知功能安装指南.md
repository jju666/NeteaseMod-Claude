# é€šçŸ¥åŠŸèƒ½å®‰è£…æŒ‡å—

## ğŸ“Œ å¿«é€Ÿè¯´æ˜

ä» v18.4+ ç‰ˆæœ¬å¼€å§‹,MODSDK å·¥ä½œæµçš„ Hooks æ”¯æŒæ¡Œé¢é€šçŸ¥åŠŸèƒ½ã€‚é€šçŸ¥ç³»ç»ŸåŸºäº `vscode_notify.py` æ¨¡å—å®ç°,æä¾›è·¨å¹³å°çš„ç³»ç»Ÿçº§é€šçŸ¥ã€‚

## ğŸ”” é€šçŸ¥æ¨¡å—æ¶æ„

**æ ¸å¿ƒæ¨¡å—**: `templates/.claude/hooks/vscode_notify.py`

**é€šçŸ¥ç­–ç•¥**:
1. **é¦–é€‰**: ä½¿ç”¨ `plyer` åº“å‘é€ç³»ç»ŸåŸç”Ÿé€šçŸ¥ (Windows/macOS/Linux)
2. **é™çº§**: å¦‚æœ plyer ä¸å¯ç”¨,è‡ªåŠ¨é™çº§ä¸ºå½©è‰²ç»ˆç«¯è¾“å‡º

**ä¸‰ä¸ªé€šçŸ¥çº§åˆ«**:
- `notify_info()` - ä¿¡æ¯çº§åˆ« (è“è‰²å›¾æ ‡)
- `notify_warning()` - è­¦å‘Šçº§åˆ« (é»„è‰²å›¾æ ‡)
- `notify_error()` - é”™è¯¯çº§åˆ« (çº¢è‰²å›¾æ ‡)

## âœ… å®‰è£…æ–¹å¼

### æ‰€æœ‰ç”¨æˆ· (æ¨èå®‰è£… plyer)

ä¸ºäº†è·å¾—æœ€ä½³ä½“éªŒ,å»ºè®®å®‰è£… `plyer` åº“ä»¥å¯ç”¨ç³»ç»ŸåŸç”Ÿé€šçŸ¥å¼¹çª—:

#### Windows

æ‰“å¼€å‘½ä»¤æç¤ºç¬¦(CMD)æˆ– PowerShell,æ‰§è¡Œ:

```bash
pip install plyer
```

#### macOS

æ‰“å¼€ç»ˆç«¯,æ‰§è¡Œ:

```bash
pip install plyer
```

#### Linux

æ‰“å¼€ç»ˆç«¯,æ‰§è¡Œ:

```bash
# å®‰è£… plyer
pip install plyer

# Linux è¿˜éœ€è¦å®‰è£… libnotify (å¦‚æœå°šæœªå®‰è£…)
# Ubuntu/Debian:
sudo apt-get install libnotify-bin

# Fedora/CentOS:
sudo yum install libnotify

# Arch Linux:
sudo pacman -S libnotify
```

**æ³¨æ„**: å³ä½¿ä¸å®‰è£… plyer,é€šçŸ¥ç³»ç»Ÿä»ä¼šå·¥ä½œ,åªæ˜¯ä¼šé™çº§ä¸ºç»ˆç«¯å½©è‰²è¾“å‡ºã€‚

## ğŸ§ª æµ‹è¯•é€šçŸ¥

å®‰è£…å®Œæˆå,è¿è¡Œæµ‹è¯•è„šæœ¬éªŒè¯:

```bash
python templates/.claude/hooks/vscode_notify.py
```

**é¢„æœŸç»“æœ**:
- å±å¹•å³ä¸‹è§’å¼¹å‡º 3 ä¸ªç³»ç»Ÿé€šçŸ¥
- ç»ˆç«¯è¾“å‡ºç¯å¢ƒæ£€æµ‹ä¿¡æ¯

## ğŸ” æ•…éšœæ’æŸ¥

### Windows: æ²¡æœ‰çœ‹åˆ°é€šçŸ¥å¼¹çª—

1. æ‰“å¼€"è®¾ç½®" â†’ "ç³»ç»Ÿ" â†’ "é€šçŸ¥å’Œæ“ä½œ"
2. æ‰¾åˆ° "Python" æˆ– "Windows Terminal"
3. ç¡®ä¿å¼€å¯äº†"æ˜¾ç¤ºé€šçŸ¥æ¨ªå¹…"

### macOS: æ²¡æœ‰çœ‹åˆ°é€šçŸ¥

1. æ‰“å¼€"ç³»ç»Ÿåå¥½è®¾ç½®" â†’ "é€šçŸ¥"
2. æ‰¾åˆ°"ç»ˆç«¯"æˆ–"Python"
3. ç¡®ä¿å…è®¸é€šçŸ¥

### Linux: æ²¡æœ‰çœ‹åˆ°é€šçŸ¥

ç¡®ä¿ `notify-send` å·²å®‰è£…å¹¶å¯ç”¨:

```bash
# æµ‹è¯• notify-send
notify-send "æµ‹è¯•" "Hello World"

# å¦‚æœå¤±è´¥,å®‰è£… libnotify
sudo apt-get install libnotify-bin  # Ubuntu/Debian
```

### plyer å®‰è£…å¤±è´¥

å¦‚æœ pip å®‰è£…å¤±è´¥,å°è¯•:

```bash
# æ–¹æ¡ˆ1: ä½¿ç”¨ --user æ ‡å¿—
pip install --user plyer

# æ–¹æ¡ˆ2: å‡çº§ pip
python -m pip install --upgrade pip
pip install plyer

# æ–¹æ¡ˆ3: ä½¿ç”¨å›½å†…é•œåƒ(å¦‚æœç½‘ç»œé—®é¢˜)
pip install -i https://pypi.tuna.tsinghua.edu.cn/simple plyer
```

## ğŸ“‹ é€šçŸ¥è§¦å‘åœºæ™¯

åŸºäºå®é™…ä»£ç åˆ†æ,ä»¥ä¸‹æ˜¯å®Œæ•´çš„é€šçŸ¥è§¦å‘ç‚¹:

| åºå· | è§¦å‘æ—¶æœº | é€šçŸ¥çº§åˆ« | Hookæ–‡ä»¶ | å®ç°ä½ç½® |
|------|---------|---------|---------|---------|
| 1 | æ‰§è¡Œ `/mc` å‘½ä»¤å¯åŠ¨ä»»åŠ¡ | ä¿¡æ¯ | user-prompt-submit-hook.py | line 636, 673 |
| 2 | å·¥ä½œæµæ­¥éª¤å®Œæˆ | ä¿¡æ¯ | unified-workflow-driver.py | line 1040 |
| 3 | ä»»åŠ¡å¤±è´¥ 1 æ¬¡ | è­¦å‘Š | stop-hook.py | line 129 |
| 4 | ä»»åŠ¡è¿ç»­å¤±è´¥è§¦å‘ä¸“å®¶ | é”™è¯¯ | stop-hook.py | line 145 |
| 5 | ä»»åŠ¡å®Œæˆå¹¶å½’æ¡£ | ä¿¡æ¯ | stop-hook.py | line 215 |
| 6 | ä¸“å®¶è¯Šæ–­è¢«æ¨è | è­¦å‘Š | unified-workflow-driver.py | line 980 |
| 7 | ä¸“å®¶å®¡æŸ¥å·²è§¦å‘ | è­¦å‘Š | unified-workflow-driver.py | line 1080 |
| 8 | é˜…è¯»ç¬¬3ä¸ªæ–‡æ¡£å | ä¿¡æ¯ | track-doc-reading.py | line 161 |
| 9 | ä»»åŠ¡æ–‡æ¡£æ›´æ–° | ä¿¡æ¯ | log-changes.py | line 61 |

**é€šçŸ¥å†…å®¹ç¤ºä¾‹**:
- `notify_info("Step completed", "Current: step1_understand â†’ Next: step3_execute")`
- `notify_warning("ä»»åŠ¡æœªå®Œæˆ(å¤±è´¥ 1 æ¬¡)", "ä¼šè¯å·²è¢«é˜»æ­¢")`
- `notify_error("ä¸“å®¶å®¡æŸ¥å·²è§¦å‘", "å¾ªç¯ç±»å‹: bug_fix_loop | ç½®ä¿¡åº¦: 90%")`

## ğŸ“– ä¸å®‰è£… plyer ä¼šæ€æ ·?

**å®Œå…¨å¯ä»¥æ­£å¸¸å·¥ä½œ!** å³ä½¿ä¸å®‰è£… plyer,é€šçŸ¥ç³»ç»Ÿä¼šè‡ªåŠ¨é™çº§:

### é™çº§ç­–ç•¥ (vscode_notify.py å®ç°)

1. **å½©è‰²ç»ˆç«¯è¾“å‡º**: ä½¿ç”¨ ANSI è½¬ä¹‰ç æ˜¾ç¤ºå½©è‰²æ–‡æœ¬
2. **Emoji å›¾æ ‡**: å¢å¼ºå¯è¯»æ€§
   - â„¹ï¸ (info) - è“è‰²æ–‡å­—
   - âš ï¸ (warning) - é»„è‰²æ–‡å­—
   - âŒ (error) - çº¢è‰²æ–‡å­—
3. **æ‰€æœ‰ä¿¡æ¯å®Œæ•´æ˜¾ç¤º**: åŠŸèƒ½ä¸å—å½±å“,åªæ˜¯æ˜¾ç¤ºæ–¹å¼ä¸åŒ

### é™çº§è¾“å‡ºç¤ºä¾‹

```bash
â„¹ï¸ ä»»åŠ¡è¿½è¸ªå·²åˆå§‹åŒ– - ä»»åŠ¡ID: task-20251113-143022
âš ï¸ ä»»åŠ¡æœªå®Œæˆ(å¤±è´¥ 1 æ¬¡) - ä¼šè¯å·²è¢«é˜»æ­¢
âŒ ä¸“å®¶å®¡æŸ¥å·²è§¦å‘ - å¾ªç¯ç±»å‹: bug_fix_loop
```

### ç³»ç»ŸåŸç”Ÿé€šçŸ¥ vs ç»ˆç«¯è¾“å‡ºå¯¹æ¯”

| ç‰¹æ€§ | ç³»ç»Ÿé€šçŸ¥ (plyer) | ç»ˆç«¯è¾“å‡º (é™çº§) |
|------|-----------------|----------------|
| å®‰è£…è¦æ±‚ | éœ€è¦ pip install plyer | æ— éœ€å®‰è£… |
| æ˜¾ç¤ºä½ç½® | ç³»ç»Ÿé€šçŸ¥ä¸­å¿ƒ | ç»ˆç«¯çª—å£ |
| æŒä¹…åŒ– | 5ç§’åè‡ªåŠ¨æ¶ˆå¤± | æ°¸ä¹…ä¿ç•™åœ¨ç»ˆç«¯ |
| è·¨çª—å£å¯è§ | âœ… æ˜¯ | âŒ å¦ (ä»…å½“å‰ç»ˆç«¯) |
| é€‚ç”¨åœºæ™¯ | åå°è¿è¡Œä»»åŠ¡æé†’ | å¼€å‘è°ƒè¯•æ—¶ |

## ğŸ”§ æŠ€æœ¯å®ç°ç»†èŠ‚

### vscode_notify.py æ ¸å¿ƒé€»è¾‘

```python
def notify(level, message, detail=""):
    """é€šçŸ¥ç­–ç•¥:
    1. plyeråº“å¯ç”¨ â†’ ç³»ç»ŸåŸç”Ÿé€šçŸ¥
    2. é™çº§ â†’ å½©è‰²ç»ˆç«¯è¾“å‡º
    """
    if HAS_PLYER:
        plyer_notify.notify(
            title="Claude Code - {}".format(level.upper()),
            message=safe_message,
            app_name="Claude Code Hooks",
            timeout=5
        )
    else:
        notify_fallback(level, message, detail)  # å½©è‰²ç»ˆç«¯è¾“å‡º
```

### åœ¨ Hooks ä¸­ä½¿ç”¨é€šçŸ¥

```python
# unified-workflow-driver.py ç¤ºä¾‹
from vscode_notify import notify_info, notify_warning

# æ­¥éª¤å®Œæˆé€šçŸ¥
notify_info(
    "Step completed",
    "Current: {} â†’ Next: {}".format(current_step, next_step_desc)
)

# ä¸“å®¶å®¡æŸ¥è§¦å‘é€šçŸ¥
notify_warning(
    "ä¸“å®¶å®¡æŸ¥å·²è§¦å‘",
    "å¾ªç¯ç±»å‹: {} | ç½®ä¿¡åº¦: {:.0%}".format(loop_type, confidence)
)
```

### å¼‚å¸¸å¤„ç†æœºåˆ¶

æ‰€æœ‰é€šçŸ¥è°ƒç”¨éƒ½åŒ…è£…åœ¨ try-except å—ä¸­,ç¡®ä¿é€šçŸ¥å¤±è´¥ä¸ä¼šå½±å“ Hook æ‰§è¡Œ:

```python
try:
    from vscode_notify import notify_info
except ImportError:
    def notify_info(msg, detail=""): pass  # é™çº§ä¸ºç©ºæ“ä½œ
```

## ğŸ“š æ›´å¤šä¿¡æ¯

- [é€šçŸ¥ç³»ç»Ÿè®¾è®¡æ–‡æ¡£](./é€šçŸ¥ç³»ç»Ÿ.md) - ç³»ç»Ÿæ¶æ„ä¸è§¦å‘ç‚¹è¯´æ˜
- [Hookæœºåˆ¶æ–‡æ¡£](./Hookæœºåˆ¶.md) - Hookç³»ç»Ÿå®Œæ•´è¯´æ˜
- [æŠ€æœ¯æ¶æ„æ–‡æ¡£](./æŠ€æœ¯æ¶æ„.md) - æ•´ä½“ç³»ç»Ÿè®¾è®¡

---

**ç‰ˆæœ¬**: v20.2.8
**æœ€åæ›´æ–°**: 2025-11-14
