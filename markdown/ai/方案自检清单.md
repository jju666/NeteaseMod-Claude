# MODSDKæ–¹æ¡ˆè‡ªæ£€æ¸…å•

> **AIå·¥ä½œæµè¡¥å……æ–‡æ¡£**
>
> åœ¨å®æ–½æ–¹æ¡ˆå‰å¿…é¡»æ‰§è¡Œçš„è´¨é‡æ£€æŸ¥æ¸…å•ï¼Œé˜²æ­¢90%å¸¸è§é”™è¯¯
>
> **æœ€åæ›´æ–°**: 2025-11-11
> **æ–‡æ¡£ç‰ˆæœ¬**: 1.0

---

## ğŸ“‹ ç›®å½•

1. [è‡ªæ£€æµç¨‹æ¦‚è¿°](#è‡ªæ£€æµç¨‹æ¦‚è¿°)
2. [æ£€æŸ¥é¡¹1: CRITICALè§„èŒƒéªŒè¯](#æ£€æŸ¥é¡¹1-criticalè§„èŒƒéªŒè¯)
3. [æ£€æŸ¥é¡¹2: åŒç«¯éš”ç¦»éªŒè¯](#æ£€æŸ¥é¡¹2-åŒç«¯éš”ç¦»éªŒè¯)
4. [æ£€æŸ¥é¡¹3: äº‹ä»¶/APIå­˜åœ¨æ€§éªŒè¯](#æ£€æŸ¥é¡¹3-äº‹ä»¶apiå­˜åœ¨æ€§éªŒè¯)
5. [æ£€æŸ¥é¡¹4: æ•°æ®æµå®Œæ•´æ€§](#æ£€æŸ¥é¡¹4-æ•°æ®æµå®Œæ•´æ€§)
6. [æ£€æŸ¥é¡¹5: æœ€ä½³å®è·µéµå¾ª](#æ£€æŸ¥é¡¹5-æœ€ä½³å®è·µéµå¾ª)
7. [è‡ªæ£€æŠ¥å‘Šæ¨¡æ¿](#è‡ªæ£€æŠ¥å‘Šæ¨¡æ¿)
8. [å¤„ç†å†³ç­–é€»è¾‘](#å¤„ç†å†³ç­–é€»è¾‘)

---

## ğŸ” è‡ªæ£€æµç¨‹æ¦‚è¿°

### ä½•æ—¶æ‰§è¡Œè‡ªæ£€ï¼Ÿ

**å¿…é¡»æ‰§è¡Œ**ï¼š
- âœ… è®¾è®¡å®Œæ–°åŠŸèƒ½æ–¹æ¡ˆå
- âœ… æå‡ºBugä¿®å¤æ–¹æ¡ˆå
- âœ… æäº¤ç»™ç”¨æˆ·å®¡é˜…ä¹‹å‰

**è‡ªæ£€ç›®æ ‡**ï¼š
- ğŸ¯ éªŒè¯æ–¹æ¡ˆç¬¦åˆMODSDKå¼€å‘è§„èŒƒ
- ğŸ¯ ç¡®ä¿ä¸è¿åCRITICALè§„èŒƒï¼ˆé˜²æ­¢90%é”™è¯¯ï¼‰
- ğŸ¯ æ£€æŸ¥æ•°æ®æµè®¾è®¡åˆç†æ€§
- ğŸ¯ å‘ç°æ½œåœ¨é—®é¢˜ï¼Œæå‰ä¿®æ­£

### è‡ªæ£€æµç¨‹å›¾

```
è®¾è®¡æ–¹æ¡ˆå®Œæˆ
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ£€æŸ¥é¡¹1: CRITICALè§„èŒƒ â”‚ â†’ å†…å­˜æ£€æŸ¥ï¼ˆå›é¡¾æ–¹æ¡ˆè®¾è®¡ï¼‰
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ£€æŸ¥é¡¹2: åŒç«¯éš”ç¦»    â”‚ â†’ å†…å­˜æ£€æŸ¥ + ç«¯åˆ«æ ‡è®°éªŒè¯
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ£€æŸ¥é¡¹3: äº‹ä»¶/APIå­˜åœ¨ â”‚ â†’ æŸ¥è¯¢ç´¢å¼•è¡¨ï¼ˆ2æ¬¡Grepï¼‰
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ£€æŸ¥é¡¹4: æ•°æ®æµå®Œæ•´æ€§â”‚ â†’ é€»è¾‘æ£€æŸ¥ï¼ˆç»˜åˆ¶æ•°æ®æµå›¾ï¼‰
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ£€æŸ¥é¡¹5: æœ€ä½³å®è·µ    â”‚ â†’ é€»è¾‘æ£€æŸ¥ï¼ˆå‘½åã€æ€§èƒ½ç­‰ï¼‰
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â†“
ç”Ÿæˆè‡ªæ£€æŠ¥å‘Š
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æœ‰é”™è¯¯é¡¹ï¼Ÿ        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ âœ… æ˜¯ â†’ è‡ªåŠ¨ä¿®æ­£ â”‚
â”‚ âš ï¸ åªæœ‰è­¦å‘Š â†’ æ ‡æ³¨é£é™©ç‚¹ â”‚
â”‚ âŒ å…¨éƒ¨é€šè¿‡ â†’ ç»§ç»­æµç¨‹ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## âœ… æ£€æŸ¥é¡¹1: CRITICALè§„èŒƒéªŒè¯

### ç›®æ ‡

éªŒè¯æ–¹æ¡ˆæ˜¯å¦è¿å4ä¸ªCRITICALè§„èŒƒï¼Œè¿™äº›è§„èŒƒæ˜¯MODSDKæœ€å®¹æ˜“è¸©çš„å‘ã€‚

### æ£€æŸ¥å†…å®¹

#### è§„èŒƒ1: åŒç«¯éš”ç¦»åŸåˆ™ â­â­â­

**æ£€æŸ¥ç‚¹**ï¼š
- [ ] æ˜¯å¦åœ¨æœåŠ¡ç«¯Systemä¸­GetSystemè·å–å®¢æˆ·ç«¯Systemï¼Ÿ
- [ ] æ˜¯å¦åœ¨å®¢æˆ·ç«¯Systemä¸­GetSystemè·å–æœåŠ¡ç«¯Systemï¼Ÿ

**é”™è¯¯ç‰¹å¾**ï¼š
```python
# âŒ é”™è¯¯ç¤ºä¾‹1ï¼ˆåœ¨ServerSystemä¸­ï¼‰
class MyServerSystem(ServerSystem):
    def __init__(self, namespace, systemName):
        ServerSystem.__init__(self, namespace, systemName)
        # å°è¯•è·å–å®¢æˆ·ç«¯System
        self.clientSys = serverApi.GetSystem("MyMod", "MyClientSystem")  # è¿”å›None!
```

```python
# âŒ é”™è¯¯ç¤ºä¾‹2ï¼ˆåœ¨ClientSystemä¸­ï¼‰
class MyClientSystem(ClientSystem):
    def SomeMethod(self):
        # å°è¯•è·å–æœåŠ¡ç«¯System
        serverSys = clientApi.GetSystem("MyMod", "MyServerSystem")  # è¿”å›None!
```

**ä¿®æ­£æŒ‡å¯¼**ï¼š
```python
# âœ… æ­£ç¡®æ–¹å¼ - ä½¿ç”¨åŒç«¯é€šä¿¡
# æœåŠ¡ç«¯å‘é€äº‹ä»¶
class MyServerSystem(ServerSystem):
    def NotifyClient(self, playerId):
        data = self.CreateEventData()
        data["message"] = "Hello"
        self.NotifyToClient(playerId, "UpdateUI", data)

# å®¢æˆ·ç«¯ç›‘å¬äº‹ä»¶
class MyClientSystem(ClientSystem):
    def Create(self):
        self.ListenForEvent("MyMod", "MyServerSystem", "UpdateUI", self, self.OnUpdate)
```

**æ–‡æ¡£ä¾æ®**ï¼š
- CLAUDE.md: CRITICALè§„èŒƒ1ï¼ˆç¬¬21-36è¡Œï¼‰
- å¼€å‘è§„èŒƒ.md: ç¬¬2.1èŠ‚ï¼ˆç¬¬49-80è¡Œï¼‰
- é—®é¢˜æ’æŸ¥.md: é—®é¢˜1ï¼ˆç¬¬34-68è¡Œï¼‰

---

#### è§„èŒƒ2: Systemç”Ÿå‘½å‘¨æœŸé™åˆ¶ â­â­â­

**æ£€æŸ¥ç‚¹**ï¼š
- [ ] æ˜¯å¦åœ¨`__init__`ä¸­è°ƒç”¨GetComponentã€GetEntityï¼Ÿ
- [ ] æ˜¯å¦åœ¨`__init__`ä¸­è°ƒç”¨ListenForEventï¼Ÿ
- [ ] æ˜¯å¦æ‰‹åŠ¨è°ƒç”¨äº†Create()ï¼Ÿ

**é”™è¯¯ç‰¹å¾**ï¼š
```python
# âŒ é”™è¯¯ç¤ºä¾‹
class MySystem(ServerSystem):
    def __init__(self, namespace, systemName):
        ServerSystem.__init__(self, namespace, systemName)
        # åœ¨__init__ä¸­ç›´æ¥è°ƒç”¨API
        self.gameComp = serverApi.GetEngineCompFactory().CreateGame(levelId)  # è¿”å›None!
        self.ListenForEvent(...)  # å¯èƒ½å¤±è´¥
```

**ä¿®æ­£æŒ‡å¯¼**ï¼š
```python
# âœ… æ­£ç¡®æ–¹å¼
class MySystem(ServerSystem):
    def __init__(self, namespace, systemName):
        ServerSystem.__init__(self, namespace, systemName)
        self.gameComp = None  # åªå£°æ˜ï¼Œä¸åˆå§‹åŒ–
        self.Create()  # âš ï¸ æ‰‹åŠ¨è°ƒç”¨Create

    def Create(self):
        """âœ… åœ¨è¿™é‡Œåˆå§‹åŒ–ç»„ä»¶å’Œäº‹ä»¶ç›‘å¬"""
        levelId = serverApi.GetLevelId()
        self.gameComp = serverApi.GetEngineCompFactory().CreateGame(levelId)
        self.ListenForEvent(...)
```

**æ–‡æ¡£ä¾æ®**ï¼š
- CLAUDE.md: CRITICALè§„èŒƒ2ï¼ˆç¬¬39-58è¡Œï¼‰
- å¼€å‘è§„èŒƒ.md: ç¬¬2.2èŠ‚ï¼ˆç¬¬82-120è¡Œï¼‰
- é—®é¢˜æ’æŸ¥.md: é—®é¢˜2ï¼ˆç¬¬71-108è¡Œï¼‰

---

#### è§„èŒƒ3: EventDataåºåˆ—åŒ–é™åˆ¶ â­â­â­

**æ£€æŸ¥ç‚¹**ï¼š
- [ ] EventDataä¸­æ˜¯å¦ä½¿ç”¨äº†tupleç±»å‹ï¼Ÿ
- [ ] æ˜¯å¦ä½¿ç”¨listä»£æ›¿tupleï¼Ÿ

**é”™è¯¯ç‰¹å¾**ï¼š
```python
# âŒ é”™è¯¯ç¤ºä¾‹
def SendPositionToClient(self, playerId, pos):
    data = self.CreateEventData()
    data["position"] = (100, 64, 100)  # âŒ tupleä¸æ”¯æŒåºåˆ—åŒ–!
    self.NotifyToClient(playerId, "UpdatePos", data)
```

**ä¿®æ­£æŒ‡å¯¼**ï¼š
```python
# âœ… æ­£ç¡®æ–¹å¼
def SendPositionToClient(self, playerId, pos):
    data = self.CreateEventData()
    data["position"] = [100, 64, 100]  # âœ… ä½¿ç”¨list
    data["info"] = {"x": 100, "y": 64, "z": 100}  # âœ… ä½¿ç”¨dictä¹Ÿå¯ä»¥
    self.NotifyToClient(playerId, "UpdatePos", data)
```

**æ”¯æŒçš„ç±»å‹**ï¼š
- âœ… list - `[1, 2, 3]`
- âœ… dict - `{"key": "value"}`
- âœ… åŸºç¡€ç±»å‹ - `str`, `int`, `float`, `bool`
- âŒ tuple - `(1, 2, 3)` **ä¸æ”¯æŒ**

**æ–‡æ¡£ä¾æ®**ï¼š
- CLAUDE.md: CRITICALè§„èŒƒ3ï¼ˆç¬¬61-80è¡Œï¼‰
- å¼€å‘è§„èŒƒ.md: ç¬¬2.3èŠ‚ï¼ˆç¬¬122-150è¡Œï¼‰
- é—®é¢˜æ’æŸ¥.md: é—®é¢˜3ï¼ˆç¬¬110-140è¡Œï¼‰

---

#### è§„èŒƒ4: AOIæ„Ÿåº”åŒºèŒƒå›´é™åˆ¶ â­â­

**æ£€æŸ¥ç‚¹**ï¼š
- [ ] AOIæ„Ÿåº”åŒºæ¯ä¸ªç»´åº¦æ˜¯å¦è¶…è¿‡2000æ ¼ï¼Ÿ

**é”™è¯¯ç‰¹å¾**ï¼š
```python
# âŒ é”™è¯¯ç¤ºä¾‹
aoi_comp = serverApi.GetEngineCompFactory().CreateAoi(levelId)
pos = [0, 64, 0]
aoi_comp.AddAoi(pos, [3000, 3000, 3000])  # âŒ è¶…è¿‡2000é™åˆ¶ï¼Œæ„Ÿåº”åŒºä¸ç”Ÿæ•ˆ!
```

**ä¿®æ­£æŒ‡å¯¼**ï¼š
```python
# âœ… æ­£ç¡®æ–¹å¼
aoi_comp.AddAoi(pos, [2000, 2000, 2000])  # âœ… éµå®ˆé™åˆ¶

# âœ… æˆ–ä½¿ç”¨å¤šä¸ªå°æ„Ÿåº”åŒº
aoi_comp.AddAoi([0, 64, 0], [2000, 2000, 2000])
aoi_comp.AddAoi([2000, 64, 0], [2000, 2000, 2000])
```

**æ–‡æ¡£ä¾æ®**ï¼š
- CLAUDE.md: CRITICALè§„èŒƒ4ï¼ˆç¬¬83-100è¡Œï¼‰
- é—®é¢˜æ’æŸ¥.md: é—®é¢˜9ï¼ˆç¬¬300-330è¡Œï¼‰

---

### æ£€æŸ¥æ–¹æ³•

**å†…å­˜æ£€æŸ¥**ï¼ˆæ— éœ€å·¥å…·è°ƒç”¨ï¼‰ï¼š
1. å›é¡¾æ–¹æ¡ˆè®¾è®¡ä¸­çš„ä»£ç æ¡†æ¶
2. é€é¡¹å¯¹ç…§ä¸Šè¿°é”™è¯¯ç‰¹å¾
3. æ ‡è®°è¿åé¡¹

**è‡ªæ£€è„šæœ¬**ï¼ˆä¼ªä»£ç ï¼‰ï¼š
```python
def check_critical_rules(design):
    """æ£€æŸ¥CRITICALè§„èŒƒ"""
    issues = []

    # è§„èŒƒ1: æ£€æŸ¥è·¨ç«¯GetSystem
    if "ServerSystem" in design and "GetSystem" in design:
        if "ClientSystem" in design or "client" in design.lower():
            issues.append("âš ï¸ å¯èƒ½è¿åè§„èŒƒ1: æœåŠ¡ç«¯å°è¯•GetSystemè·å–å®¢æˆ·ç«¯")

    # è§„èŒƒ2: æ£€æŸ¥__init__ä¸­çš„APIè°ƒç”¨
    if "__init__" in design and ("GetComponent" in design or "ListenForEvent" in design):
        if "self.Create()" not in design:
            issues.append("âŒ è¿åè§„èŒƒ2: åœ¨__init__ä¸­è°ƒç”¨APIï¼Œä¸”æœªæ‰‹åŠ¨è°ƒç”¨Create()")

    # è§„èŒƒ3: æ£€æŸ¥EventDataä¸­çš„tuple
    if "CreateEventData" in design and "()" in design:
        issues.append("âš ï¸ å¯èƒ½è¿åè§„èŒƒ3: EventDataä¸­å¯èƒ½ä½¿ç”¨äº†tuple")

    # è§„èŒƒ4: æ£€æŸ¥AOIèŒƒå›´
    if "AddAoi" in design:
        # æå–èŒƒå›´å‚æ•°ï¼Œæ£€æŸ¥æ˜¯å¦è¶…è¿‡2000
        pass

    return issues
```

---

## âœ… æ£€æŸ¥é¡¹2: åŒç«¯éš”ç¦»éªŒè¯

### ç›®æ ‡

ç¡®ä¿æœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯çš„èŒè´£åˆ’åˆ†æ¸…æ™°ï¼ŒAPIè°ƒç”¨ç¬¦åˆç«¯åˆ«é™åˆ¶ã€‚

### æ£€æŸ¥å†…å®¹

#### 2.1 æœåŠ¡ç«¯Systemæ£€æŸ¥

**æ£€æŸ¥ç‚¹**ï¼š
- [ ] æœåŠ¡ç«¯Systemæ˜¯å¦åªè°ƒç”¨æœåŠ¡ç«¯APIï¼Ÿ
- [ ] æ˜¯å¦ä½¿ç”¨NotifyToClientè¿›è¡Œå®¢æˆ·ç«¯é€šä¿¡ï¼Ÿ
- [ ] æ˜¯å¦åœ¨æœåŠ¡ç«¯å¤„ç†é€»è¾‘è®¡ç®—ã€æ•°æ®å­˜å‚¨ã€æƒé™æ ¡éªŒï¼Ÿ

**èŒè´£èŒƒå›´**ï¼š
- âœ… **åº”è¯¥åš**ï¼šé€»è¾‘è®¡ç®—ã€æ•°æ®å­˜å‚¨ã€æƒé™æ ¡éªŒã€ä¸–ç•Œç®¡ç†
- âŒ **ä¸åº”è¯¥åš**ï¼šUIæ˜¾ç¤ºã€ç‰¹æ•ˆæ’­æ”¾ã€è¾“å…¥å¤„ç†

**å¸¸è§é”™è¯¯**ï¼š
```python
# âŒ é”™è¯¯ï¼šæœåŠ¡ç«¯å°è¯•æ“ä½œUI
class MyServerSystem(ServerSystem):
    def ShowUI(self, playerId):
        # æœåŠ¡ç«¯æ— æ³•ç›´æ¥æ“ä½œå®¢æˆ·ç«¯UI
        ui_comp.ShowUI(...)  # è¿™ä¸ä¼šç”Ÿæ•ˆ!
```

**æ­£ç¡®æ–¹å¼**ï¼š
```python
# âœ… æ­£ç¡®ï¼šé€šçŸ¥å®¢æˆ·ç«¯æ˜¾ç¤ºUI
class MyServerSystem(ServerSystem):
    def ShowUI(self, playerId):
        data = self.CreateEventData()
        data["ui_type"] = "shop"
        self.NotifyToClient(playerId, "ShowUI", data)
```

---

#### 2.2 å®¢æˆ·ç«¯Systemæ£€æŸ¥

**æ£€æŸ¥ç‚¹**ï¼š
- [ ] å®¢æˆ·ç«¯Systemæ˜¯å¦åªè°ƒç”¨å®¢æˆ·ç«¯APIï¼Ÿ
- [ ] æ˜¯å¦ä½¿ç”¨NotifyToServerè¿›è¡ŒæœåŠ¡ç«¯é€šä¿¡ï¼Ÿ
- [ ] æ˜¯å¦åœ¨å®¢æˆ·ç«¯å¤„ç†UIæ˜¾ç¤ºã€ç‰¹æ•ˆæ’­æ”¾ã€è¾“å…¥å¤„ç†ï¼Ÿ

**èŒè´£èŒƒå›´**ï¼š
- âœ… **åº”è¯¥åš**ï¼šUIæ˜¾ç¤ºã€ç‰¹æ•ˆæ’­æ”¾ã€è¾“å…¥å¤„ç†ã€æ‘„åƒæœºæ§åˆ¶
- âŒ **ä¸åº”è¯¥åš**ï¼šé€»è¾‘è®¡ç®—ã€æ•°æ®å­˜å‚¨ã€æƒé™æ ¡éªŒ

**å¸¸è§é”™è¯¯**ï¼š
```python
# âŒ é”™è¯¯ï¼šå®¢æˆ·ç«¯ç›´æ¥ä¿®æ”¹ç©å®¶å±æ€§
class MyClientSystem(ClientSystem):
    def AddExp(self, exp):
        # å®¢æˆ·ç«¯æ— æ³•ç›´æ¥ä¿®æ”¹æœåŠ¡ç«¯æ•°æ®
        attr_comp.SetAttrValue(playerId, "exp", new_exp)  # ä¸ä¼šåŒæ­¥åˆ°æœåŠ¡ç«¯!
```

**æ­£ç¡®æ–¹å¼**ï¼š
```python
# âœ… æ­£ç¡®ï¼šé€šçŸ¥æœåŠ¡ç«¯ä¿®æ”¹æ•°æ®
class MyClientSystem(ClientSystem):
    def RequestAddExp(self, exp):
        data = self.CreateEventData()
        data["exp"] = exp
        self.NotifyToServer("AddExp", data)
```

---

### æ£€æŸ¥æ–¹æ³•

#### æ–¹æ³•1: å†…å­˜æ£€æŸ¥ï¼ˆå¿«é€Ÿï¼‰

å›é¡¾æ–¹æ¡ˆè®¾è®¡ï¼Œæ£€æŸ¥ï¼š
1. ServerSystemä¸­çš„APIè°ƒç”¨æ˜¯å¦éƒ½æ˜¯æœåŠ¡ç«¯API
2. ClientSystemä¸­çš„APIè°ƒç”¨æ˜¯å¦éƒ½æ˜¯å®¢æˆ·ç«¯API
3. è·¨ç«¯æ“ä½œæ˜¯å¦ä½¿ç”¨Notifyæ–¹æ³•

#### æ–¹æ³•2: æŸ¥è¯¢ç´¢å¼•è¡¨éªŒè¯ï¼ˆç²¾ç¡®ï¼‰

```python
# å¯¹æ–¹æ¡ˆä¸­çš„æ¯ä¸ªAPIè°ƒç”¨ï¼ŒæŸ¥è¯¢ç«¯åˆ«æ ‡è®°
api_list = ["GetAttr", "SetAttrValue", "ShowUI", ...]

for api in api_list:
    # æŸ¥è¯¢Apiç´¢å¼•è¡¨
    result = Grep(api,
                  path="docs/modsdk-wiki/docs/mcdocs/1-ModAPI/æ¥å£/Apiç´¢å¼•è¡¨.md",
                  output_mode="content")

    # æ£€æŸ¥è¿”å›ç»“æœä¸­çš„ç«¯åˆ«æ ‡è®°
    if "æœåŠ¡ç«¯" in result:
        # éªŒè¯æ˜¯å¦åœ¨ServerSystemä¸­è°ƒç”¨
        if api in client_system_code:
            issues.append("âŒ ç«¯åˆ«ä¸åŒ¹é…: {} æ˜¯æœåŠ¡ç«¯APIï¼Œä½†åœ¨ClientSystemä¸­è°ƒç”¨".format(api))
    elif "å®¢æˆ·ç«¯" in result:
        # éªŒè¯æ˜¯å¦åœ¨ClientSystemä¸­è°ƒç”¨
        if api in server_system_code:
            issues.append("âŒ ç«¯åˆ«ä¸åŒ¹é…: {} æ˜¯å®¢æˆ·ç«¯APIï¼Œä½†åœ¨ServerSystemä¸­è°ƒç”¨".format(api))
```

---

### åŒç«¯é€šä¿¡æ£€æŸ¥è¡¨

| é€šä¿¡æ–¹å‘ | æ–¹æ³• | ä½¿ç”¨åœºæ™¯ | ç¤ºä¾‹ |
|---------|------|---------|------|
| æœåŠ¡ç«¯â†’å®¢æˆ·ç«¯ | NotifyToClient | é€šçŸ¥UIæ›´æ–°ã€æ’­æ”¾ç‰¹æ•ˆ | ç©å®¶ç»éªŒå€¼å˜åŒ– |
| å®¢æˆ·ç«¯â†’æœåŠ¡ç«¯ | NotifyToServer | è¯·æ±‚æ“ä½œã€æäº¤è¾“å…¥ | ç©å®¶ç‚¹å‡»è´­ä¹°æŒ‰é’® |
| âŒ æœåŠ¡ç«¯â†’æœåŠ¡ç«¯ | GetSystem | è·å–å…¶ä»–æœåŠ¡ç«¯System | âœ… å…è®¸ |
| âŒ å®¢æˆ·ç«¯â†’å®¢æˆ·ç«¯ | GetSystem | è·å–å…¶ä»–å®¢æˆ·ç«¯System | âœ… å…è®¸ |
| âŒ æœåŠ¡ç«¯â†’å®¢æˆ·ç«¯ | GetSystem | **ç¦æ­¢** | âŒ è¿åè§„èŒƒ1 |
| âŒ å®¢æˆ·ç«¯â†’æœåŠ¡ç«¯ | GetSystem | **ç¦æ­¢** | âŒ è¿åè§„èŒƒ1 |

---

## âœ… æ£€æŸ¥é¡¹3: äº‹ä»¶/APIå­˜åœ¨æ€§éªŒè¯

### ç›®æ ‡

ç¡®ä¿æ–¹æ¡ˆä¸­ä½¿ç”¨çš„æ‰€æœ‰äº‹ä»¶å’ŒAPIåœ¨MODSDKä¸­ç¡®å®å­˜åœ¨ï¼Œä¸”ç«¯åˆ«æ ‡è®°æ­£ç¡®ã€‚

### æ£€æŸ¥å†…å®¹

#### 3.1 äº‹ä»¶å­˜åœ¨æ€§éªŒè¯

**æ£€æŸ¥ç‚¹**ï¼š
- [ ] æ‰€æœ‰ç›‘å¬çš„äº‹ä»¶æ˜¯å¦åœ¨äº‹ä»¶ç´¢å¼•è¡¨ä¸­å­˜åœ¨ï¼Ÿ
- [ ] äº‹ä»¶ç«¯åˆ«æ ‡è®°æ˜¯å¦ä¸Systemç±»å‹åŒ¹é…ï¼Ÿ
- [ ] æ˜¯å¦ç†è§£äº‹ä»¶è§¦å‘æ—¶æœºï¼Ÿ

**æ£€æŸ¥æ–¹æ³•**ï¼š

```python
# æå–æ–¹æ¡ˆä¸­ç›‘å¬çš„æ‰€æœ‰äº‹ä»¶
event_list = [
    "ServerPlayerTryTouchEntityEvent",
    "ActorHurtServerEvent",
    "PlayerAttackEntityEvent",
    ...
]

# é€ä¸ªæŸ¥è¯¢äº‹ä»¶ç´¢å¼•è¡¨
for event in event_list:
    result = Grep(event,
                  path="docs/modsdk-wiki/docs/mcdocs/1-ModAPI/äº‹ä»¶/äº‹ä»¶ç´¢å¼•è¡¨.md",
                  output_mode="content")

    if result == "" or "æœªæ‰¾åˆ°" in result:
        issues.append("âŒ äº‹ä»¶ä¸å­˜åœ¨: {} åœ¨äº‹ä»¶ç´¢å¼•è¡¨ä¸­æœªæ‰¾åˆ°".format(event))
    else:
        # æ£€æŸ¥ç«¯åˆ«æ ‡è®°
        if "æœåŠ¡ç«¯" in result and event in client_system_code:
            issues.append("âŒ ç«¯åˆ«ä¸åŒ¹é…: {} æ˜¯æœåŠ¡ç«¯äº‹ä»¶ï¼Œä½†åœ¨ClientSystemä¸­ç›‘å¬".format(event))
        elif "å®¢æˆ·ç«¯" in result and event in server_system_code:
            issues.append("âŒ ç«¯åˆ«ä¸åŒ¹é…: {} æ˜¯å®¢æˆ·ç«¯äº‹ä»¶ï¼Œä½†åœ¨ServerSystemä¸­ç›‘å¬".format(event))

        # æç¤ºæŸ¥çœ‹è§¦å‘æ—¶æœº
        info.append("âœ… äº‹ä»¶å­˜åœ¨: {} - è§¦å‘æ—¶æœº: [ä»ç´¢å¼•è¡¨æå–]".format(event))
```

**æŸ¥è¯¢ç¤ºä¾‹**ï¼š

```python
# ç¤ºä¾‹1: æŸ¥è¯¢ç©å®¶è§¦æ‘¸å®ä½“äº‹ä»¶
Grep("ServerPlayerTryTouchEntityEvent",
     path="docs/modsdk-wiki/docs/mcdocs/1-ModAPI/äº‹ä»¶/äº‹ä»¶ç´¢å¼•è¡¨.md",
     output_mode="content")

# è¿”å›ç»“æœï¼š
# | ServerPlayerTryTouchEntityEvent | æœåŠ¡ç«¯ | ç©å®¶å°è¯•è§¦æ‘¸å®ä½“æ—¶è§¦å‘ |
# â†’ ç¡®è®¤å­˜åœ¨ï¼ŒæœåŠ¡ç«¯äº‹ä»¶ï¼Œè§¦å‘æ—¶æœºæ˜ç¡®
```

---

#### 3.2 APIå­˜åœ¨æ€§éªŒè¯

**æ£€æŸ¥ç‚¹**ï¼š
- [ ] æ‰€æœ‰è°ƒç”¨çš„APIæ˜¯å¦åœ¨Apiç´¢å¼•è¡¨ä¸­å­˜åœ¨ï¼Ÿ
- [ ] APIç«¯åˆ«æ ‡è®°æ˜¯å¦ä¸Systemç±»å‹åŒ¹é…ï¼Ÿ
- [ ] æ˜¯å¦ç†è§£APIåŠŸèƒ½å’Œå‚æ•°ï¼Ÿ

**æ£€æŸ¥æ–¹æ³•**ï¼š

```python
# æå–æ–¹æ¡ˆä¸­è°ƒç”¨çš„æ‰€æœ‰API
api_list = [
    "GetAttr",
    "SetAttrValue",
    "NotifyToClient",
    "CreateEngineEntityByTypeStr",
    ...
]

# é€ä¸ªæŸ¥è¯¢Apiç´¢å¼•è¡¨
for api in api_list:
    result = Grep(api,
                  path="docs/modsdk-wiki/docs/mcdocs/1-ModAPI/æ¥å£/Apiç´¢å¼•è¡¨.md",
                  output_mode="content")

    if result == "" or "æœªæ‰¾åˆ°" in result:
        issues.append("âŒ APIä¸å­˜åœ¨: {} åœ¨Apiç´¢å¼•è¡¨ä¸­æœªæ‰¾åˆ°".format(api))
    else:
        # æ£€æŸ¥ç«¯åˆ«æ ‡è®°
        if "æœåŠ¡ç«¯" in result and api in client_system_code:
            issues.append("âŒ ç«¯åˆ«ä¸åŒ¹é…: {} æ˜¯æœåŠ¡ç«¯APIï¼Œä½†åœ¨ClientSystemä¸­è°ƒç”¨".format(api))
        elif "å®¢æˆ·ç«¯" in result and api in server_system_code:
            issues.append("âŒ ç«¯åˆ«ä¸åŒ¹é…: {} æ˜¯å®¢æˆ·ç«¯APIï¼Œä½†åœ¨ServerSystemä¸­è°ƒç”¨".format(api))

        # æç¤ºAPIåŠŸèƒ½
        info.append("âœ… APIå­˜åœ¨: {} - åŠŸèƒ½: [ä»ç´¢å¼•è¡¨æå–]".format(api))
```

**æŸ¥è¯¢ç¤ºä¾‹**ï¼š

```python
# ç¤ºä¾‹2: æŸ¥è¯¢NotifyToClient API
Grep("NotifyToClient",
     path="docs/modsdk-wiki/docs/mcdocs/1-ModAPI/æ¥å£/Apiç´¢å¼•è¡¨.md",
     output_mode="content")

# è¿”å›ç»“æœï¼š
# | NotifyToClient | æœåŠ¡ç«¯ | æœåŠ¡ç«¯å‘å®¢æˆ·ç«¯å‘é€äº‹ä»¶ | è·¯å¾„: æ¥å£/é€šç”¨/äº‹ä»¶.md
# â†’ ç¡®è®¤å­˜åœ¨ï¼ŒæœåŠ¡ç«¯APIï¼ŒåŠŸèƒ½æ˜ç¡®
```

---

### Tokenæˆæœ¬

- å•æ¬¡GrepæŸ¥è¯¢ï¼šçº¦100-150 tokens
- æŸ¥è¯¢10ä¸ªäº‹ä»¶/APIï¼šçº¦1000-1500 tokens
- **æ€»æˆæœ¬**ï¼š<2k tokensï¼ˆå¯æ¥å—ï¼‰

---

## âœ… æ£€æŸ¥é¡¹4: æ•°æ®æµå®Œæ•´æ€§

### ç›®æ ‡

ç¡®ä¿æ•°æ®æµè®¾è®¡é€»è¾‘æ¸…æ™°ï¼Œæ²¡æœ‰é—æ¼å…³é”®æ­¥éª¤ï¼Œæ²¡æœ‰å¾ªç¯ä¾èµ–ã€‚

### æ£€æŸ¥å†…å®¹

#### 4.1 æ•°æ®æµé—­ç¯æ£€æŸ¥

**æ£€æŸ¥ç‚¹**ï¼š
- [ ] äº‹ä»¶ç›‘å¬ â†’ æ•°æ®å¤„ç† â†’ ç»“æœè¾“å‡º æ˜¯å¦é—­ç¯ï¼Ÿ
- [ ] æ˜¯å¦æœ‰"æœ‰è¾“å…¥æ— è¾“å‡º"çš„æƒ…å†µï¼Ÿ
- [ ] æ˜¯å¦æœ‰"æœ‰è¾“å‡ºæ— è¾“å…¥"çš„æƒ…å†µï¼Ÿ

**æ£€æŸ¥æ–¹æ³•**ï¼šç»˜åˆ¶æ•°æ®æµå›¾

```markdown
æ•°æ®æµå›¾ç¤ºä¾‹ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ è¾“å…¥: ServerPlayerTryTouchEvent â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å¤„ç†1: è·å–ç©å®¶å½“å‰ç»éªŒ         â”‚
â”‚   API: GetAttr(playerId, "exp") â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å¤„ç†2: è®¡ç®—æ–°ç»éªŒå€¼             â”‚
â”‚   logic: new_exp = old_exp + 50 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å¤„ç†3: è®¾ç½®æ–°ç»éªŒå€¼             â”‚
â”‚   API: SetAttrValue(...)        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ è¾“å‡º: NotifyToClient("UpdateUI")â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

æ£€æŸ¥ç»“æœï¼šâœ… æ•°æ®æµé—­ç¯å®Œæ•´
```

**å¸¸è§é—®é¢˜**ï¼š

```markdown
# âŒ é—®é¢˜1: æœ‰è¾“å…¥æ— è¾“å‡º
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ è¾“å…¥: OnPlayerAttack    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å¤„ç†: è®¡ç®—ä¼¤å®³        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â†“ âŒ ç¼ºå°‘è¾“å‡ºæ­¥éª¤
        ï¼ˆä¼¤å®³è®¡ç®—åæ²¡æœ‰åº”ç”¨åˆ°å®ä½“ï¼‰

# âœ… ä¿®æ­£: æ·»åŠ è¾“å‡º
â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ è¾“å‡º: SetHealth(...)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

#### 4.2 å…³é”®æ­¥éª¤é—æ¼æ£€æŸ¥

**æ£€æŸ¥ç‚¹**ï¼š
- [ ] æƒé™æ ¡éªŒæ˜¯å¦é—æ¼ï¼Ÿï¼ˆæœåŠ¡ç«¯æ“ä½œï¼‰
- [ ] é”™è¯¯å¤„ç†æ˜¯å¦é—æ¼ï¼Ÿ
- [ ] æ•°æ®éªŒè¯æ˜¯å¦é—æ¼ï¼Ÿï¼ˆèŒƒå›´æ£€æŸ¥ã€ç±»å‹æ£€æŸ¥ï¼‰
- [ ] å®¢æˆ·ç«¯åé¦ˆæ˜¯å¦é—æ¼ï¼Ÿï¼ˆæ“ä½œæˆåŠŸ/å¤±è´¥æç¤ºï¼‰

**å¸¸è§é—æ¼**ï¼š

| åœºæ™¯ | å¸¸é—æ¼æ­¥éª¤ | å½±å“ |
|-----|-----------|------|
| ç©å®¶è´­ä¹°ç‰©å“ | é‡‘å¸æ£€æŸ¥ã€èƒŒåŒ…ç©ºé—´æ£€æŸ¥ | å¯èƒ½å¯¼è‡´è´Ÿé‡‘å¸æˆ–ç‰©å“ä¸¢å¤± |
| ç©å®¶æ”»å‡»å®ä½“ | æƒé™æ ¡éªŒã€è·ç¦»æ£€æŸ¥ | å¯èƒ½è¢«ä½œå¼Š |
| æ•°æ®æŒä¹…åŒ– | åºåˆ—åŒ–æ£€æŸ¥ | å¯èƒ½å¯¼è‡´å­˜æ¡£æŸå |
| å®¢æˆ·ç«¯æ“ä½œ | æ“ä½œç»“æœåé¦ˆ | ç”¨æˆ·ä½“éªŒå·® |

**æ£€æŸ¥æ¸…å•**ï¼š

```markdown
## å…³é”®æ­¥éª¤æ£€æŸ¥æ¸…å•

### æƒé™æ ¡éªŒï¼ˆæœåŠ¡ç«¯æ“ä½œï¼‰
- [ ] æ˜¯å¦æ£€æŸ¥ç©å®¶æƒé™ï¼Ÿ
- [ ] æ˜¯å¦æ£€æŸ¥æ¸¸æˆæ¨¡å¼é™åˆ¶ï¼Ÿ
- [ ] æ˜¯å¦æ£€æŸ¥å†·å´æ—¶é—´ï¼Ÿ

### æ•°æ®éªŒè¯
- [ ] æ˜¯å¦æ£€æŸ¥å‚æ•°èŒƒå›´ï¼Ÿï¼ˆå¦‚ç»éªŒå€¼ä¸ä¸ºè´Ÿï¼‰
- [ ] æ˜¯å¦æ£€æŸ¥å®ä½“å­˜åœ¨æ€§ï¼Ÿ
- [ ] æ˜¯å¦æ£€æŸ¥æ•°æ®ç±»å‹ï¼Ÿ

### é”™è¯¯å¤„ç†
- [ ] APIè°ƒç”¨å¤±è´¥æ—¶æ˜¯å¦æœ‰å¤„ç†ï¼Ÿ
- [ ] æ˜¯å¦æœ‰å¼‚å¸¸æ•è·ï¼Ÿ
- [ ] æ˜¯å¦æœ‰é”™è¯¯æ—¥å¿—è¾“å‡ºï¼Ÿ

### ç”¨æˆ·åé¦ˆ
- [ ] æ“ä½œæˆåŠŸæ—¶æ˜¯å¦æœ‰æç¤ºï¼Ÿ
- [ ] æ“ä½œå¤±è´¥æ—¶æ˜¯å¦æœ‰é”™è¯¯æç¤ºï¼Ÿ
- [ ] æ˜¯å¦æ›´æ–°å®¢æˆ·ç«¯UIï¼Ÿ
```

---

#### 4.3 å¾ªç¯ä¾èµ–æ£€æŸ¥

**æ£€æŸ¥ç‚¹**ï¼š
- [ ] æ˜¯å¦å­˜åœ¨System Aä¾èµ–Bï¼ŒBåˆä¾èµ–Açš„æƒ…å†µï¼Ÿ
- [ ] æ˜¯å¦å­˜åœ¨äº‹ä»¶è§¦å‘é“¾ä¸­çš„å¾ªç¯ï¼Ÿ

**å¾ªç¯ä¾èµ–ç¤ºä¾‹**ï¼š

```markdown
# âŒ é—®é¢˜: å¾ªç¯ä¾èµ–
SystemA.OnEvent1() â†’ NotifyToClient â†’ SystemB.OnEvent2()
    â†“                                       â†“
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ NotifyToServer â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
ï¼ˆSystemBçš„å¤„ç†ç»“æœåˆè§¦å‘SystemAçš„äº‹ä»¶ï¼Œå½¢æˆå¾ªç¯ï¼‰

# âœ… è§£å†³æ–¹æ¡ˆ: æ·»åŠ çŠ¶æ€æ ‡è®°é˜²æ­¢å¾ªç¯
class SystemA:
    def OnEvent1(self, args):
        if args.get("from_system_b"):
            return  # é˜²æ­¢å¾ªç¯
        # å¤„ç†é€»è¾‘...
        data["from_system_a"] = True
        self.NotifyToClient(...)
```

---

## âœ… æ£€æŸ¥é¡¹5: æœ€ä½³å®è·µéµå¾ª

### ç›®æ ‡

ç¡®ä¿æ–¹æ¡ˆç¬¦åˆç¼–ç è§„èŒƒå’Œæœ€ä½³å®è·µï¼Œæé«˜ä»£ç è´¨é‡ã€‚

### æ£€æŸ¥å†…å®¹

#### 5.1 å‘½åè§„èŒƒ

**æ£€æŸ¥ç‚¹**ï¼š
- [ ] Systemç±»åæ˜¯å¦ç¬¦åˆè§„èŒƒï¼Ÿï¼ˆå¦‚`ExpServerSystem`, `ShopClientSystem`ï¼‰
- [ ] å‡½æ•°åæ˜¯å¦ä½¿ç”¨é©¼å³°å‘½åï¼Ÿï¼ˆå¦‚`OnPlayerAttack`, `GetPlayerExp`ï¼‰
- [ ] å˜é‡åæ˜¯å¦æœ‰æ„ä¹‰ï¼Ÿï¼ˆé¿å…`a`, `b`, `temp`ç­‰ï¼‰
- [ ] å¸¸é‡æ˜¯å¦ä½¿ç”¨å…¨å¤§å†™ï¼Ÿï¼ˆå¦‚`MAX_LEVEL`, `DEFAULT_EXP`ï¼‰

**å‘½åè§„èŒƒå‚è€ƒ**ï¼š

| ç±»å‹ | è§„èŒƒ | ç¤ºä¾‹ |
|-----|------|------|
| Systemç±» | PascalCase + Systemåç¼€ | `ExpServerSystem` |
| å‡½æ•° | PascalCaseï¼ˆç½‘æ˜“é£æ ¼ï¼‰| `OnPlayerAttack` |
| å˜é‡ | snake_case | `player_exp`, `current_level` |
| å¸¸é‡ | UPPER_SNAKE_CASE | `MAX_LEVEL`, `EXP_REWARD` |
| ç§æœ‰å±æ€§ | ä¸‹åˆ’çº¿å‰ç¼€ | `self._internal_data` |

**æ–‡æ¡£ä¾æ®**ï¼šå¼€å‘è§„èŒƒ.md ç¬¬8ç« ï¼ˆç¬¬400-450è¡Œï¼‰

---

#### 5.2 æ€§èƒ½ä¼˜åŒ–è€ƒè™‘

**æ£€æŸ¥ç‚¹**ï¼š
- [ ] æ˜¯å¦é¿å…æ¯Tickæ‰§è¡Œå¤æ‚é€»è¾‘ï¼Ÿ
- [ ] æ˜¯å¦ä½¿ç”¨ç¼“å­˜æœºåˆ¶ï¼Ÿ
- [ ] æ˜¯å¦é¿å…é¢‘ç¹çš„NotifyToClientï¼Ÿ
- [ ] æ˜¯å¦é¿å…å¤§é‡å®ä½“éå†ï¼Ÿ

**å¸¸è§æ€§èƒ½é—®é¢˜**ï¼š

```python
# âŒ é—®é¢˜1: æ¯Tickéå†æ‰€æœ‰ç©å®¶
def Update(self):
    for player in self.GetAllPlayers():  # æ¯Tickæ‰§è¡Œ!
        self.CheckPlayerStatus(player)

# âœ… ä¼˜åŒ–: ä½¿ç”¨å®šæ—¶å™¨
def Create(self):
    self.timer_comp = serverApi.GetEngineCompFactory().CreateTimer(levelId)
    self.timer_comp.AddTimer(5.0, self.CheckAllPlayers)  # 5ç§’æ‰§è¡Œä¸€æ¬¡

def CheckAllPlayers(self):
    for player in self.GetAllPlayers():
        self.CheckPlayerStatus(player)
```

```python
# âŒ é—®é¢˜2: é¢‘ç¹NotifyToClient
def OnExpChange(self, playerId, exp):
    data = self.CreateEventData()
    data["exp"] = exp
    self.NotifyToClient(playerId, "UpdateExp", data)  # æ¯æ¬¡ç»éªŒå˜åŒ–éƒ½å‘é€!

# âœ… ä¼˜åŒ–: æ‰¹é‡æ›´æ–°æˆ–èŠ‚æµ
def OnExpChange(self, playerId, exp):
    self.pending_updates[playerId] = exp  # ç¼“å­˜æ›´æ–°

def FlushUpdates(self):
    """æ¯ç§’æ‰¹é‡å‘é€æ›´æ–°"""
    for playerId, exp in self.pending_updates.items():
        data = self.CreateEventData()
        data["exp"] = exp
        self.NotifyToClient(playerId, "UpdateExp", data)
    self.pending_updates.clear()
```

**æ–‡æ¡£ä¾æ®**ï¼šå¼€å‘è§„èŒƒ.md ç¬¬10ç« ï¼ˆç¬¬500-550è¡Œï¼‰

---

#### 5.3 é”™è¯¯å¤„ç†

**æ£€æŸ¥ç‚¹**ï¼š
- [ ] APIè°ƒç”¨å¤±è´¥æ—¶æ˜¯å¦æœ‰å¤„ç†ï¼Ÿ
- [ ] æ˜¯å¦æœ‰æ—¥å¿—è¾“å‡ºï¼Ÿ
- [ ] æ˜¯å¦æœ‰ç”¨æˆ·æç¤ºï¼Ÿ

**é”™è¯¯å¤„ç†ç¤ºä¾‹**ï¼š

```python
# âŒ æ— é”™è¯¯å¤„ç†
def GiveItem(self, playerId, itemId):
    item_comp = serverApi.GetEngineCompFactory().CreateItem(levelId)
    item_comp.SpawnItemToPlayerInv(itemId, playerId)  # å¯èƒ½å¤±è´¥!

# âœ… æœ‰é”™è¯¯å¤„ç†
def GiveItem(self, playerId, itemId):
    try:
        item_comp = serverApi.GetEngineCompFactory().CreateItem(levelId)
        result = item_comp.SpawnItemToPlayerInv(itemId, playerId)

        if not result:
            # è®°å½•æ—¥å¿—
            print("[ERROR] Failed to give item {} to player {}".format(itemId, playerId))
            # é€šçŸ¥å®¢æˆ·ç«¯
            data = self.CreateEventData()
            data["message"] = "èƒŒåŒ…å·²æ»¡ï¼Œæ— æ³•è·å¾—ç‰©å“"
            self.NotifyToClient(playerId, "ShowError", data)
            return False

        return True
    except Exception as e:
        print("[ERROR] GiveItem exception: {}".format(e))
        return False
```

---

#### 5.4 è¾¹ç•Œæƒ…å†µè€ƒè™‘

**æ£€æŸ¥ç‚¹**ï¼š
- [ ] æ˜¯å¦è€ƒè™‘ç©å®¶ç¦»çº¿æƒ…å†µï¼Ÿ
- [ ] æ˜¯å¦è€ƒè™‘å®ä½“ä¸å­˜åœ¨æƒ…å†µï¼Ÿ
- [ ] æ˜¯å¦è€ƒè™‘æ•°å€¼æº¢å‡ºï¼Ÿ
- [ ] æ˜¯å¦è€ƒè™‘å¹¶å‘æ“ä½œï¼Ÿ

**è¾¹ç•Œæƒ…å†µç¤ºä¾‹**ï¼š

```python
# âŒ æœªè€ƒè™‘ç©å®¶ç¦»çº¿
def GiveReward(self, playerId):
    exp = self.GetPlayerExp(playerId)  # ç©å®¶ç¦»çº¿æ—¶å¯èƒ½è¿”å›None!
    new_exp = exp + 100
    self.SetPlayerExp(playerId, new_exp)

# âœ… è€ƒè™‘è¾¹ç•Œæƒ…å†µ
def GiveReward(self, playerId):
    # æ£€æŸ¥ç©å®¶æ˜¯å¦åœ¨çº¿
    if not self.IsPlayerOnline(playerId):
        # ç¦»çº¿å¥–åŠ±å­˜å‚¨åˆ°æ•°æ®åº“
        self.SaveOfflineReward(playerId, 100)
        return

    exp = self.GetPlayerExp(playerId)
    if exp is None:
        exp = 0  # é»˜è®¤å€¼

    # æ£€æŸ¥æº¢å‡º
    MAX_EXP = 999999
    new_exp = min(exp + 100, MAX_EXP)

    self.SetPlayerExp(playerId, new_exp)
```

---

## ğŸ“Š è‡ªæ£€æŠ¥å‘Šæ¨¡æ¿

### è¾“å‡ºæ ¼å¼

æ‰§è¡Œè‡ªæ£€åï¼Œå¿…é¡»è¾“å‡ºä»¥ä¸‹æ ¼å¼çš„æŠ¥å‘Šï¼š

```markdown
## ğŸ” æ–¹æ¡ˆè‡ªæ£€æŠ¥å‘Š

### âœ… é€šè¿‡é¡¹ï¼ˆX/5ï¼‰
- âœ… **CRITICALè§„èŒƒéªŒè¯** - æ— è¿å
  - æœªè·¨ç«¯GetSystem
  - æœªåœ¨__init__ä¸­è°ƒç”¨API
  - EventDataæœªä½¿ç”¨tuple
  - AOIèŒƒå›´ç¬¦åˆé™åˆ¶

- âœ… **åŒç«¯éš”ç¦»éªŒè¯** - é€šè¿‡
  - ServerSystemåªè°ƒç”¨æœåŠ¡ç«¯API
  - ClientSystemåªè°ƒç”¨å®¢æˆ·ç«¯API
  - ä½¿ç”¨NotifyToClient/NotifyToServeré€šä¿¡

- âœ… **äº‹ä»¶/APIå­˜åœ¨æ€§éªŒè¯** - é€šè¿‡
  - æŸ¥è¯¢ç´¢å¼•è¡¨ç¡®è®¤æ‰€æœ‰äº‹ä»¶/APIå­˜åœ¨
  - ç«¯åˆ«æ ‡è®°åŒ¹é…Systemç±»å‹

- âœ… **æ•°æ®æµå®Œæ•´æ€§** - é€šè¿‡
  - æ•°æ®æµé—­ç¯å®Œæ•´
  - æ— å…³é”®æ­¥éª¤é—æ¼
  - æ— å¾ªç¯ä¾èµ–

- âœ… **æœ€ä½³å®è·µéµå¾ª** - é€šè¿‡
  - å‘½åè§„èŒƒç¬¦åˆ
  - è€ƒè™‘äº†æ€§èƒ½ä¼˜åŒ–
  - æœ‰é”™è¯¯å¤„ç†
  - è€ƒè™‘äº†è¾¹ç•Œæƒ…å†µ

---

### âš ï¸ è­¦å‘Šé¡¹ï¼ˆYé¡¹ï¼‰
- âš ï¸ **æ€§èƒ½ä¼˜åŒ–** - å»ºè®®æ·»åŠ ç¼“å­˜æœºåˆ¶
  - ä½ç½®ï¼šExpServerSystem.GetPlayerExp()
  - ç†ç”±ï¼šé¢‘ç¹æŸ¥è¯¢æ•°æ®åº“ï¼Œå»ºè®®æ·»åŠ å†…å­˜ç¼“å­˜
  - å½±å“ï¼šæ€§èƒ½å¯ä¼˜åŒ–ï¼Œä½†ä¸å½±å“åŠŸèƒ½

- âš ï¸ **é”™è¯¯å¤„ç†** - å»ºè®®æ·»åŠ APIå¤±è´¥å¤„ç†
  - ä½ç½®ï¼šShopServerSystem.BuyItem()
  - ç†ç”±ï¼šSpawnItemToPlayerInvå¯èƒ½å¤±è´¥ï¼ˆèƒŒåŒ…æ»¡ï¼‰
  - å½±å“ï¼šç”¨æˆ·ä½“éªŒï¼Œå»ºè®®æ·»åŠ å¤±è´¥æç¤º

---

### âŒ é”™è¯¯é¡¹ï¼ˆZé¡¹ï¼‰
- âŒ **è¿åCRITICALè§„èŒƒ2** - åœ¨__init__ä¸­è°ƒç”¨API
  - ä½ç½®ï¼šExpServerSystem.__init__:15
  - é”™è¯¯ä»£ç ï¼š`self.gameComp = serverApi.GetEngineCompFactory().CreateGame(levelId)`
  - ä¿®æ­£æ–¹æ¡ˆï¼šç§»åˆ°Create()ä¸­è°ƒç”¨ï¼Œå¹¶åœ¨__init__ä¸­æ‰‹åŠ¨è°ƒç”¨self.Create()
  - æ–‡æ¡£ä¾æ®ï¼šå¼€å‘è§„èŒƒ.md ç¬¬2.2èŠ‚ï¼ˆç¬¬82-120è¡Œï¼‰

- âŒ **ç«¯åˆ«ä¸åŒ¹é…** - å®¢æˆ·ç«¯APIåœ¨æœåŠ¡ç«¯è°ƒç”¨
  - ä½ç½®ï¼šShopServerSystem.ShowUI()
  - é”™è¯¯ä»£ç ï¼š`ui_comp.ShowUI(...)`
  - ä¿®æ­£æ–¹æ¡ˆï¼šä½¿ç”¨NotifyToClienté€šçŸ¥å®¢æˆ·ç«¯æ˜¾ç¤ºUI
  - æ–‡æ¡£ä¾æ®ï¼šå¼€å‘è§„èŒƒ.md ç¬¬2.1èŠ‚ï¼ˆç¬¬49-80è¡Œï¼‰

---

### ğŸ¯ å¤„ç†å†³ç­–
**[è‡ªåŠ¨ä¿®æ­£ / æ ‡æ³¨é£é™©ç‚¹æäº¤ç”¨æˆ· / è§¦å‘ä¸“å®¶å®¡æ ¸]**

**å†³ç­–ç†ç”±**ï¼š
- å‘ç° Z ä¸ªé”™è¯¯é¡¹ï¼Œéœ€è¦ä¿®æ­£
- å‘ç° Y ä¸ªè­¦å‘Šé¡¹ï¼Œå»ºè®®ä¼˜åŒ–
- [å…·ä½“å†³ç­–è¯´æ˜]
```

---

## ğŸ”€ å¤„ç†å†³ç­–é€»è¾‘

### å†³ç­–æµç¨‹

```
è‡ªæ£€å®Œæˆ
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ˜¯å¦æœ‰é”™è¯¯é¡¹ï¼Ÿ   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ âœ… æ˜¯ï¼ˆâŒ > 0ï¼‰   â”‚ â†’ è‡ªåŠ¨ä¿®æ­£æ–¹æ¡ˆ â†’ é‡æ–°è‡ªæ£€
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“ å¦
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ˜¯å¦åªæœ‰è­¦å‘Šé¡¹ï¼Ÿ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ âœ… æ˜¯ï¼ˆâš ï¸ > 0ï¼‰   â”‚ â†’ æ ‡æ³¨é£é™©ç‚¹ â†’ è¯¢é—®ç”¨æˆ·æ˜¯å¦ç»§ç»­
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“ å¦
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å…¨éƒ¨é€šè¿‡         â”‚ â†’ åˆ¤æ–­ä»»åŠ¡çº§åˆ« â†’ å†³å®šæ˜¯å¦è§¦å‘ä¸“å®¶å®¡æ ¸
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### å†³ç­–è§„åˆ™

#### è§„åˆ™1: æœ‰é”™è¯¯é¡¹ â†’ è‡ªåŠ¨ä¿®æ­£

```python
if error_count > 0:
    print("## ğŸ”§ è‡ªåŠ¨ä¿®æ­£æ–¹æ¡ˆ")
    print("å‘ç° {} ä¸ªé”™è¯¯é¡¹ï¼Œæ­£åœ¨ä¿®æ­£...".format(error_count))

    for error in errors:
        # æ ¹æ®é”™è¯¯ç±»å‹ï¼Œåº”ç”¨ä¿®æ­£ç­–ç•¥
        if error["type"] == "CRITICALè§„èŒƒ2":
            # å°†__init__ä¸­çš„APIè°ƒç”¨ç§»åˆ°Create()
            fix_lifecycle_issue(error)
        elif error["type"] == "ç«¯åˆ«ä¸åŒ¹é…":
            # æ›¿æ¢ä¸ºNotifyToClient/NotifyToServer
            fix_cross_side_issue(error)
        # ... å…¶ä»–ä¿®æ­£

    print("ä¿®æ­£å®Œæˆï¼Œé‡æ–°æ‰§è¡Œè‡ªæ£€...")
    # é‡æ–°è‡ªæ£€
    re_run_self_check()
```

---

#### è§„åˆ™2: åªæœ‰è­¦å‘Šé¡¹ â†’ æ ‡æ³¨é£é™©ç‚¹

```python
if error_count == 0 and warning_count > 0:
    print("## âš ï¸ å‘ç° {} ä¸ªè­¦å‘Šé¡¹".format(warning_count))
    print("æ–¹æ¡ˆå¯ä»¥æ‰§è¡Œï¼Œä½†å»ºè®®ä¼˜åŒ–ä»¥ä¸‹æ–¹é¢ï¼š")

    for warning in warnings:
        print("- {}".format(warning["message"]))

    # è¯¢é—®ç”¨æˆ·
    AskUserQuestion({
        "questions": [{
            "question": "å‘ç° {} ä¸ªè­¦å‘Šé¡¹ï¼Œæ˜¯å¦ç»§ç»­å®æ–½ï¼Ÿ".format(warning_count),
            "header": "è­¦å‘Šç¡®è®¤",
            "multiSelect": false,
            "options": [
                {"label": "ç»§ç»­å®æ–½", "description": "è­¦å‘Šä¸å½±å“åŠŸèƒ½ï¼Œå¯ä»¥ç»§ç»­"},
                {"label": "å…ˆä¼˜åŒ–å†å®æ–½", "description": "æ ¹æ®è­¦å‘Šè°ƒæ•´æ–¹æ¡ˆ"},
                {"label": "è§¦å‘ä¸“å®¶å®¡æ ¸", "description": "è®©ä¸“å®¶å®¡æ ¸æ–¹æ¡ˆ"}
            ]
        }]
    })
```

---

#### è§„åˆ™3: å…¨éƒ¨é€šè¿‡ â†’ åˆ¤æ–­ä»»åŠ¡çº§åˆ«

```python
if error_count == 0 and warning_count == 0:
    print("## âœ… è‡ªæ£€å…¨éƒ¨é€šè¿‡")

    # åˆ¤æ–­ä»»åŠ¡çº§åˆ«
    if task_level == "ğŸ”´ å¤æ‚ä»»åŠ¡":
        print("å¤æ‚ä»»åŠ¡ï¼Œå¼ºåˆ¶è§¦å‘ä¸“å®¶å®¡æ ¸...")
        trigger_expert_review()

    elif task_level == "ğŸŸ¡ æ ‡å‡†ä»»åŠ¡":
        # æ£€æŸ¥æ™ºèƒ½è§¦å‘æ¡ä»¶
        if bug_fix_attempts >= 2:
            print("2è½®ä»¥ä¸ŠBugä¿®å¤æœªæˆåŠŸï¼Œè§¦å‘ä¸“å®¶å®¡æ ¸...")
            trigger_expert_review()
        elif module_count > 5:
            print("è®¾è®¡æ¨¡å—è·¨è¶Šè¿‡å¤šï¼ˆ>5ä¸ªSystemï¼‰ï¼Œè§¦å‘ä¸“å®¶å®¡æ ¸...")
            trigger_expert_review()
        else:
            print("æ ‡å‡†ä»»åŠ¡ï¼Œè‡ªæ£€é€šè¿‡ï¼Œæäº¤ç”¨æˆ·å®¡é˜…...")
            submit_to_user()

    else:  # ğŸŸ¢ å¾®ä»»åŠ¡
        print("å¾®ä»»åŠ¡ï¼Œè‡ªæ£€é€šè¿‡ï¼Œç›´æ¥å®æ–½...")
        proceed_to_implementation()
```

---

## ğŸ“ ä½¿ç”¨ç¤ºä¾‹

### ç¤ºä¾‹1: æ–°åŠŸèƒ½æ–¹æ¡ˆè‡ªæ£€

**æ–¹æ¡ˆ**ï¼šæ·»åŠ ç»éªŒç³»ç»Ÿ

```python
# æ‰§è¡Œè‡ªæ£€
run_self_check(design_plan)

# è¾“å‡ºï¼š
## ğŸ” æ–¹æ¡ˆè‡ªæ£€æŠ¥å‘Š

### âœ… é€šè¿‡é¡¹ï¼ˆ4/5ï¼‰
- âœ… CRITICALè§„èŒƒéªŒè¯ - æ— è¿å
- âœ… åŒç«¯éš”ç¦»éªŒè¯ - é€šè¿‡
- âœ… äº‹ä»¶/APIå­˜åœ¨æ€§éªŒè¯ - é€šè¿‡
- âœ… æ•°æ®æµå®Œæ•´æ€§ - é€šè¿‡

### âš ï¸ è­¦å‘Šé¡¹ï¼ˆ1é¡¹ï¼‰
- âš ï¸ æ€§èƒ½ä¼˜åŒ– - å»ºè®®æ·»åŠ ç»éªŒå€¼ç¼“å­˜

### âŒ é”™è¯¯é¡¹ï¼ˆ0é¡¹ï¼‰

### ğŸ¯ å¤„ç†å†³ç­–
**æ ‡æ³¨é£é™©ç‚¹æäº¤ç”¨æˆ·**

å‘ç°1ä¸ªè­¦å‘Šé¡¹ï¼Œä¸å½±å“åŠŸèƒ½ï¼Œå»ºè®®ä¼˜åŒ–åå®æ–½ã€‚
```

---

### ç¤ºä¾‹2: Bugä¿®å¤æ–¹æ¡ˆè‡ªæ£€

**æ–¹æ¡ˆ**ï¼šä¿®å¤AttributeErroré”™è¯¯

```python
# æ‰§è¡Œè‡ªæ£€
run_self_check(fix_plan)

# è¾“å‡ºï¼š
## ğŸ” æ–¹æ¡ˆè‡ªæ£€æŠ¥å‘Š

### âŒ é”™è¯¯é¡¹ï¼ˆ1é¡¹ï¼‰
- âŒ è¿åCRITICALè§„èŒƒ2 - åœ¨__init__ä¸­è°ƒç”¨API

### ğŸ¯ å¤„ç†å†³ç­–
**è‡ªåŠ¨ä¿®æ­£**

æ­£åœ¨ä¿®æ­£...
ä¿®æ­£å®Œæˆï¼Œé‡æ–°æ‰§è¡Œè‡ªæ£€...

### âœ… äºŒæ¬¡è‡ªæ£€å…¨éƒ¨é€šè¿‡
æ–¹æ¡ˆå·²ä¿®æ­£ï¼Œå¯ä»¥å®æ–½ã€‚
```

---

## ğŸ“š æ€»ç»“

### è‡ªæ£€æ¸…å•æ ¸å¿ƒä»·å€¼

1. **é˜²æ­¢90%å¸¸è§é”™è¯¯**ï¼šé€šè¿‡éªŒè¯CRITICALè§„èŒƒ
2. **æé«˜æ–¹æ¡ˆè´¨é‡**ï¼šç¡®ä¿æ•°æ®æµå®Œæ•´ã€APIæ­£ç¡®
3. **èŠ‚çœTokenæˆæœ¬**ï¼šé¿å…å®æ–½åè¿”å·¥ï¼ˆ<2k tokensæˆæœ¬ï¼‰
4. **è‡ªåŠ¨ä¿®æ­£èƒ½åŠ›**ï¼šå‘ç°é”™è¯¯åè‡ªåŠ¨ä¿®æ­£ï¼Œæ— éœ€äººå·¥å¹²é¢„

### ä½¿ç”¨å»ºè®®

1. **å¿…é¡»æ‰§è¡Œ**ï¼šæ‰€æœ‰æ ‡å‡†ä»»åŠ¡å’Œå¤æ‚ä»»åŠ¡éƒ½å¿…é¡»æ‰§è¡Œè‡ªæ£€
2. **è®¤çœŸå¯¹å¾…è­¦å‘Š**ï¼šè­¦å‘Šé¡¹è™½ä¸å½±å“åŠŸèƒ½ï¼Œä½†å¯èƒ½å½±å“æ€§èƒ½å’Œç”¨æˆ·ä½“éªŒ
3. **ä¿¡ä»»è‡ªæ£€ç»“æœ**ï¼šè‡ªæ£€é€šè¿‡çš„æ–¹æ¡ˆè´¨é‡æœ‰ä¿éšœï¼Œå¯ä»¥æ”¾å¿ƒå®æ–½
4. **æŒç»­ä¼˜åŒ–**ï¼šæ ¹æ®å®é™…ä½¿ç”¨æƒ…å†µï¼Œä¸æ–­å®Œå–„è‡ªæ£€è§„åˆ™

---

_æœ€åæ›´æ–°: 2025-11-11 | æ–‡æ¡£ç‰ˆæœ¬: 1.0_
