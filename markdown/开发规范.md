# å¼€å‘è§„èŒƒ

> **ğŸ“ å¯¼èˆª**: [ğŸ  é¦–é¡µ](../README.md) > [ğŸ“‚ æ–‡æ¡£](../README.md#æ–‡æ¡£å¯¼èˆª) > å¼€å‘è§„èŒƒ
>
> âš ï¸ **CRITICAL**: è¿™äº›è§„åˆ™å¯é˜²æ­¢è¿è¡Œæ—¶é”™è¯¯ã€‚å¼€å‘å‰å¿…è¯»ï¼
>
> **ğŸ“… æœ€åæ›´æ–°**: 2025-11-09
> **æ–‡æ¡£ç‰ˆæœ¬**: 3.0 (åŸºäºMODSDKå®˜æ–¹æ–‡æ¡£å…¨é¢é‡æ„)

---

## ğŸ“‹ ç›®å½•

1. [Python 2.7å…¼å®¹æ€§](#1-python-27å…¼å®¹æ€§)
2. [CRITICALè§„èŒƒ](#2-criticalè§„èŒƒ-å¿…è¯») âš ï¸ **å¿…è¯»**
3. [Systemå¼€å‘è§„èŒƒ](#3-systemå¼€å‘è§„èŒƒ)
4. [Componentç»„ä»¶è§„èŒƒ](#4-componentç»„ä»¶è§„èŒƒ)
5. [Eventäº‹ä»¶ç³»ç»Ÿ](#5-eventäº‹ä»¶ç³»ç»Ÿ)
6. [Entityå®ä½“ç®¡ç†](#6-entityå®ä½“ç®¡ç†)
7. [æ¨¡å—å¯¼å…¥è§„èŒƒ](#7-æ¨¡å—å¯¼å…¥è§„èŒƒ-critical) âš ï¸ **CRITICAL**
8. [å‘½åè§„èŒƒ](#8-å‘½åè§„èŒƒ)
9. [æ–‡ä»¶ç»„ç»‡](#9-æ–‡ä»¶ç»„ç»‡)
10. [æ€§èƒ½ä¼˜åŒ–å»ºè®®](#10-æ€§èƒ½ä¼˜åŒ–å»ºè®®)
11. [ç½‘æ˜“å¼•æ“é™åˆ¶](#11-ç½‘æ˜“å¼•æ“é™åˆ¶)

---

## 1. Python 2.7å…¼å®¹æ€§

### âš ï¸ ä¸ºä»€ä¹ˆé‡è¦ï¼Ÿ

ç½‘æ˜“æˆ‘çš„ä¸–ç•Œå¼•æ“ä½¿ç”¨**Python 2.7**ï¼Œå¿…é¡»ä¿æŒå…¼å®¹æ€§ã€‚ä½¿ç”¨Python 3ç‰¹æ€§ä¼šå¯¼è‡´è¯­æ³•é”™è¯¯æˆ–è¿è¡Œæ—¶å´©æºƒã€‚

### å¿…é¡»éµå®ˆçš„è§„åˆ™

#### 1.1 æ–‡ä»¶ç¼–ç å£°æ˜

**æ¯ä¸ªPythonæ–‡ä»¶å¼€å¤´å¿…é¡»å£°æ˜UTF-8ç¼–ç **ï¼š

```python
# -*- coding: utf-8 -*-
"""æ¨¡å—è¯´æ˜æ–‡æ¡£å­—ç¬¦ä¸²"""
```

#### 1.2 Printå‡½æ•°

**å¿…é¡»å¯¼å…¥print_function**ï¼š

```python
# âœ… æ­£ç¡®
from __future__ import print_function

print("Hello, World!")
print("Value:", value)

# âŒ é”™è¯¯ï¼ˆPython 2.7ä¼šæŠ¥é”™ï¼‰
print "Hello, World"  # Python 2è¯­æ³•ï¼Œä½†ä¸æ¨è
```

#### 1.3 å­—ç¬¦ä¸²æ ¼å¼åŒ–

**ä½¿ç”¨ `.format()` è€Œé f-strings**ï¼š

```python
# âœ… æ­£ç¡®
name = "ç©å®¶"
msg = "æ¬¢è¿ {} åŠ å…¥æ¸¸æˆ".format(name)
msg = "åæ ‡: ({}, {}, {})".format(x, y, z)

# âŒ é”™è¯¯ï¼ˆf-stringsæ˜¯Python 3.6+ç‰¹æ€§ï¼‰
msg = f"æ¬¢è¿ {name} åŠ å…¥æ¸¸æˆ"
```

#### 1.4 ç±»å‹æ³¨è§£

**ä½¿ç”¨æ³¨é‡Šå½¢å¼ï¼Œä¸è¦ä½¿ç”¨Python 3è¯­æ³•**ï¼š

```python
# âœ… æ­£ç¡®
def get_player_name(player_id):
    # type: (str) -> str
    """è·å–ç©å®¶åç§°"""
    return "PlayerName"

# âŒ é”™è¯¯ï¼ˆç±»å‹æ³¨è§£æ˜¯Python 3ç‰¹æ€§ï¼‰
def get_player_name(player_id: str) -> str:
    return "PlayerName"
```

#### 1.5 å­—å…¸æ–¹æ³•

**æ³¨æ„å­—å…¸æ–¹æ³•åœ¨Python 2/3çš„å·®å¼‚**ï¼š

```python
# âœ… æ­£ç¡®ï¼ˆå…¼å®¹Python 2å’Œ3ï¼‰
for key in dict.keys():
    print(key)

for key, value in dict.items():
    print(key, value)

# âš ï¸ æ³¨æ„ï¼šPython 2çš„dict.iteritems()åœ¨Python 3ä¸­ä¸å­˜åœ¨
# æ¨èä½¿ç”¨dict.items()ï¼ˆä¸¤è€…éƒ½æ”¯æŒï¼‰
```

#### 1.6 é™¤æ³•è¿ç®—

**æ•´æ•°é™¤æ³•è¡Œä¸ºä¸åŒ**ï¼š

```python
# Python 2: 5 / 2 = 2 (æ•´æ•°é™¤æ³•)
# Python 3: 5 / 2 = 2.5 (æµ®ç‚¹é™¤æ³•)

# âœ… æ­£ç¡®ï¼ˆæ˜ç¡®æ„å›¾ï¼‰
from __future__ import division

result = 5 / 2      # 2.5 (æµ®ç‚¹é™¤æ³•)
result = 5 // 2     # 2 (æ•´æ•°é™¤æ³•)
```

#### 1.7 å¼‚å¸¸å¤„ç†

**ä½¿ç”¨å…¼å®¹çš„å¼‚å¸¸è¯­æ³•**ï¼š

```python
# âœ… æ­£ç¡®ï¼ˆPython 2å’Œ3éƒ½æ”¯æŒï¼‰
try:
    do_something()
except Exception as e:
    print("Error:", e)

# âŒ é”™è¯¯ï¼ˆPython 2æ—§è¯­æ³•ï¼ŒPython 3ä¸æ”¯æŒï¼‰
try:
    do_something()
except Exception, e:
    print "Error:", e
```

### å…¼å®¹æ€§æ£€æŸ¥æ¸…å•

å¼€å‘æ—¶è¯·ç¡®è®¤ï¼š

- [ ] æ–‡ä»¶å¼€å¤´æœ‰ `# -*- coding: utf-8 -*-`
- [ ] å¯¼å…¥äº† `from __future__ import print_function`
- [ ] ä½¿ç”¨ `.format()` è€Œé f-strings
- [ ] ç±»å‹æ³¨è§£ä½¿ç”¨æ³¨é‡Šå½¢å¼ `# type: ...`
- [ ] å¼‚å¸¸å¤„ç†ä½¿ç”¨ `except ... as e` è¯­æ³•
- [ ] æ²¡æœ‰ä½¿ç”¨Python 3ä¸“æœ‰ç‰¹æ€§ï¼ˆå¦‚ `async/await`ã€`@dataclass` ç­‰ï¼‰

[â¬†ï¸ è¿”å›ç›®å½•](#ç›®å½•)

---

## 2. CRITICALè§„èŒƒ âš ï¸ å¿…è¯»

ä»¥ä¸‹è§„èŒƒè¿åä¼šå¯¼è‡´è¿è¡Œæ—¶é”™è¯¯ï¼**å¼€å‘å‰å¿…é¡»æŒæ¡**ã€‚

### 2.1 åŒç«¯éš”ç¦»åŸåˆ™ â­â­â­

**æ ¸å¿ƒé—®é¢˜**: Serverå’ŒClientè¿è¡Œåœ¨**å®Œå…¨ç‹¬ç«‹çš„è¿›ç¨‹**ä¸­ï¼Œæ— æ³•ç›´æ¥GetSystemè®¿é—®å¯¹æ–¹ã€‚

#### âŒ ç¦æ­¢æ“ä½œ

```python
# âŒ é”™è¯¯ç¤ºä¾‹ - æœåŠ¡ç«¯ä»£ç ä¸­
class ServerSystem(ServerSystem):
    def __init__(self, namespace, systemName):
        ServerSystem.__init__(self, namespace, systemName)
        # å°è¯•è·å–å®¢æˆ·ç«¯System - è¿”å›None!
        shop_client = serverApi.GetSystem("MyMod", "ShopClientSystem")
        shop_client.OpenUI()  # AttributeError: 'NoneType' object has no attribute 'OpenUI'
```

**åŸå› **: æœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯è¿è¡Œåœ¨**ä¸åŒè¿›ç¨‹**ä¸­ï¼Œè·¨ç«¯GetSystemè¿”å›Noneã€‚

#### âœ… æ­£ç¡®æ–¹å¼ï¼šä½¿ç”¨åŒç«¯é€šä¿¡

```python
# âœ… æ­£ç¡® - æœåŠ¡ç«¯å‘é€äº‹ä»¶åˆ°å®¢æˆ·ç«¯
class ServerSystem(ServerSystem):
    def OpenShopForPlayer(self, playerId):
        data = self.CreateEventData()
        data["shopId"] = 1
        data["items"] = [...]
        # ä½¿ç”¨NotifyToClientå‘é€äº‹ä»¶
        self.NotifyToClient(playerId, "OpenShopUI", data)

# âœ… æ­£ç¡® - å®¢æˆ·ç«¯ç›‘å¬æœåŠ¡ç«¯äº‹ä»¶
class ClientSystem(ClientSystem):
    def Create(self):
        self.ListenForEvent(
            "MyMod",
            "MyServerSystem",
            "OpenShopUI",
            self,
            self.OnOpenShop
        )

    def OnOpenShop(self, args):
        shopId = args["shopId"]
        items = args["items"]
        # æ˜¾ç¤ºUI
```

#### åŒç«¯é€šä¿¡API

| æ–¹å‘ | API | ç”¨é€” |
|------|-----|------|
| **æœåŠ¡ç«¯â†’å®¢æˆ·ç«¯** | `self.NotifyToClient(playerId, eventName, data)` | å‘é€ç»™å•ä¸ªç©å®¶ |
| **æœåŠ¡ç«¯â†’æ‰€æœ‰å®¢æˆ·ç«¯** | `self.BroadcastToAllClient(eventName, data)` | å¹¿æ’­ç»™æ‰€æœ‰ç©å®¶ |
| **æœåŠ¡ç«¯â†’å¤šä¸ªå®¢æˆ·ç«¯** | `self.NotifyToMultiClients([playerIds], eventName, data)` | å‘é€ç»™å¤šä¸ªç©å®¶ï¼ˆæ€§èƒ½æ›´å¥½ï¼‰|
| **å®¢æˆ·ç«¯â†’æœåŠ¡ç«¯** | `self.NotifyToServer(eventName, data)` | å®¢æˆ·ç«¯å‘é€åˆ°æœåŠ¡ç«¯ |

**âš ï¸ å…³é”®ç‚¹**ï¼š
- æœåŠ¡ç«¯ç›‘å¬å®¢æˆ·ç«¯äº‹ä»¶æ—¶ï¼Œ`args`ä¼šè‡ªåŠ¨åŒ…å«`'__id__'`å­—æ®µï¼ˆå‘é€è€…çš„playerIdï¼‰
- æ•°æ®å¿…é¡»å¯åºåˆ—åŒ–ï¼ˆdictã€listã€strã€intã€floatã€boolï¼‰
- **ä¸æ”¯æŒtuple**ï¼ˆä¼šå¯¼è‡´åºåˆ—åŒ–å¤±è´¥ï¼‰ âš ï¸

---

### 2.2 Systemç”Ÿå‘½å‘¨æœŸé™åˆ¶ â­â­â­

**æ ¸å¿ƒé—®é¢˜**: ç½‘æ˜“å¼•æ“ä¸ä¼šè‡ªåŠ¨è°ƒç”¨`Create()`ï¼Œå¿…é¡»åœ¨`__init__`ä¸­æ‰‹åŠ¨è°ƒç”¨ã€‚

#### âŒ ç¦æ­¢æ“ä½œ

```python
# âŒ é”™è¯¯ç¤ºä¾‹
class MySystem(ServerSystem):
    def __init__(self, namespace, systemName):
        ServerSystem.__init__(self, namespace, systemName)
        # âŒ åœ¨__init__ä¸­è°ƒç”¨API - æ¸¸æˆæœªåˆå§‹åŒ–å®Œæˆ!
        self.gameComp = serverApi.GetEngineCompFactory().CreateGame(levelId)  # è¿”å›None!
        self.ListenForEvent(...)  # å¯èƒ½å¤±è´¥
```

**åæœ**: GetComponentè¿”å›Noneï¼Œäº‹ä»¶ç›‘å¬å¤±è´¥ï¼Œç³»ç»Ÿæ— æ³•æ­£å¸¸å·¥ä½œã€‚

#### âœ… æ­£ç¡®æ–¹å¼ï¼šæ‰‹åŠ¨è°ƒç”¨Create()

```python
# âœ… æ­£ç¡®ç¤ºä¾‹
import mod.server.extraServerApi as serverApi
ServerSystem = serverApi.GetServerSystemCls()

class MySystem(ServerSystem):
    def __init__(self, namespace, systemName):
        ServerSystem.__init__(self, namespace, systemName)

        # 1. åªå£°æ˜æˆå‘˜å˜é‡
        self.gameComp = None
        self.players = {}

        # 2. âš ï¸ CRITICAL: æ‰‹åŠ¨è°ƒç”¨Create()
        # åŸå› : ç½‘æ˜“å¼•æ“åªè‡ªåŠ¨è°ƒç”¨Destroy()ï¼Œä¸è‡ªåŠ¨è°ƒç”¨Create()
        self.Create()

    def Create(self):
        """âœ… å®‰å…¨çš„åˆå§‹åŒ–ä½ç½®"""
        # 3. åœ¨è¿™é‡Œè·å–ç»„ä»¶/å®ä½“
        levelId = serverApi.GetLevelId()
        compFactory = serverApi.GetEngineCompFactory()
        self.gameComp = compFactory.CreateGame(levelId)

        # 4. æ³¨å†Œäº‹ä»¶ç›‘å¬
        self.ListenForEvent(
            serverApi.GetEngineNamespace(),
            serverApi.GetEngineSystemName(),
            "ServerPlayerJoinEvent",
            self,
            self.OnPlayerJoin
        )

    def Destroy(self):
        """å¼•æ“è‡ªåŠ¨è°ƒç”¨"""
        # 5. æ¸…ç†èµ„æº
        self.UnListenAllEvents()
        self.players.clear()
```

**åŸå› **: `__init__`æ—¶æ¸¸æˆå¼•æ“æœªå®Œæˆåˆå§‹åŒ–ï¼Œå®ä½“/ç»„ä»¶æœªæ³¨å†Œï¼Œè°ƒç”¨APIä¼šå¤±è´¥ã€‚

---

### 2.3 EventDataåºåˆ—åŒ–é™åˆ¶ â­â­

**æ ¸å¿ƒé—®é¢˜**: `CreateEventData()`è¿”å›çš„dictä¸æ”¯æŒtupleç±»å‹ã€‚

#### âŒ ç¦æ­¢æ“ä½œ

```python
# âŒ é”™è¯¯ç¤ºä¾‹
data = self.CreateEventData()
data["position"] = (100, 64, 100)  # tupleä¼šå¯¼è‡´åºåˆ—åŒ–å¤±è´¥!
self.NotifyToClient(playerId, "TeleportEvent", data)  # å¤±è´¥!
```

#### âœ… æ­£ç¡®æ–¹å¼ï¼šä½¿ç”¨list

```python
# âœ… æ­£ç¡®ç¤ºä¾‹
data = self.CreateEventData()
data["position"] = [100, 64, 100]  # ä½¿ç”¨list
data["items"] = [{"id": 1}, {"id": 2}]  # åµŒå¥—dictå’Œlistå¯ä»¥
self.NotifyToClient(playerId, "TeleportEvent", data)  # æˆåŠŸ
```

**æ”¯æŒçš„æ•°æ®ç±»å‹**:
- âœ… dict
- âœ… list
- âœ… str
- âœ… int, float, bool
- âŒ tupleï¼ˆä¸æ”¯æŒï¼ï¼‰
- âŒ å¯¹è±¡å®ä¾‹ï¼ˆä¸æ”¯æŒï¼ï¼‰

---

### 2.4 AOIæ„Ÿåº”åŒºèŒƒå›´é™åˆ¶

**æ ¸å¿ƒé—®é¢˜**: AOIæ„Ÿåº”åŒºé•¿å®½ä¸èƒ½è¶…è¿‡2000æ ¼ã€‚

```python
# âœ… æ­£ç¡®
dimComp.CreateEntityAOI(
    dimension=0,
    name="safe_zone",
    aabb=(0, 0, 0, 1000, 256, 1000),  # é•¿å®½1000æ ¼ï¼Œå¯ä»¥
    func=self.OnEntityEnter
)

# âŒ é”™è¯¯
dimComp.CreateEntityAOI(
    dimension=0,
    name="huge_zone",
    aabb=(0, 0, 0, 3000, 256, 3000),  # é•¿å®½3000æ ¼ï¼Œè¶…è¿‡é™åˆ¶!
    func=self.OnEntityEnter
)
```

[â¬†ï¸ è¿”å›ç›®å½•](#ç›®å½•)

---

## 3. Systemå¼€å‘è§„èŒƒ

### 3.1 æ ‡å‡†Systemæ¨¡æ¿

**ServerSystemæ ‡å‡†æ¨¡æ¿**:

```python
# -*- coding: utf-8 -*-
"""ç³»ç»Ÿè¯´æ˜
åŠŸèƒ½: XXX
è´Ÿè´£: YYY
"""

from __future__ import print_function
import mod.server.extraServerApi as serverApi
ServerSystem = serverApi.GetServerSystemCls()

class MyServerSystem(ServerSystem):
    def __init__(self, namespace, systemName):
        """åˆå§‹åŒ–System"""
        ServerSystem.__init__(self, namespace, systemName)

        # 1. å£°æ˜æˆå‘˜å˜é‡
        self.gameComp = None
        self.players = {}
        self.tickCount = 0

        # 2. âš ï¸ æ‰‹åŠ¨è°ƒç”¨Create()
        self.Create()

    def Create(self):
        """ç³»ç»Ÿåˆ›å»ºæ—¶çš„åˆå§‹åŒ–é€»è¾‘ï¼ˆæ‰‹åŠ¨è°ƒç”¨ï¼‰"""
        print("[MyServerSystem] Create() è¢«è°ƒç”¨")

        # 3. è·å–ç»„ä»¶
        levelId = serverApi.GetLevelId()
        compFactory = serverApi.GetEngineCompFactory()
        self.gameComp = compFactory.CreateGame(levelId)

        # 4. ç›‘å¬äº‹ä»¶
        self.ListenForEvent(
            serverApi.GetEngineNamespace(),
            serverApi.GetEngineSystemName(),
            "ServerPlayerJoinEvent",
            self,
            self.OnPlayerJoin
        )

    def Update(self):
        """æ¸¸æˆå¾ªç¯ - æ¯ç§’20æ¬¡ï¼ˆæ¯tickè°ƒç”¨ï¼‰"""
        self.tickCount += 1

        # æ¯100 tickï¼ˆ5ç§’ï¼‰æ‰§è¡Œä¸€æ¬¡
        if self.tickCount % 100 == 0:
            self.DoPeriodicTask()

    def Destroy(self):
        """ç³»ç»Ÿé”€æ¯æ—¶è‡ªåŠ¨è¢«å¼•æ“è°ƒç”¨"""
        print("[MyServerSystem] Destroy() è¢«è°ƒç”¨")

        # 5. æ¸…ç†èµ„æº
        self.UnListenAllEvents()
        self.players.clear()

    def OnPlayerJoin(self, args):
        """äº‹ä»¶å›è°ƒ"""
        playerId = args['playerId']
        print("[MyServerSystem] ç©å®¶åŠ å…¥:", playerId)
        self.players[playerId] = {}

    def DoPeriodicTask(self):
        """å®šæ—¶ä»»åŠ¡"""
        pass
```

**ClientSystemæ ‡å‡†æ¨¡æ¿**:

```python
# -*- coding: utf-8 -*-
"""å®¢æˆ·ç«¯ç³»ç»Ÿè¯´æ˜
åŠŸèƒ½: XXX
è´Ÿè´£: UIæ˜¾ç¤ºã€è§†è§‰æ•ˆæœ
"""

from __future__ import print_function
import mod.client.extraClientApi as clientApi
ClientSystem = clientApi.GetClientSystemCls()

class MyClientSystem(ClientSystem):
    def __init__(self, namespace, systemName):
        ClientSystem.__init__(self, namespace, systemName)

        self.uiComp = None
        self.Create()

    def Create(self):
        """åˆå§‹åŒ–"""
        print("[MyClientSystem] Create() è¢«è°ƒç”¨")

        # è·å–UIç»„ä»¶
        self.uiComp = self.GetComponent("Minecraft", "ui")

        # ç›‘å¬æœåŠ¡ç«¯äº‹ä»¶
        self.ListenForEvent(
            "MyMod",
            "MyServerSystem",
            "UpdateUI",
            self,
            self.OnUpdateUI
        )

    def Destroy(self):
        """æ¸…ç†"""
        self.UnListenAllEvents()

    def OnUpdateUI(self, args):
        """æœåŠ¡ç«¯äº‹ä»¶å›è°ƒ"""
        data = args["data"]
        # æ›´æ–°UIæ˜¾ç¤º
```

### 3.2 Systemç”Ÿå‘½å‘¨æœŸæ–¹æ³•

| æ–¹æ³• | è°ƒç”¨æ—¶æœº | æ˜¯å¦è‡ªåŠ¨è°ƒç”¨ | ç”¨é€” |
|------|---------|------------|------|
| `__init__()` | Systemå®ä¾‹åŒ–æ—¶ | âœ… è‡ªåŠ¨ | å£°æ˜å˜é‡ï¼Œæ‰‹åŠ¨è°ƒç”¨Create() |
| `Create()` | Systemåˆå§‹åŒ–æ—¶ | âŒ éœ€æ‰‹åŠ¨è°ƒç”¨ | è·å–ç»„ä»¶ã€æ³¨å†Œäº‹ä»¶ã€åŠ è½½é…ç½® |
| `Update()` | æ¯tick | âœ… è‡ªåŠ¨ | æ¸¸æˆå¾ªç¯é€»è¾‘ï¼ˆæ¯ç§’20æ¬¡ï¼‰|
| `Destroy()` | Systemé”€æ¯æ—¶ | âœ… è‡ªåŠ¨ | å–æ¶ˆç›‘å¬ã€æ¸…ç†èµ„æº |

### 3.3 Systemæ³¨å†Œ

**modConfig.pyé…ç½®**:

```python
# -*- coding: utf-8 -*-
"""æ¨¡ç»„é…ç½®æ–‡ä»¶"""

MOD_NAME = "MyMod"
MOD_VERSION = "1.0.0"

# æœåŠ¡ç«¯Systemåˆ—è¡¨
SERVER_SYSTEMS = [
    ("MyServerSystem", "MyMod.systems.MyServerSystem.MyServerSystem"),
]

# å®¢æˆ·ç«¯Systemåˆ—è¡¨
CLIENT_SYSTEMS = [
    ("MyClientSystem", "MyMod.systems.MyClientSystem.MyClientSystem"),
]
```

**modMain.pyæ³¨å†Œ**:

```python
from mod.common.mod import Mod
import mod.server.extraServerApi as serverApi
import mod.client.extraClientApi as clientApi
from modConfig import MOD_NAME, MOD_VERSION, SERVER_SYSTEMS, CLIENT_SYSTEMS

@Mod.Binding(name=MOD_NAME, version=MOD_VERSION)
class MyMod(object):

    @Mod.InitServer()
    def ServerInit(self):
        for systemName, systemPath in SERVER_SYSTEMS:
            serverApi.RegisterSystem(MOD_NAME, systemName, systemPath)

    @Mod.InitClient()
    def ClientInit(self):
        for systemName, systemPath in CLIENT_SYSTEMS:
            clientApi.RegisterSystem(MOD_NAME, systemName, systemPath)
```

[â¬†ï¸ è¿”å›ç›®å½•](#ç›®å½•)

---

## 4. Componentç»„ä»¶è§„èŒƒ

### 4.1 å¼•æ“ç»„ä»¶ä½¿ç”¨

```python
def Create(self):
    """åœ¨Createä¸­è·å–ç»„ä»¶"""
    levelId = serverApi.GetLevelId()
    playerId = "ç©å®¶ID"

    compFactory = serverApi.GetEngineCompFactory()

    # å¸¸ç”¨ç»„ä»¶
    self.gameComp = compFactory.CreateGame(levelId)        # æ¸¸æˆç®¡ç†
    self.itemComp = compFactory.CreateItem(playerId)       # ç‰©å“æ“ä½œ
    self.attrComp = compFactory.CreateAttr(playerId)       # å±æ€§ç®¡ç†
    self.posComp = compFactory.CreatePos(playerId)         # ä½ç½®æ§åˆ¶
    self.dimComp = compFactory.CreateDimension(levelId)    # ç»´åº¦ç®¡ç†
```

### 4.2 è‡ªå®šä¹‰ç»„ä»¶å¼€å‘

**å®šä¹‰ç»„ä»¶**:

```python
# components/MyComponent.py
from mod.server.component import ServerComponent

class MyComponent(ServerComponent):
    def __init__(self, entityId):
        ServerComponent.__init__(self, entityId)
        self.customData = {}

    def GetData(self):
        return self.customData

    def SetData(self, data):
        self.customData = data
```

**æ³¨å†Œç»„ä»¶**:

```python
@Mod.InitServer()
def ServerInit(self):
    serverApi.RegisterComponent(
        "MyMod",
        "MyComponent",
        "MyMod.components.MyComponent.MyComponent"
    )
```

**ä½¿ç”¨ç»„ä»¶**:

```python
comp = serverApi.CreateComponent(entityId, "MyMod", "MyComponent")
comp.SetData({"key": "value"})
```

[â¬†ï¸ è¿”å›ç›®å½•](#ç›®å½•)

---

## 5. Eventäº‹ä»¶ç³»ç»Ÿ

### 5.1 ç›‘å¬å¼•æ“äº‹ä»¶

```python
def Create(self):
    """ç›‘å¬æ¸¸æˆåŸç”Ÿäº‹ä»¶"""
    # æ–¹å¼1: ä½¿ç”¨å‘½åç©ºé—´å’Œç³»ç»Ÿå
    self.ListenForEvent(
        serverApi.GetEngineNamespace(),     # "Minecraft"
        serverApi.GetEngineSystemName(),    # "serverSystem"
        "ServerPlayerJoinEvent",            # äº‹ä»¶å
        self,                               # å›è°ƒå¯¹è±¡
        self.OnPlayerJoin,                  # å›è°ƒå‡½æ•°
        priority=0                          # ä¼˜å…ˆçº§(0-10ï¼Œè¶Šå¤§è¶Šæ—©)
    )

def OnPlayerJoin(self, args):
    """äº‹ä»¶å›è°ƒ

    args = {
        'playerId': str,
        'username': str,
        ...
    }
    """
    playerId = args['playerId']
    print("ç©å®¶åŠ å…¥:", playerId)
    return True  # è¿”å›Falseå¯ä»¥é˜»æ­¢åç»­ç›‘å¬å™¨æ‰§è¡Œ
```

### 5.2 äº‹ä»¶ä¼˜å…ˆçº§æœºåˆ¶

```python
def Create(self):
    # é«˜ä¼˜å…ˆçº§ç›‘å¬å™¨ï¼ˆå…ˆæ‰§è¡Œï¼‰
    self.ListenForEvent(
        serverApi.GetEngineNamespace(),
        serverApi.GetEngineSystemName(),
        "ServerChatEvent",
        self,
        self.OnChatCheck,
        priority=10  # æœ€é«˜ä¼˜å…ˆçº§ï¼Œç”¨äºæ£€æŸ¥/æ‹¦æˆª
    )

    # é»˜è®¤ä¼˜å…ˆçº§ç›‘å¬å™¨ï¼ˆåæ‰§è¡Œï¼‰
    self.ListenForEvent(
        serverApi.GetEngineNamespace(),
        serverApi.GetEngineSystemName(),
        "ServerChatEvent",
        self,
        self.OnChatProcess,
        priority=0  # é»˜è®¤ä¼˜å…ˆçº§
    )

def OnChatCheck(self, args):
    """ä¼˜å…ˆæ‰§è¡Œ - å¯ä»¥æ‹¦æˆªäº‹ä»¶"""
    if "ç¦è¨€è¯" in args['message']:
        return False  # é˜»æ­¢åç»­ç›‘å¬å™¨æ‰§è¡Œ
    return True

def OnChatProcess(self, args):
    """åæ‰§è¡Œ - æ­£å¸¸å¤„ç†"""
    print("èŠå¤©:", args['message'])
```

### 5.3 è‡ªå®šä¹‰äº‹ä»¶

**å®šä¹‰äº‹ä»¶**:

```python
def Create(self):
    # å®šä¹‰è‡ªå®šä¹‰äº‹ä»¶
    self.DefineEvent("MyCustomEvent")
```

**å¹¿æ’­äº‹ä»¶**:

```python
def TriggerCustomEvent(self):
    data = self.CreateEventData()
    data["param1"] = 123
    data["param2"] = "abc"
    # æœ¬ç«¯å¹¿æ’­
    self.BroadcastEvent("MyCustomEvent", data)
```

**ç›‘å¬è‡ªå®šä¹‰äº‹ä»¶**:

```python
def Create(self):
    self.ListenForEvent(
        "MyMod",
        "MyServerSystem",
        "MyCustomEvent",
        self,
        self.OnCustomEvent
    )

def OnCustomEvent(self, args):
    param1 = args["param1"]
    param2 = args["param2"]
```

### 5.4 åŒç«¯äº‹ä»¶é€šä¿¡è¯¦è§£

**æœåŠ¡ç«¯â†’å®¢æˆ·ç«¯**:

```python
# å‘é€ç»™å•ä¸ªå®¢æˆ·ç«¯
def NotifyClient(self, playerId):
    data = self.CreateEventData()
    data["message"] = "Hello"
    self.NotifyToClient(playerId, "UpdateUI", data)

# å¹¿æ’­ç»™æ‰€æœ‰å®¢æˆ·ç«¯
def BroadcastAll(self):
    data = self.CreateEventData()
    data["message"] = "Global Announcement"
    self.BroadcastToAllClient("GlobalMessage", data)

# å‘é€ç»™å¤šä¸ªå®¢æˆ·ç«¯ï¼ˆæ€§èƒ½ä¼˜äºå¾ªç¯NotifyToClientï¼‰
def NotifyMultiple(self, playerIds):
    data = self.CreateEventData()
    data["message"] = "Team Message"
    self.NotifyToMultiClients(playerIds, "TeamMessage", data)
```

**å®¢æˆ·ç«¯â†’æœåŠ¡ç«¯**:

```python
# å®¢æˆ·ç«¯å‘é€
def SendToServer(self):
    data = self.CreateEventData()
    data["action"] = "buy"
    data["itemId"] = 1
    self.NotifyToServer("PurchaseRequest", data)

# æœåŠ¡ç«¯ç›‘å¬ï¼ˆargsä¼šè‡ªåŠ¨åŒ…å«'__id__'å­—æ®µï¼‰
def Create(self):
    self.ListenForEvent(
        "MyMod",
        "MyClientSystem",
        "PurchaseRequest",
        self,
        self.OnPurchase
    )

def OnPurchase(self, args):
    playerId = args['__id__']  # âš ï¸ è‡ªåŠ¨åŒ…å«å‘é€è€…ID
    action = args['action']
    itemId = args['itemId']
    print("ç©å®¶{}è¯·æ±‚è´­ä¹°ç‰©å“{}".format(playerId, itemId))
```

[â¬†ï¸ è¿”å›ç›®å½•](#ç›®å½•)

---

## 6. Entityå®ä½“ç®¡ç†

### 6.1 åˆ›å»ºå®ä½“

**æœåŠ¡ç«¯åˆ›å»ºå®ä½“ï¼ˆä¼šåŒæ­¥åˆ°æ‰€æœ‰å®¢æˆ·ç«¯ï¼‰**:

```python
def CreateServerEntity(self):
    """æœåŠ¡ç«¯åˆ›å»ºå®ä½“ - æ‰€æœ‰å®¢æˆ·ç«¯å¯è§"""
    entityId = self.CreateEngineEntityByTypeStr(
        'minecraft:zombie',      # identifier
        (0, 10, 0),             # pos (x, y, z)
        (0, 0),                 # rotation (pitch, yaw)
        0,                      # dimensionId (0=ä¸»ä¸–ç•Œ, 1=åœ°ç‹±, 2=æœ«åœ°)
        False,                  # isNpc
        False                   # isGlobal (å…¨å±€å®ä½“ä¸ä¼šè¢«å¸è½½)
    )
    return entityId
```

**å®¢æˆ·ç«¯åˆ›å»ºå®ä½“ï¼ˆä»…æœ¬åœ°å¯è§ï¼‰**:

```python
def CreateClientEntity(self):
    """å®¢æˆ·ç«¯åˆ›å»ºå®ä½“ - ä»…æœ¬åœ°å®¢æˆ·ç«¯å¯è§"""
    entityId = self.CreateClientEntityByTypeStr(
        'minecraft:armor_stand',
        (0, 5, 0),
        (0, 0)
    )
    return entityId
```

### 6.2 å®ä½“æ“ä½œ

```python
# æ£€æŸ¥å®ä½“æ˜¯å¦å­˜æ´»
alive = self.gameComp.IsEntityAlive(entityId)

# é”€æ¯å®ä½“
self.DestroyEntity(entityId)

# è·å–æ‰€æœ‰å®ä½“
entityDicts = serverApi.GetEngineActor()  # {entityId: {dimensionId, identifier}}

# è·å–ç©å®¶åˆ—è¡¨
playerIds = serverApi.GetPlayerList()
```

### 6.3 AOIæ„Ÿåº”åŒº

```python
def Create(self):
    """æ³¨å†Œæ„Ÿåº”åŒº"""
    compFactory = serverApi.GetEngineCompFactory()
    dimComp = compFactory.CreateDimension(levelId)

    # åˆ›å»ºæ„Ÿåº”åŒº
    dimComp.CreateEntityAOI(
        dimension=0,                    # ä¸»ä¸–ç•Œ
        name="safe_zone",               # æ„Ÿåº”åŒºåç§°
        aabb=(0, 0, 0, 100, 256, 100),  # èŒƒå›´(minX,minY,minZ,maxX,maxY,maxZ)
        func=self.OnEntityEnterOrLeave  # å›è°ƒå‡½æ•°
    )

def OnEntityEnterOrLeave(self, args):
    """æ„Ÿåº”åŒºå›è°ƒ

    args = {
        'AOIName': 'safe_zone',
        'entityType': int,
        'pos': (x, y, z),      # ä»…è¿›å…¥æ—¶æœ‰
        'dimension': 0,
        'entityId': str,
        'identifier': str,
        'isEnter': bool        # True=è¿›å…¥, False=ç¦»å¼€
    }
    """
    if args['isEnter']:
        print("å®ä½“{}è¿›å…¥å®‰å…¨åŒº".format(args['entityId']))
    else:
        print("å®ä½“{}ç¦»å¼€å®‰å…¨åŒº".format(args['entityId']))
```

**âš ï¸ AOIé™åˆ¶**:
- æ„Ÿåº”åŒºé•¿å®½ä¸èƒ½è¶…è¿‡2000æ ¼
- æ¨èä½¿ç”¨å¤šä¸ªå°æ„Ÿåº”åŒºè€Œéå•ä¸ªå¤§æ„Ÿåº”åŒº

[â¬†ï¸ è¿”å›ç›®å½•](#ç›®å½•)

---

## 7. æ¨¡å—å¯¼å…¥è§„èŒƒ âš ï¸ CRITICAL

### 7.1 å…³é”®é—®é¢˜

**ç½‘æ˜“å¼•æ“çš„ModåŠ è½½æœºåˆ¶ä¼šæ‰«ææ¨¡å—çš„æ‰€æœ‰å±æ€§**ï¼Œå°è¯•å®ä¾‹åŒ–ä»»ä½•å…·æœ‰`MOD_NAME`å±æ€§çš„å¯¹è±¡ã€‚

**é”™è¯¯çš„å¯¼å…¥æ–¹å¼ä¼šå¯¼è‡´**ï¼š
```
TypeError: 'module' object is not callable
```

### 7.2 é—®é¢˜æ ¹æº

ç½‘æ˜“å¼•æ“çš„`ImportModMain()`å‡½æ•°å®ç°ï¼š

```python
def ImportModMain(self, modMainPath, initTypeString):
    modModule = __import__(modMainPath, fromlist=[''])

    for mKey in dir(modModule):  # âš ï¸ éå†æ¨¡å—çš„æ‰€æœ‰å±æ€§
        cls = getattr(modModule, mKey)
        if not hasattr(cls, 'MOD_NAME'):
            continue
        instance = cls()  # âŒ å°è¯•è°ƒç”¨ - å¦‚æœclsæ˜¯moduleå¯¹è±¡ä¼šæŠ¥é”™!
```

### 7.3 âœ… æ­£ç¡®çš„å¯¼å…¥è§„èŒƒ

#### è§„åˆ™1ï¼šæ°¸è¿œä¸è¦ä½¿ç”¨ `import module` å¯¼å…¥é…ç½®æ¨¡å—

**å¯¹äºåŒ…å«`MOD_NAME`å¸¸é‡çš„é…ç½®æ¨¡å—**ï¼Œå¿…é¡»ä½¿ç”¨ `from ... import ...`ï¼š

```python
# âœ… æ­£ç¡®å¯¼å…¥æ–¹å¼
from mod.common.mod import Mod
import mod.client.extraClientApi as clientApi
import mod.server.extraServerApi as serverApi

# âš ï¸ å…³é”®ï¼šä½¿ç”¨from...importå¯¼å…¥ï¼Œè€Œéimport modConfig
from modConfig import MOD_NAME, MOD_VERSION, SERVER_SYSTEMS, CLIENT_SYSTEMS

@Mod.Binding(name=MOD_NAME, version=MOD_VERSION)
class MyMod(object):
    def __init__(self):
        pass

    @Mod.InitServer()
    def ServerInit(self):
        # âœ… ä½¿ç”¨ç›´æ¥å¯¼å…¥çš„å˜é‡å
        for systemName, systemPath in SERVER_SYSTEMS:
            serverApi.RegisterSystem(MOD_NAME, systemName, systemPath)
```

#### è§„åˆ™2ï¼šå­ç›®å½•ä¸­å¯¼å…¥modConfigå¿…é¡»ä½¿ç”¨å®Œæ•´è·¯å¾„

**åœ¨å­ç›®å½•æ–‡ä»¶ä¸­**ï¼ˆå¦‚ `config/`, `systems/`ï¼‰ï¼Œå¯¼å…¥`modConfig`æ—¶å¿…é¡»ä½¿ç”¨**å®Œæ•´çš„åŒ…è·¯å¾„**ï¼š

```python
# âœ… æ­£ç¡® - åœ¨å­ç›®å½•ä¸­ä½¿ç”¨å®Œæ•´è·¯å¾„
# æ–‡ä»¶ä½ç½®: MyMod/systems/MySystem.py
from MyMod.modConfig import MOD_NAME

# âŒ é”™è¯¯ - åœ¨å­ç›®å½•ä¸­ä½¿ç”¨ç›¸å¯¹å¯¼å…¥ä¼šå¯¼è‡´ImportError
# æ–‡ä»¶ä½ç½®: MyMod/systems/MySystem.py
from modConfig import MOD_NAME  # ImportError: No module named modConfig
```

**åŸå› **ï¼š
- `modConfig.py` ä½äº `MyMod/` æ ¹ç›®å½•
- å­ç›®å½•æ–‡ä»¶ï¼ˆå¦‚ `MyMod/systems/MySystem.py`ï¼‰ä¸åœ¨åŒä¸€ç›®å½•å±‚çº§
- Pythonæ¨¡å—è§£æè§„åˆ™è¦æ±‚ä½¿ç”¨å®Œæ•´è·¯å¾„ä»åŒ…æ ¹å¼€å§‹å¯¼å…¥

**æ­£ç¡®åšæ³•å¯¹ç…§è¡¨**ï¼š

| æ–‡ä»¶ä½ç½® | æ­£ç¡®å¯¼å…¥æ–¹å¼ | é”™è¯¯å¯¼å…¥æ–¹å¼ |
|---------|-------------|-------------|
| `MyMod/modMain.py` | `from modConfig import MOD_NAME` | âœ… åŒçº§ç›®å½•å¯ç”¨ |
| `MyMod/systems/MySystem.py` | `from MyMod.modConfig import MOD_NAME` | âŒ `from modConfig import ...` |
| `MyMod/config/game_config.py` | `from MyMod.modConfig import MOD_NAME` | âŒ `from modConfig import ...` |

#### è§„åˆ™3ï¼šAPIæ¨¡å—å¯ä»¥ä½¿ç”¨ `import ... as ...`

**è¿™äº›æ¨¡å—ä¸åŒ…å«`MOD_NAME`ï¼Œä¸ä¼šè¢«å¼•æ“è¯¯è¯†åˆ«**ï¼š

```python
# âœ… æ­£ç¡®
import mod.server.extraServerApi as serverApi
import mod.client.extraClientApi as clientApi
```

#### è§„åˆ™4ï¼šæ™®é€šæ¨¡å—ä¼˜å…ˆä½¿ç”¨ `from ... import ...`

```python
# âœ… æ¨è
from systems.MySystem import MySystem
from config.game_config import GAME_CONFIG

# âš ï¸ å¯ç”¨ä½†ä¸æ¨èï¼ˆå¦‚æœæ¨¡å—åŒ…å«ç‰¹æ®Šå±æ€§å¯èƒ½æœ‰é£é™©ï¼‰
import systems.MySystem
```

### 7.4 é€šç”¨å¯¼å…¥å‡†åˆ™

| æ¨¡å—ç±»å‹ | æ–‡ä»¶ä½ç½® | æ­£ç¡®å¯¼å…¥æ–¹å¼ | é”™è¯¯å¯¼å…¥æ–¹å¼ |
|---------|---------|-------------|-------------|
| **é…ç½®æ¨¡å—**ï¼ˆæœ‰MOD_NAMEï¼‰ | modMain.pyåŒçº§ | `from modConfig import VAR` | âŒ `import modConfig` |
| **é…ç½®æ¨¡å—**ï¼ˆæœ‰MOD_NAMEï¼‰ | å­ç›®å½•ï¼ˆsystems/config/ï¼‰ | `from MyMod.modConfig import VAR` | âŒ `from modConfig import VAR` |
| **APIæ¨¡å—** | ä»»ä½•ä½ç½® | `import mod.server.extraServerApi as api` | âœ… å¯ç”¨ |
| **ç³»ç»Ÿæ¨¡å—** | ä»»ä½•ä½ç½® | `from systems.XXX import XXX` | âœ… æ¨è |

[â¬†ï¸ è¿”å›ç›®å½•](#ç›®å½•)

---

## 8. å‘½åè§„èŒƒ

### 8.1 ç±»åï¼šPascalCase

```python
# âœ… æ­£ç¡®
class MyGameSystem(ServerSystem):
    pass

class DataManager(object):
    pass

# âŒ é”™è¯¯
class mygameSystem(ServerSystem):  # é¦–å­—æ¯åº”å¤§å†™
    pass
```

### 8.2 æ–¹æ³•/å‡½æ•°åï¼šsnake_case

```python
# âœ… æ­£ç¡®
def on_player_join(self):
    pass

def get_player_team_id(self, player_id):
    pass

# âŒ é”™è¯¯
def OnPlayerJoin(self):  # åº”ä½¿ç”¨snake_case
    pass
```

### 8.3 å¸¸é‡ï¼šUPPER_SNAKE_CASE

```python
# âœ… æ­£ç¡®
MOD_NAME = "MyMod"
MOD_VERSION = "1.0.0"
MAX_PLAYERS_PER_TEAM = 4

# âŒ é”™è¯¯
modName = "MyMod"  # åº”å…¨å¤§å†™
```

### 8.4 ç§æœ‰æˆå‘˜ï¼šå•ä¸‹åˆ’çº¿å‰ç¼€

```python
# âœ… æ­£ç¡®
class MySystem(ServerSystem):
    def __init__(self, namespace, systemName):
        self._created = False  # ç§æœ‰æˆå‘˜
        self._internal_state = {}

    def _internal_method(self):  # ç§æœ‰æ–¹æ³•
        pass
```

### 8.5 äº‹ä»¶å›è°ƒï¼šOnå‰ç¼€

```python
# âœ… æ­£ç¡® - ä½¿ç”¨Onå‰ç¼€
def OnPlayerJoin(self, args):
    pass

def OnPlayerDie(self, args):
    pass

# âŒ é”™è¯¯ - å‘½åä¸æ¸…æ™°
def handle_join(self, args):  # åº”ä½¿ç”¨Onå‰ç¼€
    pass
```

[â¬†ï¸ è¿”å›ç›®å½•](#ç›®å½•)

---

## 9. æ–‡ä»¶ç»„ç»‡

### 9.1 æ¨¡å—æ–‡ä»¶ç»“æ„

æ¯ä¸ªPythonæ–‡ä»¶åº”éµå¾ªä»¥ä¸‹ç»“æ„ï¼š

```python
# -*- coding: utf-8 -*-
"""
æ¨¡å—åç§°å’Œç®€è¦è¯´æ˜

è¯¦ç»†è¯´æ˜ï¼ˆå¯é€‰ï¼‰ï¼š
- åŠŸèƒ½1
- åŠŸèƒ½2
"""

# 1. æ ‡å‡†åº“å¯¼å…¥
from __future__ import print_function

# 2. ç½‘æ˜“å¼•æ“å¯¼å…¥
import mod.server.extraServerApi as serverApi

# 3. ç¬¬ä¸‰æ–¹åº“å¯¼å…¥ï¼ˆå¦‚æœ‰ï¼‰
# import third_party_lib

# 4. é¡¹ç›®å†…éƒ¨å¯¼å…¥
from MyMod.config.game_config import GAME_CONFIG
from MyMod.modConfig import MOD_NAME

# 5. ç±»å‹æ³¨è§£ï¼ˆæ³¨é‡Šå½¢å¼ï¼‰
# type: (str) -> bool

# 6. å¸¸é‡å®šä¹‰
DEFAULT_RADIUS = 5.0

# 7. ç±»å®šä¹‰
class MyClass(object):
    pass

# 8. å‡½æ•°å®šä¹‰
def my_function():
    pass
```

### 9.2 æ¨èç›®å½•ç»“æ„

```
MyMod/
â”œâ”€â”€ __init__.py
â”œâ”€â”€ modMain.py          # Modå…¥å£
â”œâ”€â”€ modConfig.py        # ä¸»é…ç½®
â”œâ”€â”€ systems/            # Systemç³»ç»Ÿ
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ MyServerSystem.py
â”‚   â”œâ”€â”€ MyClientSystem.py
â”‚   â””â”€â”€ util/           # å·¥å…·ç±»
â”‚       â”œâ”€â”€ __init__.py
â”‚       â””â”€â”€ Helper.py
â”œâ”€â”€ components/         # è‡ªå®šä¹‰ç»„ä»¶
â”‚   â”œâ”€â”€ __init__.py
â”‚   â””â”€â”€ MyComponent.py
â””â”€â”€ config/             # é…ç½®æ–‡ä»¶
    â”œâ”€â”€ __init__.py
    â”œâ”€â”€ game_config.py
    â””â”€â”€ item_config.py
```

### 9.3 __init__.pyæ–‡ä»¶

æ¯ä¸ªPythonåŒ…ç›®å½•å¿…é¡»åŒ…å«`__init__.py`ï¼š

```python
# -*- coding: utf-8 -*-
"""
åŒ…è¯´æ˜
"""

# å¯ä»¥ä¸ºç©ºï¼Œæˆ–å¯¼å‡ºå¸¸ç”¨ç±»/å‡½æ•°
from .MyClass import MyClass
from .my_function import my_function

__all__ = ['MyClass', 'my_function']
```

[â¬†ï¸ è¿”å›ç›®å½•](#ç›®å½•)

---

## 10. æ€§èƒ½ä¼˜åŒ–å»ºè®®

### 10.1 é¿å…åœ¨Update()ä¸­æ‰§è¡Œè€—æ—¶æ“ä½œ

```python
# âœ… æ­£ç¡® - ä½¿ç”¨è®¡æ•°å™¨é™ä½é¢‘ç‡
class MySystem(ServerSystem):
    def __init__(self, namespace, systemName):
        ServerSystem.__init__(self, namespace, systemName)
        self.tickCounter = 0
        self.Create()

    def Update(self):
        self.tickCounter += 1

        # æ¯20 tickï¼ˆ1ç§’ï¼‰æ‰§è¡Œä¸€æ¬¡
        if self.tickCounter % 20 == 0:
            self.updateExpensiveCalculation()

# âŒ é”™è¯¯ - æ¯tickéƒ½æ‰§è¡Œè€—æ—¶æ“ä½œ
class MySystem(ServerSystem):
    def Update(self):
        # æ¯tickéƒ½æŸ¥è¯¢æ•°æ®åº“ã€è®¡ç®—å¤æ‚é€»è¾‘ç­‰
        self.queryDatabase()
        self.complexCalculation()
```

### 10.2 åŠæ—¶å–æ¶ˆäº‹ä»¶ç›‘å¬

```python
# âœ… æ­£ç¡® - åœ¨Destroyä¸­å–æ¶ˆç›‘å¬
def Create(self):
    self.ListenForEvent("SomeEvent", "Minecraft", self, self.handler)

def Destroy(self):
    self.UnListenAllEvents()  # æ¸…ç†æ‰€æœ‰ç›‘å¬
```

### 10.3 ç¼“å­˜é¢‘ç¹è®¿é—®çš„æ•°æ®

```python
# âœ… æ­£ç¡® - ä½¿ç”¨æˆå‘˜å˜é‡ç¼“å­˜
class MySystem(ServerSystem):
    def __init__(self, namespace, systemName):
        ServerSystem.__init__(self, namespace, systemName)
        self.playerCache = {}  # ç¼“å­˜ç©å®¶æ•°æ®
        self.Create()

    def getPlayerTeam(self, playerId):
        if playerId in self.playerCache:
            return self.playerCache[playerId]

        team = self._queryPlayerTeam(playerId)
        self.playerCache[playerId] = team
        return team
```

### 10.4 æ‰¹é‡æ“ä½œ

```python
# âœ… æ­£ç¡® - æ‰¹é‡å¤„ç†
def updateAllPlayersHUD(self, message):
    playerIds = self.getAllPlayers()
    data = self.CreateEventData()
    data["message"] = message
    # ä½¿ç”¨NotifyToMultiClientsæ‰¹é‡å‘é€ï¼ˆæ€§èƒ½æ›´å¥½ï¼‰
    self.NotifyToMultiClients(playerIds, "UpdateHUD", data)

# âŒ é”™è¯¯ - å¾ªç¯å•ä¸ªå‘é€
def updateAllPlayersHUD(self, message):
    for playerId in self.getAllPlayers():
        data = self.CreateEventData()
        data["message"] = message
        self.NotifyToClient(playerId, "UpdateHUD", data)  # æ€§èƒ½å·®
```

### 10.5 æ—¥å¿—æ§åˆ¶

```python
# âœ… æ­£ç¡® - ä½¿ç”¨æ—¥å¿—çº§åˆ«
DEBUG = False  # ç”Ÿäº§ç¯å¢ƒè®¾ä¸ºFalse

def onPlayerJoin(self, playerId):
    if DEBUG:
        print("[DEBUG] ç©å®¶åŠ å…¥:", playerId)

    # æ ¸å¿ƒé€»è¾‘...

# âŒ é”™è¯¯ - ç”Ÿäº§ç¯å¢ƒå¤§é‡æ—¥å¿—
def onPlayerJoin(self, playerId):
    print("ç©å®¶åŠ å…¥:", playerId)
    print("å½“å‰ç©å®¶åˆ—è¡¨:", self.players)
    print("å½“å‰çŠ¶æ€:", self.currentState)
    # å¤§é‡æ—¥å¿—å½±å“æ€§èƒ½
```

[â¬†ï¸ è¿”å›ç›®å½•](#ç›®å½•)

---

## 11. ç½‘æ˜“å¼•æ“é™åˆ¶

### 11.1 Pythonç‰ˆæœ¬

- âœ… **å¿…é¡»å…¼å®¹Python 2.7**
- âŒ ä¸èƒ½ä½¿ç”¨Python 3ä¸“æœ‰ç‰¹æ€§

### 11.2 å®ä½“æ ‡è¯†ç¬¦

- âœ… å®ä½“ç±»å‹åç§°å»ºè®®ä¸è¶…è¿‡32å­—ç¬¦
- âœ… ä½¿ç”¨å°å†™å­—æ¯å’Œä¸‹åˆ’çº¿ï¼š`mygame_entity_custom`
- âœ… ä½¿ç”¨å‘½åç©ºé—´ï¼š`namespace:entity_type`

### 11.3 ç»´åº¦ç®¡ç†

- âœ… ç»´åº¦IDå¿…é¡»æ˜¯æ•´æ•°
- âœ… æ¨èä½¿ç”¨10000ä»¥ä¸Šçš„IDé¿å…å†²çª
- âœ… ä¸»ä¸–ç•Œï¼š0ï¼Œåœ°ç‹±ï¼š1ï¼Œæœ«åœ°ï¼š2

### 11.4 äº‹ä»¶ç³»ç»Ÿ

- âœ… è‡ªå®šä¹‰äº‹ä»¶åç§°å»ºè®®ä½¿ç”¨é©¼å³°å‘½åï¼š`TeamResourceUpdateEvent`
- âœ… äº‹ä»¶æ•°æ®å¿…é¡»æ˜¯å¯åºåˆ—åŒ–çš„ï¼ˆdictã€listã€strã€intã€floatã€boolï¼‰
- âŒ ä¸èƒ½ä¼ é€’tupleï¼ˆä¼šå¯¼è‡´åºåˆ—åŒ–å¤±è´¥ï¼‰
- âŒ ä¸èƒ½ä¼ é€’å¯¹è±¡å®ä¾‹

### 11.5 ç»„ä»¶é™åˆ¶

- âš ï¸ æŸäº›ç»„ä»¶åœ¨ç‰¹å®šç»´åº¦æˆ–æ¸¸æˆæ¨¡å¼ä¸‹å¯èƒ½ä¸å¯ç”¨
- âš ï¸ å®¢æˆ·ç«¯ç»„ä»¶ä¸èƒ½åœ¨æœåŠ¡ç«¯ä½¿ç”¨ï¼Œåä¹‹äº¦ç„¶
- âš ï¸ éœ€è¦åœ¨Create()ä¸­è·å–ç»„ä»¶ï¼Œä¸èƒ½åœ¨__init__ä¸­

### 11.6 AOIé™åˆ¶

- âš ï¸ AOIæ„Ÿåº”åŒºé•¿å®½ä¸èƒ½è¶…è¿‡2000æ ¼
- âš ï¸ æ¨èä½¿ç”¨å¤šä¸ªå°æ„Ÿåº”åŒº
- âš ï¸ åŒºå—å¸è½½æ—¶IsEntityAliveè¿”å›False

[â¬†ï¸ è¿”å›ç›®å½•](#ç›®å½•)

---

## æ£€æŸ¥æ¸…å•

åœ¨æäº¤ä»£ç å‰ï¼Œè¯·ç¡®è®¤ï¼š

### Python 2.7å…¼å®¹æ€§
- [ ] æ–‡ä»¶å¼€å¤´æœ‰ `# -*- coding: utf-8 -*-`
- [ ] å¯¼å…¥äº† `from __future__ import print_function`
- [ ] ä½¿ç”¨ `.format()` è€Œé f-strings
- [ ] ç±»å‹æ³¨è§£ä½¿ç”¨æ³¨é‡Šå½¢å¼

### CRITICALè§„èŒƒ
- [ ] æ²¡æœ‰è·¨ç«¯GetSystemï¼ˆä½¿ç”¨NotifyToClient/Serverï¼‰
- [ ] åœ¨ `__init__` ä¸­æ‰‹åŠ¨è°ƒç”¨äº† `self.Create()`
- [ ] `Create()` ä¸­åŒ…å«åˆå§‹åŒ–é€»è¾‘
- [ ] `Destroy()` ä¸­åŒ…å«æ¸…ç†é€»è¾‘
- [ ] EventDataæ²¡æœ‰ä½¿ç”¨tupleï¼ˆä½¿ç”¨listï¼‰

### æ¨¡å—å¯¼å…¥
- [ ] é…ç½®æ¨¡å—ä½¿ç”¨ `from ... import ...`
- [ ] æ²¡æœ‰ä½¿ç”¨ `import modConfig`
- [ ] **å­ç›®å½•æ–‡ä»¶ä½¿ç”¨ `from MyMod.modConfig import ...`**
- [ ] **modMain.pyåŒçº§æ–‡ä»¶ä½¿ç”¨ `from modConfig import ...`**

### å‘½åè§„èŒƒ
- [ ] ç±»åä½¿ç”¨PascalCase
- [ ] æ–¹æ³•åä½¿ç”¨snake_case
- [ ] å¸¸é‡ä½¿ç”¨UPPER_SNAKE_CASE
- [ ] äº‹ä»¶å›è°ƒä½¿ç”¨Onå‰ç¼€

### æ€§èƒ½
- [ ] `Update()` ä¸­é¿å…è€—æ—¶æ“ä½œ
- [ ] åŠæ—¶å–æ¶ˆäº‹ä»¶ç›‘å¬
- [ ] ç¼“å­˜é¢‘ç¹è®¿é—®çš„æ•°æ®
- [ ] æ‰¹é‡æ“ä½œä½¿ç”¨NotifyToMultiClients

[â¬†ï¸ è¿”å›ç›®å½•](#ç›®å½•)

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

### å­¦ä¹ è·¯å¾„
- **ä¸Šä¸€ç¯‡**: [å¿«é€Ÿå¼€å§‹](./å¿«é€Ÿå¼€å§‹.md) ğŸš€
- **å½“å‰**: å¼€å‘è§„èŒƒ ğŸ“
- **ä¸‹ä¸€ç¯‡**: [å¼€å‘æŒ‡å—](./å¼€å‘æŒ‡å—.md) ğŸ“–

### å¿…è¯»æ–‡æ¡£
- [é—®é¢˜æ’æŸ¥](./é—®é¢˜æ’æŸ¥.md) - è¿åè§„èŒƒæ—¶æŸ¥çœ‹
- [å¼€å‘æŒ‡å—](./å¼€å‘æŒ‡å—.md) - å®Œæ•´å¼€å‘æµç¨‹
- [CLAUDE.md](../CLAUDE.md) - AIå·¥ä½œæµå‚è€ƒ

### å®˜æ–¹èµ„æº
- [ç½‘æ˜“MODSDK Wiki](https://github.com/EaseCation/netease-modsdk-wiki) - å®˜æ–¹APIæ–‡æ¡£
- [åŸºå²©ç‰ˆWiki](https://github.com/Bedrock-OSS/bedrock-wiki) - åŸç‰ˆæœºåˆ¶å‚è€ƒ

---

## ğŸ”— å¿«é€Ÿé“¾æ¥

| æ ¸å¿ƒè§„èŒƒ | å¼€å‘æŒ‡å— | å‚è€ƒèµ„æ–™ |
|---------|---------|---------|
| [ğŸ  é¦–é¡µ](../README.md) | [ğŸ“– å¼€å‘æŒ‡å—](./å¼€å‘æŒ‡å—.md) | [ğŸ—ï¸ æ¶æ„æ–‡æ¡£](../CLAUDE.md) |
| [ğŸš€ å¿«é€Ÿå¼€å§‹](./å¿«é€Ÿå¼€å§‹.md) | [ğŸ”§ é—®é¢˜æ’æŸ¥](./é—®é¢˜æ’æŸ¥.md) | [ğŸ“Š é¡¹ç›®çŠ¶æ€](./é¡¹ç›®çŠ¶æ€.md) |

---

**[â¬†ï¸ è¿”å›é¡¶éƒ¨](#å¼€å‘è§„èŒƒ)** | **[ğŸ  è¿”å›é¦–é¡µ](../README.md)** | **[â¡ï¸ ä¸‹ä¸€ç¯‡: å¼€å‘æŒ‡å—](./å¼€å‘æŒ‡å—.md)**

---

_æœ€åæ›´æ–°: 2025-11-09 | æ–‡æ¡£ç‰ˆæœ¬: 3.0 (åŸºäºMODSDKå®˜æ–¹æ–‡æ¡£å…¨é¢é‡æ„)_

---

**è®°ä½**ï¼šéµå¾ªè¿™äº›è§„èŒƒå¯ä»¥é¿å…90%çš„å¸¸è§é”™è¯¯ï¼
