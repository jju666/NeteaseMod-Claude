# äº‹ä»¶ç³»ç»Ÿå®Œæ•´å‚è€ƒ

> ğŸ“¡ **æ·±å…¥ç†è§£MODSDKäº‹ä»¶é©±åŠ¨æ¶æ„**
>
> æœ¬æ–‡æ¡£è¯¦ç»†è®²è§£MODSDKäº‹ä»¶ç³»ç»Ÿçš„å·¥ä½œåŸç†ã€æœ€ä½³å®è·µå’Œæ€§èƒ½ä¼˜åŒ–ç­–ç•¥
>
> **ç‰ˆæœ¬**: v1.0
> **æœ€åæ›´æ–°**: 2025-11-11

---

## ç›®å½•

1. [äº‹ä»¶ç³»ç»Ÿæ¦‚è¿°](#ä¸€äº‹ä»¶ç³»ç»Ÿæ¦‚è¿°)
2. [äº‹ä»¶ç±»å‹åˆ†ç±»](#äºŒäº‹ä»¶ç±»å‹åˆ†ç±»)
3. [äº‹ä»¶ç›‘å¬ä¸é€šçŸ¥](#ä¸‰äº‹ä»¶ç›‘å¬ä¸é€šçŸ¥)
4. [äº‹ä»¶ä¼˜å…ˆçº§æœºåˆ¶](#å››äº‹ä»¶ä¼˜å…ˆçº§æœºåˆ¶)
5. [äº‹ä»¶æ•°æ®è§„èŒƒ](#äº”äº‹ä»¶æ•°æ®è§„èŒƒ)
6. [ç½‘ç»œäº‹ä»¶ä¼˜åŒ–](#å…­ç½‘ç»œäº‹ä»¶ä¼˜åŒ–)
7. [æ€§èƒ½ä¼˜åŒ–å»ºè®®](#ä¸ƒæ€§èƒ½ä¼˜åŒ–å»ºè®®)
8. [å¸¸è§é”™è¯¯ä¸é™·é˜±](#å…«å¸¸è§é”™è¯¯ä¸é™·é˜±)
9. [æœ€ä½³å®è·µæ¸…å•](#ä¹æœ€ä½³å®è·µæ¸…å•)

---

## ä¸€ã€äº‹ä»¶ç³»ç»Ÿæ¦‚è¿°

### 1.1 ä»€ä¹ˆæ˜¯äº‹ä»¶ç³»ç»Ÿ?

MODSDKé‡‡ç”¨**äº‹ä»¶é©±åŠ¨æ¶æ„**ï¼ˆEvent-Driven Architectureï¼‰ï¼Œé€šè¿‡å‘å¸ƒ-è®¢é˜…æ¨¡å¼å®ç°æ¨¡å—é—´çš„æ¾è€¦åˆé€šä¿¡ã€‚

**æ ¸å¿ƒç»„ä»¶**:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     ListenForEvent      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   System A  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€> â”‚ Event Managerâ”‚
â”‚  (è®¢é˜…è€…)   â”‚                          â”‚  (äº‹ä»¶ç®¡ç†å™¨) â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                              â”‚ åˆ†å‘äº‹ä»¶
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚
      v
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     NotifyToServer      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   System B  â”‚ <â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚ Event Managerâ”‚
â”‚  (å¤„ç†å™¨)   â”‚                          â”‚              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ä¸ºä»€ä¹ˆä½¿ç”¨äº‹ä»¶ç³»ç»Ÿ?**

1. **è§£è€¦æ¨¡å—**: Systemä¹‹é—´ä¸éœ€è¦ç›´æ¥å¼•ç”¨,é€šè¿‡äº‹ä»¶é€šä¿¡
2. **æ‰©å±•æ€§**: æ·»åŠ æ–°ç›‘å¬å™¨æ— éœ€ä¿®æ”¹å‘é€æ–¹ä»£ç 
3. **è·¨ç«¯é€šä¿¡**: é€šè¿‡`NotifyToServer`/`NotifyToClient`å®ç°åŒç«¯äº¤äº’
4. **å¼‚æ­¥å¤„ç†**: äº‹ä»¶å¤„ç†ä¸é˜»å¡æ¸¸æˆä¸»å¾ªç¯

---

### 1.2 äº‹ä»¶ç³»ç»Ÿæ¶æ„

```mermaid
graph TB
    subgraph "å®¢æˆ·ç«¯"
        ClientSystem[ClientSystem] -->|ListenForEvent| ClientEventMgr[Client Event Manager]
        ClientEventMgr -->|NotifyToServer| Network
    end

    subgraph "æœåŠ¡å™¨"
        ServerSystem[ServerSystem] -->|ListenForEvent| ServerEventMgr[Server Event Manager]
        ServerEventMgr -->|NotifyToClient| Network
    end

    Network -->|ç½‘ç»œä¼ è¾“| ClientEventMgr
    Network -->|ç½‘ç»œä¼ è¾“| ServerEventMgr

    style Network fill:#f9f,stroke:#333
```

---

## äºŒã€äº‹ä»¶ç±»å‹åˆ†ç±»

### 2.1 å¼•æ“äº‹ä»¶

**å®šä¹‰**: ç”±Minecraftå¼•æ“è‡ªåŠ¨è§¦å‘çš„äº‹ä»¶ï¼ˆä¸éœ€è¦æ‰‹åŠ¨NotifyToServerï¼‰

**ç‰¹ç‚¹**:
- âœ… è‡ªåŠ¨è§¦å‘,æ— éœ€æ‰‹åŠ¨é€šçŸ¥
- âœ… æ€§èƒ½å¼€é”€ä½ï¼ˆå¼•æ“çº§ä¼˜åŒ–ï¼‰
- âš ï¸ éƒ¨åˆ†äº‹ä»¶ä»…åœ¨ç‰¹å®šæ¡ä»¶ä¸‹è§¦å‘

**å¸¸è§å¼•æ“äº‹ä»¶**:

| äº‹ä»¶åç§° | è§¦å‘æ—¶æœº | ç«¯ | å¸¸è§ç”¨é€” |
|---------|---------|-----|---------|
| `ServerPlayerTryDestroyBlockEvent` | ç©å®¶å°è¯•ç ´åæ–¹å— | æœåŠ¡å™¨ | é¢†åœ°ä¿æŠ¤ |
| `AddPlayerCreatedEvent` | ç©å®¶åŠ å…¥æœåŠ¡å™¨ | æœåŠ¡å™¨ | åˆå§‹åŒ–ç©å®¶æ•°æ® |
| `OnScriptTickServer` | æ¯æ¸¸æˆTick | æœåŠ¡å™¨ | å®šæ—¶ä»»åŠ¡ |
| `ClientItemUseAfterEvent` | ç‰©å“ä½¿ç”¨å | å®¢æˆ·ç«¯ | UIäº¤äº’ |
| `DamageEvent` | å®ä½“å—ä¼¤ | æœåŠ¡å™¨ | ä¼¤å®³è®¡ç®— |

**ä½¿ç”¨ç¤ºä¾‹**:
```python
def __init__(self):
    # ç›‘å¬å¼•æ“äº‹ä»¶ - æ— éœ€priorityLevelå‚æ•°
    self.ListenForEvent(
        serverApi.GetEngineNamespace(),  # å¼•æ“å‘½åç©ºé—´
        serverApi.GetEngineSystemName(), # å¼•æ“ç³»ç»Ÿå
        'AddPlayerCreatedEvent',         # äº‹ä»¶å
        self,                            # ç›‘å¬è€…
        self.OnPlayerJoin                # å›è°ƒå‡½æ•°
    )

def OnPlayerJoin(self, args):
    playerId = args['playerId']
    print "Player joined:", playerId
```

---

### 2.2 è‡ªå®šä¹‰äº‹ä»¶

**å®šä¹‰**: å¼€å‘è€…åœ¨Systemä¹‹é—´æ‰‹åŠ¨å®šä¹‰å’Œè§¦å‘çš„äº‹ä»¶

**ç‰¹ç‚¹**:
- âš ï¸ éœ€è¦æ‰‹åŠ¨NotifyToServer/NotifyToClient
- âš ï¸ æ€§èƒ½å¼€é”€å–å†³äºäº‹ä»¶é¢‘ç‡å’Œæ•°æ®å¤§å°
- âœ… çµæ´»æ€§é«˜,å¯è‡ªå®šä¹‰äº‹ä»¶ç»“æ„

**å‘½åè§„èŒƒ**:
```
{åŠŸèƒ½æ¨¡å—}_{æ“ä½œ}Event

âœ… æ­£ç¡®ç¤ºä¾‹:
- Shop_BuyItemEvent          # å•†åº—è´­ä¹°ç‰©å“
- VIP_LevelUpEvent           # VIPå‡çº§
- Quest_CompleteEvent        # ä»»åŠ¡å®Œæˆ

âŒ é”™è¯¯ç¤ºä¾‹:
- buyItem                    # ç¼ºå°‘æ¨¡å—å‰ç¼€
- SHOP_BUY_ITEM_EVENT        # å…¨å¤§å†™ï¼ˆä¸ç¬¦åˆPythonè§„èŒƒï¼‰
- shop:buy                   # ä½¿ç”¨ç‰¹æ®Šå­—ç¬¦
```

**ä½¿ç”¨ç¤ºä¾‹**:
```python
# æœåŠ¡å™¨ç«¯ - ç›‘å¬è‡ªå®šä¹‰äº‹ä»¶
def __init__(self):
    self.ListenForEvent(
        'MyMod',               # ä½ çš„Modå‘½åç©ºé—´
        'ShopSystem',          # å‘é€æ–¹Systemå
        'Shop_BuyItemEvent',   # è‡ªå®šä¹‰äº‹ä»¶å
        self,
        self.OnShopBuy
    )

def OnShopBuy(self, args):
    playerId = args['playerId']
    itemId = args['itemId']
    # å¤„ç†è´­ä¹°é€»è¾‘

# å‘é€æ–¹ - è§¦å‘è‡ªå®šä¹‰äº‹ä»¶
def BuyItem(self, playerId, itemId):
    self.NotifyToServer('Shop_BuyItemEvent', {
        'playerId': playerId,
        'itemId': itemId,
        'price': 100
    })
```

---

### 2.3 åŒç«¯é€šä¿¡äº‹ä»¶

**å®šä¹‰**: ç”¨äºå®¢æˆ·ç«¯-æœåŠ¡å™¨é€šä¿¡çš„ç‰¹æ®Šäº‹ä»¶ç±»å‹

**æ ¸å¿ƒAPI**:

| API | æ–¹å‘ | ç”¨é€” |
|-----|------|------|
| `NotifyToServer(eventName, data)` | å®¢æˆ·ç«¯â†’æœåŠ¡å™¨ | å‘é€å®¢æˆ·ç«¯è¾“å…¥ã€UIæ“ä½œ |
| `NotifyToClient(playerId, eventName, data)` | æœåŠ¡å™¨â†’å®¢æˆ·ç«¯ | æ¨é€æ¸¸æˆçŠ¶æ€ã€æ›´æ–°UI |
| `BroadcastToAllClient(eventName, data)` | æœåŠ¡å™¨â†’æ‰€æœ‰å®¢æˆ·ç«¯ | å…¨å±€å¹¿æ’­ï¼ˆå¦‚ä¸–ç•Œäº‹ä»¶ï¼‰|

**ä½¿ç”¨åœºæ™¯**:

```python
# åœºæ™¯1: å®¢æˆ·ç«¯å‘é€æ“ä½œåˆ°æœåŠ¡å™¨
class ShopClientSystem(ClientSystem):
    def OnClickBuyButton(self, itemId):
        # å®¢æˆ·ç«¯åªè´Ÿè´£UIäº¤äº’,ä¸å¤„ç†ä¸šåŠ¡é€»è¾‘
        self.NotifyToServer('Shop_RequestBuyEvent', {
            'itemId': itemId
        })

# åœºæ™¯2: æœåŠ¡å™¨éªŒè¯åé€šçŸ¥å®¢æˆ·ç«¯
class ShopServerSystem(ServerSystem):
    def __init__(self):
        self.ListenForEvent('MyMod', 'ShopClientSystem', 'Shop_RequestBuyEvent', self, self.OnBuyRequest)

    def OnBuyRequest(self, args):
        playerId = args['playerId']  # è‡ªåŠ¨é™„åŠ çš„å‘é€è€…ID
        itemId = args['itemId']

        # æœåŠ¡å™¨éªŒè¯é€»è¾‘
        if self.CheckMoney(playerId, itemId):
            self.DeductMoney(playerId, itemId)
            self.GiveItem(playerId, itemId)

            # é€šçŸ¥å®¢æˆ·ç«¯è´­ä¹°æˆåŠŸ
            self.NotifyToClient(playerId, 'Shop_BuySuccessEvent', {
                'itemId': itemId,
                'newBalance': self.GetMoney(playerId)
            })
        else:
            # é€šçŸ¥å®¢æˆ·ç«¯ä½™é¢ä¸è¶³
            self.NotifyToClient(playerId, 'Shop_BuyFailedEvent', {
                'reason': 'insufficient_balance'
            })

# åœºæ™¯3: å¹¿æ’­å…¨å±€äº‹ä»¶
class WorldEventServerSystem(ServerSystem):
    def OnBossKilled(self, bossId):
        # å¹¿æ’­ç»™æ‰€æœ‰åœ¨çº¿ç©å®¶
        self.BroadcastToAllClient('World_BossKilledEvent', {
            'bossId': bossId,
            'killerName': 'Steve'
        })
```

---

## ä¸‰ã€äº‹ä»¶ç›‘å¬ä¸é€šçŸ¥

### 3.1 ListenForEventè¯¦è§£

**å®Œæ•´ç­¾å**:
```python
ListenForEvent(namespace, systemName, eventName, instance, callback, priorityLevel=0)
```

**å‚æ•°è¯´æ˜**:

| å‚æ•° | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|------|------|------|------|
| `namespace` | str | âœ… | äº‹ä»¶å‘½åç©ºé—´ï¼ˆå¼•æ“äº‹ä»¶ç”¨`GetEngineNamespace()`ï¼‰|
| `systemName` | str | âœ… | å‘é€æ–¹Systemåï¼ˆå¼•æ“äº‹ä»¶ç”¨`GetEngineSystemName()`ï¼‰|
| `eventName` | str | âœ… | äº‹ä»¶åç§° |
| `instance` | object | âœ… | å›è°ƒå‡½æ•°æ‰€å±å®ä¾‹ï¼ˆé€šå¸¸æ˜¯`self`ï¼‰|
| `callback` | function | âœ… | äº‹ä»¶å¤„ç†å›è°ƒå‡½æ•° |
| `priorityLevel` | int | âŒ | ä¼˜å…ˆçº§ï¼ˆ0-10ï¼Œé»˜è®¤0ï¼Œ**ä»…ç”¨äºè‡ªå®šä¹‰äº‹ä»¶**ï¼‰|

**é‡è¦æç¤º**:
- âš ï¸ å¼•æ“äº‹ä»¶**ä¸æ”¯æŒ**`priorityLevel`å‚æ•°,ä¼ å…¥ä¼šæŠ¥é”™
- âš ï¸ è‡ªå®šä¹‰äº‹ä»¶æ‰éœ€è¦ä¼˜å…ˆçº§æ§åˆ¶

---

### 3.2 å–æ¶ˆç›‘å¬

**ä½•æ—¶éœ€è¦å–æ¶ˆç›‘å¬?**
- Systemè¢«é”€æ¯æ—¶ï¼ˆé¿å…å†…å­˜æ³„æ¼ï¼‰
- ä¸´æ—¶ç›‘å¬å™¨ï¼ˆå¦‚ä¸€æ¬¡æ€§ä»»åŠ¡ï¼‰
- æ¡ä»¶ç›‘å¬å™¨ï¼ˆæ»¡è¶³æ¡ä»¶ååœæ­¢ï¼‰

**API**: `UnListenForEvent(namespace, systemName, eventName, instance, callback)`

**ç¤ºä¾‹**:
```python
def __init__(self):
    # ç›‘å¬ç©å®¶æ­»äº¡äº‹ä»¶
    self.deathCallback = self.OnPlayerDeath
    self.ListenForEvent('Minecraft', 'MyMod', 'PlayerDeathEvent', self, self.deathCallback)

def OnPlayerDeath(self, args):
    playerId = args['playerId']
    # å¤„ç†æ­»äº¡é€»è¾‘

    # åªè§¦å‘ä¸€æ¬¡,ç„¶åå–æ¶ˆç›‘å¬
    self.UnListenForEvent('Minecraft', 'MyMod', 'PlayerDeathEvent', self, self.deathCallback)

def Destroy(self):
    # Systemé”€æ¯æ—¶å–æ¶ˆæ‰€æœ‰ç›‘å¬
    self.UnListenAllEvents()  # æ¨èä½¿ç”¨
```

---

## å››ã€äº‹ä»¶ä¼˜å…ˆçº§æœºåˆ¶

### 4.1 ä¼˜å…ˆçº§è§„åˆ™

**ä¼˜å…ˆçº§èŒƒå›´**: 0-10ï¼ˆæ•°å­—è¶Šå¤§,ä¼˜å…ˆçº§è¶Šé«˜ï¼‰

**æ‰§è¡Œé¡ºåº**:
```
ä¼˜å…ˆçº§10 (æœ€å…ˆæ‰§è¡Œ)
  â†“
ä¼˜å…ˆçº§5
  â†“
ä¼˜å…ˆçº§0 (é»˜è®¤,æœ€åæ‰§è¡Œ)
```

**ä½¿ç”¨åœºæ™¯**:

| ä¼˜å…ˆçº§ | ä½¿ç”¨åœºæ™¯ | ç¤ºä¾‹ |
|--------|---------|------|
| **10** | æƒé™éªŒè¯ã€åä½œå¼Š | æ£€æŸ¥ç©å®¶æ˜¯å¦è¢«å°ç¦ |
| **8-9** | æ•°æ®é¢„å¤„ç† | äº‹ä»¶æ•°æ®æ ¼å¼åŒ– |
| **5-7** | æ ¸å¿ƒä¸šåŠ¡é€»è¾‘ | å•†åº—è´­ä¹°ã€ä»»åŠ¡å®Œæˆ |
| **3-4** | åå¤„ç† | æ—¥å¿—è®°å½•ã€ç»Ÿè®¡ |
| **0-2** | UIæ›´æ–°ã€é€šçŸ¥ | æ˜¾ç¤ºæç¤ºä¿¡æ¯ |

---

### 4.2 ä¼˜å…ˆçº§æœ€ä½³å®è·µ

**ç¤ºä¾‹: å•†åº—è´­ä¹°äº‹ä»¶**

```python
# ä¼˜å…ˆçº§10: æƒé™éªŒè¯
class AntiCheatSystem(ServerSystem):
    def __init__(self):
        self.ListenForEvent('MyMod', 'ShopSystem', 'Shop_BuyItemEvent', self, self.CheckPermission, priorityLevel=10)

    def CheckPermission(self, args):
        playerId = args['playerId']
        if self.IsBanned(playerId):
            return False  # ä¸­æ–­äº‹ä»¶ä¼ æ’­
        return True

# ä¼˜å…ˆçº§5: æ ¸å¿ƒä¸šåŠ¡é€»è¾‘
class ShopServerSystem(ServerSystem):
    def __init__(self):
        self.ListenForEvent('MyMod', 'ShopSystem', 'Shop_BuyItemEvent', self, self.ProcessBuy, priorityLevel=5)

    def ProcessBuy(self, args):
        playerId = args['playerId']
        itemId = args['itemId']
        # æ‰£é™¤é‡‘å¸ã€ç»™äºˆç‰©å“
        self.DeductMoney(playerId, 100)
        self.GiveItem(playerId, itemId)

# ä¼˜å…ˆçº§0: æ—¥å¿—è®°å½•
class LogSystem(ServerSystem):
    def __init__(self):
        self.ListenForEvent('MyMod', 'ShopSystem', 'Shop_BuyItemEvent', self, self.LogPurchase, priorityLevel=0)

    def LogPurchase(self, args):
        playerId = args['playerId']
        itemId = args['itemId']
        print "[Log] Player {} bought item {}".format(playerId, itemId)
```

**è­¦å‘Š**:
- âŒ ä¸è¦æ‰€æœ‰ç›‘å¬å™¨éƒ½è®¾ç½®é«˜ä¼˜å…ˆçº§ï¼ˆä¼šå¯¼è‡´æ‰§è¡Œé¡ºåºæ··ä¹±ï¼‰
- âŒ ä¸è¦åœ¨é«˜ä¼˜å…ˆçº§ç›‘å¬å™¨ä¸­æ‰§è¡Œè€—æ—¶æ“ä½œï¼ˆä¼šé˜»å¡åç»­ç›‘å¬å™¨ï¼‰

---

## äº”ã€äº‹ä»¶æ•°æ®è§„èŒƒ

### 5.1 æ”¯æŒçš„æ•°æ®ç±»å‹

**âœ… å…è®¸çš„ç±»å‹**:
```python
{
    'int_value': 123,                    # æ•´æ•°
    'float_value': 3.14,                 # æµ®ç‚¹æ•°
    'string_value': "Hello",             # å­—ç¬¦ä¸²
    'bool_value': True,                  # å¸ƒå°”å€¼
    'list_value': [1, 2, 3],             # åˆ—è¡¨
    'dict_value': {'key': 'value'},      # å­—å…¸
    'none_value': None                   # Noneå€¼
}
```

**âŒ ç¦æ­¢çš„ç±»å‹**:
```python
{
    'tuple_value': (1, 2, 3),            # âŒ å…ƒç»„ï¼ˆä¼šåºåˆ—åŒ–å¤±è´¥ï¼‰
    'set_value': {1, 2, 3},              # âŒ é›†åˆ
    'object_value': MyClass(),           # âŒ è‡ªå®šä¹‰å¯¹è±¡
    'function_value': lambda x: x+1      # âŒ å‡½æ•°
}
```

---

### 5.2 æ•°æ®å¤§å°é™åˆ¶

**ç½‘ç»œäº‹ä»¶æ•°æ®é™åˆ¶**:
- å•ä¸ªäº‹ä»¶æ•°æ®ä¸è¶…è¿‡**64KB**ï¼ˆå»ºè®®<10KBï¼‰
- é¿å…ä¼ è¾“å¤§é‡ç©å®¶åˆ—è¡¨ï¼ˆä½¿ç”¨åˆ†é¡µæˆ–IDåˆ—è¡¨ï¼‰
- é¿å…åµŒå¥—å±‚çº§è¿‡æ·±ï¼ˆå»ºè®®â‰¤3å±‚ï¼‰

**æ€§èƒ½å¯¹æ¯”**:

| æ•°æ®å¤§å° | ç½‘ç»œå»¶è¿Ÿ | åºåˆ—åŒ–è€—æ—¶ | å»ºè®® |
|---------|---------|-----------|------|
| <1KB | ~5ms | ~0.1ms | âœ… æ¨è |
| 1-10KB | ~15ms | ~1ms | âš ï¸ å¯æ¥å— |
| 10-64KB | ~50ms | ~10ms | âŒ é¿å… |
| >64KB | å¤±è´¥ | å¤±è´¥ | âŒ ç¦æ­¢ |

**ä¼˜åŒ–ç¤ºä¾‹**:
```python
# âŒ é”™è¯¯: ä¼ è¾“å®Œæ•´ç©å®¶åˆ—è¡¨
self.NotifyToClient(playerId, 'Leaderboard_UpdateEvent', {
    'players': [
        {'id': 'player1', 'name': 'Alice', 'score': 1000, 'level': 50, ...},
        {'id': 'player2', 'name': 'Bob', 'score': 900, 'level': 45, ...},
        # ... 100ä¸ªç©å®¶æ•°æ®
    ]
})

# âœ… æ­£ç¡®: åªä¼ è¾“å¿…è¦æ•°æ® + åˆ†é¡µ
self.NotifyToClient(playerId, 'Leaderboard_UpdateEvent', {
    'top10': [
        {'id': 'player1', 'score': 1000},  # åªä¼ IDå’Œåˆ†æ•°
        {'id': 'player2', 'score': 900},
        # ... æœ€å¤š10æ¡
    ],
    'page': 1,
    'total': 100
})
```

---

## å…­ã€ç½‘ç»œäº‹ä»¶ä¼˜åŒ–

### 6.1 äº‹ä»¶å‹ç¼©æœºåˆ¶

**åŸç†**: MODSDKè‡ªåŠ¨å°†äº‹ä»¶åå‹ç¼©ä¸ºçŸ­ç´¢å¼•,å‡å°‘ç½‘ç»œæµé‡

**å·¥ä½œæµç¨‹**:
```
é¦–æ¬¡å‘é€äº‹ä»¶:
Client â†’ Server: "MyMod:ShopSystem:Shop_BuyItemEvent" (å®Œæ•´å­—ç¬¦ä¸², ~40å­—èŠ‚)
Server â†’ Client: æ³¨å†Œç´¢å¼•æ˜ å°„ {å®Œæ•´åç§° â†’ ç´¢å¼•123}

åç»­å‘é€:
Client â†’ Server: ç´¢å¼•123 (æ•´æ•°, ~2å­—èŠ‚)
```

**æ€§èƒ½æå‡**:
- äº‹ä»¶åä»40å­—èŠ‚å‹ç¼©åˆ°2å­—èŠ‚ï¼ˆ**95%æµé‡èŠ‚çœ**ï¼‰
- é«˜é¢‘äº‹ä»¶ï¼ˆå¦‚ç§»åŠ¨ã€æ”»å‡»ï¼‰æ•ˆæœæ˜¾è‘—

**å¼€å‘è€…æ— éœ€å…³å¿ƒæ­¤æœºåˆ¶**ï¼ˆå¼•æ“è‡ªåŠ¨ä¼˜åŒ–ï¼‰

---

### 6.2 æ‰¹é‡äº‹ä»¶ä¼˜åŒ–

**åœºæ™¯**: éœ€è¦å‘å¤šä¸ªç©å®¶å‘é€ç›¸åŒäº‹ä»¶

**âŒ ä½æ•ˆå†™æ³•**:
```python
def NotifyAllPlayers(self, eventData):
    for playerId in self.GetAllPlayers():
        # æ¯æ¬¡è°ƒç”¨éƒ½ä¼šåºåˆ—åŒ–ä¸€æ¬¡æ•°æ®
        self.NotifyToClient(playerId, 'MyEvent', eventData)
```

**âœ… é«˜æ•ˆå†™æ³•**:
```python
def NotifyAllPlayers(self, eventData):
    # ä¸€æ¬¡åºåˆ—åŒ–,å¹¿æ’­ç»™æ‰€æœ‰å®¢æˆ·ç«¯
    self.BroadcastToAllClient('MyEvent', eventData)
```

**æ€§èƒ½å¯¹æ¯”** (100ä¸ªç©å®¶):
- å•ç‹¬å‘é€: 100æ¬¡åºåˆ—åŒ– â‰ˆ 100ms
- æ‰¹é‡å¹¿æ’­: 1æ¬¡åºåˆ—åŒ– â‰ˆ 1ms (**100å€æå‡**)

---

## ä¸ƒã€æ€§èƒ½ä¼˜åŒ–å»ºè®®

### 7.1 å‡å°‘äº‹ä»¶é¢‘ç‡

**é—®é¢˜**: é«˜é¢‘äº‹ä»¶ï¼ˆå¦‚æ¯å¸§è§¦å‘ï¼‰ä¼šä¸¥é‡å½±å“æ€§èƒ½

**âŒ é”™è¯¯ç¤ºä¾‹**:
```python
def Update(self):
    # æ¯å¸§ï¼ˆ60fpsï¼‰éƒ½å‘é€ç©å®¶ä½ç½®
    self.NotifyToServer('Player_PositionEvent', {
        'x': self.GetPlayerPos()[0],
        'y': self.GetPlayerPos()[1],
        'z': self.GetPlayerPos()[2]
    })
    # ç»“æœ: 60æ¬¡/ç§’ Ã— 40å­—èŠ‚ = 2.4KB/ç§’/ç©å®¶
```

**âœ… æ­£ç¡®ç¤ºä¾‹**:
```python
def __init__(self):
    self.tick_counter = 0

def Update(self):
    self.tick_counter += 1
    # æ¯20å¸§ï¼ˆçº¦0.33ç§’ï¼‰å‘é€ä¸€æ¬¡
    if self.tick_counter % 20 == 0:
        self.NotifyToServer('Player_PositionEvent', {
            'x': self.GetPlayerPos()[0],
            'y': self.GetPlayerPos()[1],
            'z': self.GetPlayerPos()[2]
        })
    # ç»“æœ: 3æ¬¡/ç§’ Ã— 40å­—èŠ‚ = 120å­—èŠ‚/ç§’/ç©å®¶ (èŠ‚çœ95%æµé‡)
```

---

### 7.2 äº‹ä»¶ç›‘å¬å™¨æ•°é‡é™åˆ¶

**å»ºè®®**:
- å•ä¸ªäº‹ä»¶ç›‘å¬å™¨æ•°é‡ä¸è¶…è¿‡**20ä¸ª**
- Systemæ€»ç›‘å¬äº‹ä»¶æ•°é‡ä¸è¶…è¿‡**50ä¸ª**

**æ£€æŸ¥å·¥å…·**:
```python
def Destroy(self):
    # é”€æ¯å‰æ£€æŸ¥ç›‘å¬å™¨æ•°é‡
    listener_count = len(self.GetAllListeners())
    if listener_count > 50:
        print "[Warning] Too many listeners:", listener_count
```

---

### 7.3 é¿å…äº‹ä»¶å¾ªç¯

**é—®é¢˜**: äº‹ä»¶Aè§¦å‘äº‹ä»¶B,äº‹ä»¶Båˆè§¦å‘äº‹ä»¶A

**âŒ å±é™©ç¤ºä¾‹**:
```python
# System A
def OnEventB(self, args):
    self.NotifyToServer('EventA', {})  # è§¦å‘EventA

# System B
def OnEventA(self, args):
    self.NotifyToServer('EventB', {})  # è§¦å‘EventB â†’ æ— é™å¾ªç¯
```

**âœ… è§£å†³æ–¹æ¡ˆ**:
```python
def __init__(self):
    self.is_processing = False  # é˜²é‡å…¥æ ‡å¿—

def OnEventB(self, args):
    if self.is_processing:
        return  # æ­£åœ¨å¤„ç†ä¸­,è·³è¿‡

    self.is_processing = True
    self.NotifyToServer('EventA', {})
    self.is_processing = False
```

---

## å…«ã€å¸¸è§é”™è¯¯ä¸é™·é˜±

### é”™è¯¯1: å¼•æ“äº‹ä»¶ä½¿ç”¨priorityLevelå‚æ•°

```python
# âŒ é”™è¯¯
self.ListenForEvent(
    serverApi.GetEngineNamespace(),
    serverApi.GetEngineSystemName(),
    'AddPlayerCreatedEvent',
    self,
    self.OnPlayerJoin,
    priorityLevel=5  # âŒ å¼•æ“äº‹ä»¶ä¸æ”¯æŒä¼˜å…ˆçº§
)

# âœ… æ­£ç¡®
self.ListenForEvent(
    serverApi.GetEngineNamespace(),
    serverApi.GetEngineSystemName(),
    'AddPlayerCreatedEvent',
    self,
    self.OnPlayerJoin
    # ä¸ä¼ priorityLevelå‚æ•°
)
```

---

### é”™è¯¯2: å¿˜è®°å–æ¶ˆç›‘å¬å¯¼è‡´å†…å­˜æ³„æ¼

```python
# âŒ é”™è¯¯
class TempSystem(ServerSystem):
    def __init__(self):
        self.ListenForEvent('MyMod', 'OtherSystem', 'TempEvent', self, self.OnTemp)

    # æ²¡æœ‰Destroyæ–¹æ³•å–æ¶ˆç›‘å¬

# âœ… æ­£ç¡®
class TempSystem(ServerSystem):
    def __init__(self):
        self.ListenForEvent('MyMod', 'OtherSystem', 'TempEvent', self, self.OnTemp)

    def Destroy(self):
        self.UnListenAllEvents()  # å–æ¶ˆæ‰€æœ‰ç›‘å¬
```

---

### é”™è¯¯3: äº‹ä»¶å›è°ƒä¸­æŠ›å‡ºå¼‚å¸¸

```python
# âŒ é”™è¯¯
def OnPlayerJoin(self, args):
    playerId = args['playerId']
    # å¦‚æœargsä¸­æ²¡æœ‰'extraData'ä¼šæŠ›å¼‚å¸¸,å¯¼è‡´åç»­ç›‘å¬å™¨æ— æ³•æ‰§è¡Œ
    extraData = args['extraData']['key']

# âœ… æ­£ç¡®
def OnPlayerJoin(self, args):
    playerId = args['playerId']
    try:
        extraData = args.get('extraData', {}).get('key', None)
        if extraData is None:
            print "[Warning] Missing extraData"
            return
    except Exception as e:
        print "[Error]", e
        return
```

---

## ä¹ã€æœ€ä½³å®è·µæ¸…å•

### âœ… ç›‘å¬äº‹ä»¶

- [ ] ä½¿ç”¨æ˜ç¡®çš„å‘½åç©ºé—´ï¼ˆé¿å…ä¸å…¶ä»–Modå†²çªï¼‰
- [ ] å¼•æ“äº‹ä»¶ä¸ä¼ `priorityLevel`å‚æ•°
- [ ] è‡ªå®šä¹‰äº‹ä»¶æŒ‰ä¸šåŠ¡é‡è¦æ€§è®¾ç½®ä¼˜å…ˆçº§ï¼ˆ0-10ï¼‰
- [ ] åœ¨`Destroy()`ä¸­å–æ¶ˆæ‰€æœ‰ç›‘å¬

### âœ… é€šçŸ¥äº‹ä»¶

- [ ] äº‹ä»¶æ•°æ®å¤§å°<10KB
- [ ] é¿å…ä¼ è¾“å…ƒç»„ã€é›†åˆã€è‡ªå®šä¹‰å¯¹è±¡
- [ ] é«˜é¢‘äº‹ä»¶ä½¿ç”¨èŠ‚æµï¼ˆthrottleï¼‰å‡å°‘è°ƒç”¨æ¬¡æ•°
- [ ] æ‰¹é‡é€šçŸ¥ä½¿ç”¨`BroadcastToAllClient`

### âœ… åŒç«¯é€šä¿¡

- [ ] å®¢æˆ·ç«¯åªè´Ÿè´£UIäº¤äº’,ä¸å¤„ç†ä¸šåŠ¡é€»è¾‘
- [ ] æœåŠ¡å™¨éªŒè¯æ‰€æœ‰å®¢æˆ·ç«¯è¯·æ±‚ï¼ˆé˜²ä½œå¼Šï¼‰
- [ ] ä½¿ç”¨æ˜ç¡®çš„äº‹ä»¶ååŒºåˆ†å®¢æˆ·ç«¯/æœåŠ¡å™¨äº‹ä»¶
- [ ] ç½‘ç»œäº‹ä»¶æ•°æ®åŒ…å«å¿…è¦çš„ä¸Šä¸‹æ–‡ï¼ˆå¦‚playerIdï¼‰

### âœ… æ€§èƒ½ä¼˜åŒ–

- [ ] é«˜é¢‘äº‹ä»¶ï¼ˆ>10æ¬¡/ç§’ï¼‰ä½¿ç”¨èŠ‚æµ
- [ ] å•ä¸ªäº‹ä»¶ç›‘å¬å™¨æ•°é‡<20ä¸ª
- [ ] é¿å…äº‹ä»¶å¾ªç¯ï¼ˆAè§¦å‘B, Bè§¦å‘Aï¼‰
- [ ] ä½¿ç”¨äº‹ä»¶å‹ç¼©æœºåˆ¶ï¼ˆå¼•æ“è‡ªåŠ¨ï¼‰

---

## åã€å‚è€ƒèµ„æº

### å®˜æ–¹æ–‡æ¡£
- **MODSDKäº‹ä»¶API**: å‚è€ƒ`.claude/docs/modsdk-wiki/`ï¼ˆæœ¬åœ°ç¦»çº¿æ–‡æ¡£ï¼‰
- **åŸºå²©ç‰ˆWIKI**: å‚è€ƒ`.claude/docs/bedrock-wiki/`

### ç›¸å…³å·¥ä½œæµæ–‡æ¡£
- **å¼€å‘è§„èŒƒ.md**: åŒç«¯éš”ç¦»ã€Systemè®¾è®¡è§„èŒƒ
- **é—®é¢˜æ’æŸ¥.md**: äº‹ä»¶ç›¸å…³å¸¸è§é—®é¢˜
- **æ·±å…¥ç†è§£ECSæ¶æ„.md**: ECSä¸äº‹ä»¶ç³»ç»Ÿçš„å…³ç³»

---

**æ–‡æ¡£ç‰ˆæœ¬**: v1.0
**æœ€åæ›´æ–°**: 2025-11-11
**ç»´æŠ¤è€…**: NeteaseMod-Claudeå·¥ä½œæµ
