# åæ¨¡å¼è¯†åˆ«æ¸…å•

> âš ï¸ **MODSDKå¼€å‘å¸¸è§é”™è¯¯æ¨¡å¼ä¸è§£å†³æ–¹æ¡ˆ**
>
> æœ¬æ–‡æ¡£åˆ—ä¸¾MODSDKå¼€å‘ä¸­çš„åæ¨¡å¼ï¼ˆAnti-patternsï¼‰ã€è¯†åˆ«æ–¹æ³•å’Œæ­£ç¡®åšæ³•
>
> **ç‰ˆæœ¬**: v1.0
> **æœ€åæ›´æ–°**: 2025-11-11

---

## ç›®å½•

1. [ä»€ä¹ˆæ˜¯åæ¨¡å¼](#ä¸€ä»€ä¹ˆæ˜¯åæ¨¡å¼)
2. [æ¶æ„åæ¨¡å¼](#äºŒæ¶æ„åæ¨¡å¼)
3. [æ€§èƒ½åæ¨¡å¼](#ä¸‰æ€§èƒ½åæ¨¡å¼)
4. [å®‰å…¨åæ¨¡å¼](#å››å®‰å…¨åæ¨¡å¼)
5. [ä»£ç è´¨é‡åæ¨¡å¼](#äº”ä»£ç è´¨é‡åæ¨¡å¼)
6. [åæ¨¡å¼æ£€æµ‹å·¥å…·](#å…­åæ¨¡å¼æ£€æµ‹å·¥å…·)
7. [ä»£ç å®¡æŸ¥æ¸…å•](#ä¸ƒä»£ç å®¡æŸ¥æ¸…å•)

---

## ä¸€ã€ä»€ä¹ˆæ˜¯åæ¨¡å¼?

### 1.1 å®šä¹‰

**åæ¨¡å¼ï¼ˆAnti-patternï¼‰**: çœ‹ä¼¼åˆç†ä½†å®é™…ä¸Šä¼šå¸¦æ¥ä¸¥é‡é—®é¢˜çš„è§£å†³æ–¹æ¡ˆ

**ç‰¹å¾**:
- âœ… çŸ­æœŸå†…çœ‹ä¼¼æœ‰æ•ˆ
- âŒ é•¿æœŸä¼šå¯¼è‡´ç»´æŠ¤å›°éš¾ã€æ€§èƒ½ä¸‹é™ã€å®‰å…¨éšæ‚£
- âŒ è¿åè½¯ä»¶å·¥ç¨‹æœ€ä½³å®è·µ

---

### 1.2 åæ¨¡å¼çš„å±å®³

| å±å®³ç±»å‹ | è¡¨ç° | å½±å“ |
|---------|------|------|
| **æ€§èƒ½ä¸‹é™** | æ¸¸æˆå¡é¡¿ã€å»¶è¿Ÿé«˜ | ç”¨æˆ·ä½“éªŒå·® |
| **å®‰å…¨æ¼æ´** | ä½œå¼Šã€æ•°æ®ç¯¡æ”¹ | æ¸¸æˆå…¬å¹³æ€§ç ´å |
| **ç»´æŠ¤å›°éš¾** | ä»£ç éš¾ä»¥ç†è§£ã€ä¿®æ”¹æ˜“å‡ºé”™ | å¼€å‘æ•ˆç‡ä½ |
| **Bugé¢‘å‘** | éšè—çš„é€»è¾‘é”™è¯¯ | ç¨³å®šæ€§å·® |

---

## äºŒã€æ¶æ„åæ¨¡å¼

### åæ¨¡å¼1: å®¢æˆ·ç«¯å¤„ç†ä¸šåŠ¡é€»è¾‘ ğŸ”´ CRITICAL

**é”™è¯¯ç¤ºä¾‹**:
```python
# âŒ å®¢æˆ·ç«¯ç›´æ¥ä¿®æ”¹ç©å®¶é‡‘é’±ï¼ˆä½œå¼Šé£é™©ï¼‰
class ShopClientSystem(ClientSystem):
    def OnBuyItem(self, itemId):
        # å®¢æˆ·ç«¯ç›´æ¥æ‰£é™¤é‡‘é’±
        self.player_money -= 100
        # å®¢æˆ·ç«¯ç›´æ¥ç»™äºˆç‰©å“
        self.GiveItem(self.localPlayerId, itemId)
        self.ShowTip("è´­ä¹°æˆåŠŸ")
```

**å±å®³**:
- ğŸš¨ å®¢æˆ·ç«¯å¯è¢«é»‘å®¢ä¿®æ”¹,ç›´æ¥ç»•è¿‡æ”¯ä»˜é€»è¾‘
- ğŸš¨ å…¶ä»–ç©å®¶çœ‹ä¸åˆ°ç‰©å“å˜åŒ–ï¼ˆä¸åŒæ­¥ï¼‰
- ğŸš¨ æœåŠ¡å™¨æ— æ³•éªŒè¯äº¤æ˜“åˆæ³•æ€§

**æ­£ç¡®åšæ³•**:
```python
# âœ… å®¢æˆ·ç«¯åªè´Ÿè´£UI,æœåŠ¡å™¨å¤„ç†ä¸šåŠ¡é€»è¾‘
class ShopClientSystem(ClientSystem):
    def OnBuyItem(self, itemId):
        # å®¢æˆ·ç«¯åªå‘é€è¯·æ±‚
        self.NotifyToServer('Shop_BuyRequestEvent', {'itemId': itemId})
        self.ShowLoadingUI()

class ShopServerSystem(ServerSystem):
    def OnBuyRequest(self, args):
        playerId = args['playerId']
        itemId = args['itemId']

        # æœåŠ¡å™¨éªŒè¯å’Œä¿®æ”¹æ•°æ®
        if self.GetPlayerMoney(playerId) >= 100:
            self.DeductMoney(playerId, 100)
            self.GiveItem(playerId, itemId)
            self.NotifyToClient(playerId, 'Shop_BuySuccessEvent', {'itemId': itemId})
        else:
            self.NotifyToClient(playerId, 'Shop_BuyFailedEvent', {'reason': 'not_enough_money'})
```

**æ£€æµ‹æ–¹æ³•**:
- æœç´¢å®¢æˆ·ç«¯ä»£ç ä¸­çš„ä¸šåŠ¡é€»è¾‘å…³é”®è¯: `DeductMoney`, `AddExp`, `GiveItem`, `SetPlayerData`
- ä½¿ç”¨ `/validate-architecture` å‘½ä»¤è‡ªåŠ¨æ£€æµ‹

---

### åæ¨¡å¼2: Systemä¹‹é—´ç›´æ¥è°ƒç”¨ ğŸŸ  HIGH

**é”™è¯¯ç¤ºä¾‹**:
```python
# âŒ SystemAç›´æ¥è°ƒç”¨SystemBçš„æ–¹æ³•ï¼ˆå¼ºè€¦åˆï¼‰
class SystemA(ServerSystem):
    def __init__(self):
        self.system_b = SystemB()  # ç›´æ¥åˆ›å»ºå®ä¾‹

    def DoSomething(self):
        self.system_b.ProcessData()  # ç›´æ¥è°ƒç”¨

class SystemB(ServerSystem):
    def ProcessData(self):
        pass
```

**å±å®³**:
- ğŸš¨ å¼ºè€¦åˆ,ä¿®æ”¹SystemBä¼šå½±å“SystemA
- ğŸš¨ æ— æ³•ç‹¬ç«‹æµ‹è¯•
- ğŸš¨ éš¾ä»¥æ›¿æ¢å®ç°

**æ­£ç¡®åšæ³•**:
```python
# âœ… ä½¿ç”¨äº‹ä»¶é€šä¿¡ï¼ˆæ¾è€¦åˆï¼‰
class SystemA(ServerSystem):
    def DoSomething(self):
        # å‘é€äº‹ä»¶,ä¸ç›´æ¥è°ƒç”¨
        self.NotifyToServer('SystemA_RequestProcessEvent', {'data': 'xxx'})

class SystemB(ServerSystem):
    def __init__(self):
        self.ListenForEvent('MyMod', 'SystemA', 'SystemA_RequestProcessEvent', self, self.ProcessData)

    def ProcessData(self, args):
        data = args['data']
        # å¤„ç†æ•°æ®
```

---

### åæ¨¡å¼3: åœ¨`__init__`ä¸­è°ƒç”¨æ¸¸æˆAPI ğŸŸ  HIGH

**é”™è¯¯ç¤ºä¾‹**:
```python
# âŒ åˆå§‹åŒ–æ—¶è°ƒç”¨APIï¼ˆå¯èƒ½å¤±è´¥ï¼‰
class MyServerSystem(ServerSystem):
    def __init__(self):
        # æ­¤æ—¶ç»„ä»¶ç³»ç»Ÿå¯èƒ½å°šæœªåˆå§‹åŒ–å®Œæˆ
        playerId = self.GetLocalPlayerId()  # âŒ å¯èƒ½è¿”å›None
        self.player_pos = self.GetPlayerPos(playerId)  # âŒ å¯èƒ½å¤±è´¥
```

**å±å®³**:
- ğŸš¨ ç»„ä»¶ç³»ç»Ÿåˆå§‹åŒ–é¡ºåºä¸ç¡®å®š
- ğŸš¨ å¯èƒ½å¯¼è‡´`NoneType`é”™è¯¯
- ğŸš¨ æ¸¸æˆå´©æºƒ

**æ­£ç¡®åšæ³•**:
```python
# âœ… åœ¨äº‹ä»¶å›è°ƒä¸­è°ƒç”¨API
class MyServerSystem(ServerSystem):
    def __init__(self):
        # åªåšå˜é‡åˆå§‹åŒ–
        self.player_data = {}
        # ç›‘å¬ç©å®¶åŠ å…¥äº‹ä»¶
        self.ListenForEvent(
            serverApi.GetEngineNamespace(),
            serverApi.GetEngineSystemName(),
            'AddPlayerCreatedEvent',
            self,
            self.OnPlayerJoin
        )

    def OnPlayerJoin(self, args):
        # åœ¨ç©å®¶åŠ å…¥åæ‰è°ƒç”¨API
        playerId = args['playerId']
        self.player_data[playerId] = self.GetPlayerPos(playerId)
```

---

## ä¸‰ã€æ€§èƒ½åæ¨¡å¼

### åæ¨¡å¼4: ä¸ä½¿ç”¨RegisterView ğŸ”´ CRITICAL

**é”™è¯¯ç¤ºä¾‹**:
```python
# âŒ æ¯å¸§éå†æ‰€æœ‰å®ä½“ï¼ˆæ€§èƒ½æ€æ‰‹ï¼‰
class HealthRegenServerSystem(ServerSystem):
    def Update(self):
        # éå†ä¸–ç•Œä¸­æ‰€æœ‰å®ä½“ï¼ˆåŒ…æ‹¬æ–¹å—ã€ç‰©å“ç­‰ï¼‰
        for entity in self.GetAllEntities():  # å‡è®¾10,000ä¸ªå®ä½“
            if self.IsPlayer(entity):  # åªæœ‰100ä¸ªç©å®¶
                self.RegenHealth(entity)
        # æµªè´¹99%çš„CPUæ—¶é—´
```

**å±å®³**:
- ğŸš¨ å®ä½“æ•°é‡å¢åŠ æ—¶æ€§èƒ½æ€¥å‰§ä¸‹é™
- ğŸš¨ æ¸¸æˆå¡é¡¿
- ğŸš¨ æœåŠ¡å™¨TPSé™ä½

**æ­£ç¡®åšæ³•**:
```python
# âœ… ä½¿ç”¨RegisterViewè¿‡æ»¤å®ä½“
class HealthRegenServerSystem(ServerSystem):
    def __init__(self):
        # åªç›‘è§†æ‹¥æœ‰Healthç»„ä»¶çš„å®ä½“
        self.RegisterView('PlayersWithHealth', ['Minecraft:Health'])

    def Update(self):
        # åªéå†ç©å®¶å’Œç”Ÿç‰©
        for entity in self.GetEntitiesInView('PlayersWithHealth'):
            self.RegenHealth(entity)
```

**æ€§èƒ½æå‡**: 100å€

---

### åæ¨¡å¼5: é«˜é¢‘Updateæ“ä½œ ğŸŸ  HIGH

**é”™è¯¯ç¤ºä¾‹**:
```python
# âŒ æ¯å¸§æ‰§è¡Œå¤æ‚è®¡ç®—ï¼ˆCPUæ€æ‰‹ï¼‰
class LeaderboardServerSystem(ServerSystem):
    def Update(self):
        # æ¯å¸§ï¼ˆ20æ¬¡/ç§’ï¼‰é‡æ–°è®¡ç®—æ’è¡Œæ¦œ
        players = self.GetAllPlayers()
        scores = [self.CalculateScore(p) for p in players]  # è€—æ—¶æ“ä½œ
        self.SortLeaderboard(scores)  # è€—æ—¶æ“ä½œ
```

**å±å®³**:
- ğŸš¨ ä¸å¿…è¦çš„CPUå ç”¨
- ğŸš¨ æ¸¸æˆå¸§ç‡ä¸‹é™

**æ­£ç¡®åšæ³•**:
```python
# âœ… ä½¿ç”¨èŠ‚æµ,åªåœ¨å¿…è¦æ—¶è®¡ç®—
class LeaderboardServerSystem(ServerSystem):
    def __init__(self):
        self.tick_counter = 0

    def Update(self):
        self.tick_counter += 1
        # æ¯100 tickï¼ˆ5ç§’ï¼‰æ›´æ–°ä¸€æ¬¡
        if self.tick_counter % 100 == 0:
            self.UpdateLeaderboard()

    def UpdateLeaderboard(self):
        players = self.GetAllPlayers()
        scores = [self.CalculateScore(p) for p in players]
        self.SortLeaderboard(scores)
```

---

### åæ¨¡å¼6: é«˜é¢‘ç½‘ç»œRPC ğŸŸ  HIGH

**é”™è¯¯ç¤ºä¾‹**:
```python
# âŒ æ¯å¸§å‘é€ä½ç½®æ›´æ–°ï¼ˆç½‘ç»œæ‹¥å¡ï¼‰
class PlayerClientSystem(ClientSystem):
    def Update(self):
        # æ¯å¸§ï¼ˆ60fpsï¼‰å‘é€ä½ç½®
        self.NotifyToServer('Player_PositionUpdate', {
            'pos': self.GetPlayerPos()
        })
        # å¸¦å®½å ç”¨: 60æ¬¡/ç§’ Ã— 40å­—èŠ‚ = 2.4KB/ç§’
```

**å±å®³**:
- ğŸš¨ ç½‘ç»œæ‹¥å¡
- ğŸš¨ å»¶è¿Ÿå¢åŠ 
- ğŸš¨ æœåŠ¡å™¨å¤„ç†å‹åŠ›å¤§

**æ­£ç¡®åšæ³•**:
```python
# âœ… èŠ‚æµ + ä»…åœ¨å˜åŒ–æ—¶å‘é€
class PlayerClientSystem(ClientSystem):
    def __init__(self):
        self.last_sent_pos = None
        self.tick_counter = 0

    def Update(self):
        self.tick_counter += 1
        current_pos = self.GetPlayerPos()

        # æ¯20å¸§ï¼ˆçº¦0.33ç§’ï¼‰æ£€æŸ¥ä¸€æ¬¡
        if self.tick_counter % 20 == 0:
            # åªæœ‰ä½ç½®å˜åŒ–è¶…è¿‡0.5æ ¼æ‰å‘é€
            if self.last_sent_pos is None or self.DistanceTo(current_pos, self.last_sent_pos) > 0.5:
                self.NotifyToServer('Player_PositionUpdate', {'pos': current_pos})
                self.last_sent_pos = current_pos
```

---

## å››ã€å®‰å…¨åæ¨¡å¼

### åæ¨¡å¼7: ä¿¡ä»»å®¢æˆ·ç«¯æ•°æ® ğŸ”´ CRITICAL

**é”™è¯¯ç¤ºä¾‹**:
```python
# âŒ ç›´æ¥ä½¿ç”¨å®¢æˆ·ç«¯å‘é€çš„ä»·æ ¼ï¼ˆä½œå¼Šé£é™©ï¼‰
class ShopServerSystem(ServerSystem):
    def OnBuyItem(self, args):
        playerId = args['playerId']
        itemId = args['itemId']
        price = args['price']  # âŒ å®¢æˆ·ç«¯å¯ä»¥ä¿®æ”¹ä¸º0

        self.DeductMoney(playerId, price)
        self.GiveItem(playerId, itemId)
```

**å±å®³**:
- ğŸš¨ é»‘å®¢å¯ä»¥ä¿®æ”¹å®¢æˆ·ç«¯ä»£ç ,å‘é€price=0
- ğŸš¨ æ¸¸æˆç»æµå´©æºƒ

**æ­£ç¡®åšæ³•**:
```python
# âœ… æœåŠ¡å™¨é‡æ–°è®¡ç®—å¹¶éªŒè¯
class ShopServerSystem(ServerSystem):
    def OnBuyItem(self, args):
        playerId = args['playerId']
        itemId = args['itemId']

        # æœåŠ¡å™¨æŸ¥è¯¢çœŸå®ä»·æ ¼
        real_price = self.GetItemPriceFromConfig(itemId)

        if self.GetPlayerMoney(playerId) < real_price:
            self.NotifyToClient(playerId, 'BuyFailed', {'reason': 'not_enough_money'})
            return

        self.DeductMoney(playerId, real_price)
        self.GiveItem(playerId, itemId)
```

---

### åæ¨¡å¼8: ç¼ºå°‘æƒé™éªŒè¯ ğŸŸ  HIGH

**é”™è¯¯ç¤ºä¾‹**:
```python
# âŒ æ²¡æœ‰éªŒè¯ç©å®¶æƒé™ï¼ˆè¶Šæƒé£é™©ï¼‰
class AdminServerSystem(ServerSystem):
    def OnKickPlayer(self, args):
        admin_id = args['playerId']
        target_id = args['targetId']

        # ç›´æ¥è¸¢å‡ºç©å®¶,æ²¡æœ‰æ£€æŸ¥æ˜¯å¦æ˜¯ç®¡ç†å‘˜
        self.KickPlayer(target_id)
```

**å±å®³**:
- ğŸš¨ æ™®é€šç©å®¶å¯ä»¥è¸¢å‡ºå…¶ä»–ç©å®¶
- ğŸš¨ æ¸¸æˆç§©åºæ··ä¹±

**æ­£ç¡®åšæ³•**:
```python
# âœ… éªŒè¯æƒé™åæ‰§è¡Œ
class AdminServerSystem(ServerSystem):
    def OnKickPlayer(self, args):
        admin_id = args['playerId']
        target_id = args['targetId']

        # éªŒè¯æ˜¯å¦æ˜¯ç®¡ç†å‘˜
        if not self.IsAdmin(admin_id):
            self.NotifyToClient(admin_id, 'Error', {'reason': 'permission_denied'})
            return

        self.KickPlayer(target_id)
        self.LogAdminAction(admin_id, 'kick', target_id)
```

---

## äº”ã€ä»£ç è´¨é‡åæ¨¡å¼

### åæ¨¡å¼9: è¿‡åº¦ä½¿ç”¨å…¨å±€å˜é‡ ğŸŸ¡ MEDIUM

**é”™è¯¯ç¤ºä¾‹**:
```python
# âŒ å…¨å±€å˜é‡æ±¡æŸ“ï¼ˆç»´æŠ¤å›°éš¾ï¼‰
g_player_money = {}
g_player_vip_level = {}
g_shop_items = []

class ShopServerSystem(ServerSystem):
    def GetPlayerMoney(self, playerId):
        return g_player_money.get(playerId, 0)
```

**å±å®³**:
- ğŸš¨ å‘½åå†²çªï¼ˆå…¶ä»–Modå¯èƒ½ä½¿ç”¨ç›¸åŒåç§°ï¼‰
- ğŸš¨ éš¾ä»¥è¿½è¸ªæ•°æ®ä¿®æ”¹
- ğŸš¨ æµ‹è¯•å›°éš¾

**æ­£ç¡®åšæ³•**:
```python
# âœ… ä½¿ç”¨Systemæˆå‘˜å˜é‡
class ShopServerSystem(ServerSystem):
    def __init__(self):
        self.player_money = {}  # å®ä¾‹å˜é‡
        self.player_vip_level = {}
        self.shop_items = []

    def GetPlayerMoney(self, playerId):
        return self.player_money.get(playerId, 0)
```

---

### åæ¨¡å¼10: ç¡¬ç¼–ç é…ç½® ğŸŸ¡ MEDIUM

**é”™è¯¯ç¤ºä¾‹**:
```python
# âŒ ç¡¬ç¼–ç æ•°å€¼ï¼ˆä¿®æ”¹å›°éš¾ï¼‰
class VIPServerSystem(ServerSystem):
    def GetVIPDiscount(self, vip_level):
        if vip_level == 1:
            return 0.95  # ç¡¬ç¼–ç æŠ˜æ‰£
        elif vip_level == 2:
            return 0.9
        elif vip_level == 3:
            return 0.85
```

**å±å®³**:
- ğŸš¨ ä¿®æ”¹é…ç½®éœ€è¦é‡æ–°å‘å¸ƒä»£ç 
- ğŸš¨ éš¾ä»¥è°ƒæ•´å¹³è¡¡æ€§

**æ­£ç¡®åšæ³•**:
```python
# âœ… ä½¿ç”¨é…ç½®æ–‡ä»¶
class VIPServerSystem(ServerSystem):
    def __init__(self):
        # ä»é…ç½®æ–‡ä»¶åŠ è½½
        self.vip_config = self.LoadConfig('vip_config.json')
        # {"1": 0.95, "2": 0.9, "3": 0.85}

    def GetVIPDiscount(self, vip_level):
        return self.vip_config.get(str(vip_level), 1.0)
```

---

### åæ¨¡å¼11: å¿˜è®°å–æ¶ˆäº‹ä»¶ç›‘å¬ ğŸŸ  HIGH

**é”™è¯¯ç¤ºä¾‹**:
```python
# âŒ æ²¡æœ‰Destroyæ–¹æ³•ï¼ˆå†…å­˜æ³„æ¼ï¼‰
class TempSystem(ServerSystem):
    def __init__(self):
        self.ListenForEvent('MyMod', 'OtherSystem', 'Event', self, self.OnEvent)

    def OnEvent(self, args):
        pass

    # ç¼ºå°‘Destroyæ–¹æ³• â†’ Systemé”€æ¯åç›‘å¬å™¨ä»å­˜åœ¨
```

**å±å®³**:
- ğŸš¨ å†…å­˜æ³„æ¼
- ğŸš¨ å¯èƒ½è§¦å‘å·²é”€æ¯å¯¹è±¡çš„å›è°ƒï¼ˆå´©æºƒï¼‰

**æ­£ç¡®åšæ³•**:
```python
# âœ… åœ¨Destroyä¸­å–æ¶ˆç›‘å¬
class TempSystem(ServerSystem):
    def __init__(self):
        self.ListenForEvent('MyMod', 'OtherSystem', 'Event', self, self.OnEvent)

    def OnEvent(self, args):
        pass

    def Destroy(self):
        # å–æ¶ˆæ‰€æœ‰ç›‘å¬
        self.UnListenAllEvents()
```

---

### åæ¨¡å¼12: ç¼ºå°‘é”™è¯¯å¤„ç† ğŸŸ¡ MEDIUM

**é”™è¯¯ç¤ºä¾‹**:
```python
# âŒ æ²¡æœ‰try-exceptï¼ˆå®¹æ˜“å´©æºƒï¼‰
class DataServerSystem(ServerSystem):
    def LoadPlayerData(self, playerId):
        # å¦‚æœæ–‡ä»¶ä¸å­˜åœ¨ä¼šæŠ›å¼‚å¸¸
        data = json.load(open('player_data.json'))
        return data[playerId]  # å¦‚æœplayerIdä¸å­˜åœ¨ä¹Ÿä¼šæŠ›å¼‚å¸¸
```

**å±å®³**:
- ğŸš¨ æœªå¤„ç†å¼‚å¸¸å¯¼è‡´æ¸¸æˆå´©æºƒ
- ğŸš¨ é”™è¯¯ä¿¡æ¯ä¸æ˜ç¡®

**æ­£ç¡®åšæ³•**:
```python
# âœ… æ·»åŠ é”™è¯¯å¤„ç†
class DataServerSystem(ServerSystem):
    def LoadPlayerData(self, playerId):
        try:
            with open('player_data.json', 'r') as f:
                data = json.load(f)
                return data.get(playerId, {})  # ä½¿ç”¨geté¿å…KeyError
        except IOError as e:
            print "[Error] Failed to load player data:", e
            return {}  # è¿”å›é»˜è®¤å€¼
        except json.JSONDecodeError as e:
            print "[Error] Invalid JSON:", e
            return {}
```

---

## å…­ã€åæ¨¡å¼æ£€æµ‹å·¥å…·

### 6.1 è‡ªåŠ¨æ£€æµ‹è„šæœ¬

**ä½¿ç”¨ `/validate-architecture` å‘½ä»¤**ï¼ˆéœ€è¦å…ˆåˆ›å»ºè¯¥å‘½ä»¤ï¼‰

**æ‰‹åŠ¨æ£€æµ‹å…³é”®è¯**:
```python
# åœ¨é¡¹ç›®ä¸­æœç´¢ä»¥ä¸‹æ¨¡å¼
# åæ¨¡å¼1: å®¢æˆ·ç«¯ä¸šåŠ¡é€»è¾‘
grep -r "DeductMoney\|AddExp\|GiveItem" behavior_packs/*/scripts/client/

# åæ¨¡å¼4: ç¼ºå°‘RegisterView
grep -L "RegisterView" behavior_packs/*/scripts/server/*ServerSystem.py

# åæ¨¡å¼11: ç¼ºå°‘Destroy
grep -L "def Destroy" behavior_packs/*/scripts/server/*System.py
```

---

### 6.2 ä»£ç å®¡æŸ¥é—®é¢˜æ¸…å•

**æ¶æ„å±‚é¢**:
- [ ] å®¢æˆ·ç«¯æ˜¯å¦åªè´Ÿè´£UI,æ²¡æœ‰ä¸šåŠ¡é€»è¾‘?
- [ ] Systemä¹‹é—´æ˜¯å¦ä½¿ç”¨äº‹ä»¶é€šä¿¡,è€Œéç›´æ¥è°ƒç”¨?
- [ ] `__init__`ä¸­æ˜¯å¦é¿å…è°ƒç”¨æ¸¸æˆAPI?

**æ€§èƒ½å±‚é¢**:
- [ ] æ‰€æœ‰Systemæ˜¯å¦ä½¿ç”¨äº†RegisterView?
- [ ] Updateä¸­çš„é€»è¾‘æ˜¯å¦ä½¿ç”¨èŠ‚æµ?
- [ ] ç½‘ç»œRPCé¢‘ç‡æ˜¯å¦<10æ¬¡/ç§’?

**å®‰å…¨å±‚é¢**:
- [ ] æœåŠ¡å™¨æ˜¯å¦é‡æ–°éªŒè¯å®¢æˆ·ç«¯å‘é€çš„æ•°æ®?
- [ ] æ˜¯å¦æœ‰æƒé™éªŒè¯?
- [ ] æ˜¯å¦æœ‰é¢‘ç‡é™åˆ¶é˜²æ­¢åˆ·è¯·æ±‚?

**ä»£ç è´¨é‡**:
- [ ] æ˜¯å¦é¿å…ä½¿ç”¨å…¨å±€å˜é‡?
- [ ] é…ç½®æ˜¯å¦å¤–éƒ¨åŒ–ï¼ˆä¸ç¡¬ç¼–ç ï¼‰?
- [ ] æ˜¯å¦æœ‰Destroyæ–¹æ³•å–æ¶ˆç›‘å¬?
- [ ] æ˜¯å¦æœ‰try-excepté”™è¯¯å¤„ç†?

---

## ä¸ƒã€ä»£ç å®¡æŸ¥æ¸…å•

### æäº¤ä»£ç å‰è‡ªæŸ¥

**âœ… æ¶æ„æ­£ç¡®æ€§**
- [ ] åŒç«¯éš”ç¦»: å®¢æˆ·ç«¯ä¸å¤„ç†ä¸šåŠ¡é€»è¾‘
- [ ] æ¾è€¦åˆ: Systemä¹‹é—´é€šè¿‡äº‹ä»¶é€šä¿¡
- [ ] å»¶è¿Ÿåˆå§‹åŒ–: `__init__`ä¸­ä¸è°ƒç”¨æ¸¸æˆAPI

**âœ… æ€§èƒ½ä¼˜åŒ–**
- [ ] æ‰€æœ‰éå†Entityçš„Systemä½¿ç”¨RegisterView
- [ ] é«˜é¢‘æ“ä½œï¼ˆ>10æ¬¡/ç§’ï¼‰ä½¿ç”¨èŠ‚æµ
- [ ] ç½‘ç»œäº‹ä»¶æ•°æ®å¤§å°<10KB

**âœ… å®‰å…¨æ€§**
- [ ] æœåŠ¡å™¨é‡æ–°éªŒè¯å®¢æˆ·ç«¯æ•°æ®
- [ ] æ•æ„Ÿæ“ä½œæœ‰æƒé™éªŒè¯
- [ ] æœ‰é¢‘ç‡é™åˆ¶é˜²æ­¢DDoS

**âœ… ä»£ç è´¨é‡**
- [ ] æ— å…¨å±€å˜é‡æ±¡æŸ“
- [ ] é…ç½®å¤–éƒ¨åŒ–ï¼ˆJSON/YAMLï¼‰
- [ ] æœ‰Destroyæ–¹æ³•
- [ ] æœ‰é”™è¯¯å¤„ç†

---

## å…«ã€å‚è€ƒèµ„æº

### ç›¸å…³å·¥ä½œæµæ–‡æ¡£
- **å¼€å‘è§„èŒƒ.md**: ç¬¬12ç« "å¸¸è§åæ¨¡å¼è­¦å‘Š"
- **æ·±å…¥ç†è§£ECSæ¶æ„.md**: RegisterViewè¯¦è§£
- **æ€§èƒ½ä¼˜åŒ–å®Œæ•´æŒ‡å—.md**: æ€§èƒ½åæ¨¡å¼è¯¦è§£
- **ç½‘ç»œæ¶æ„ä¸é€šä¿¡.md**: åŒç«¯éš”ç¦»åŸç†

---

**æ–‡æ¡£ç‰ˆæœ¬**: v1.0
**æœ€åæ›´æ–°**: 2025-11-11
**ç»´æŠ¤è€…**: NeteaseMod-Claudeå·¥ä½œæµ
