# æ•°æ®æŒä¹…åŒ–æŒ‡å—

> **ğŸ“ å¯¼èˆª**: [ğŸ  é¦–é¡µ](../README.md) > [ğŸ“‚ æ–‡æ¡£](../README.md#æ–‡æ¡£å¯¼èˆª) > æ•°æ®æŒä¹…åŒ–æŒ‡å—
>
> **æ–‡æ¡£è¯´æ˜**: æ·±å…¥è®²è§£MODSDKçš„æ•°æ®æŒä¹…åŒ–æœºåˆ¶å’Œæœ€ä½³å®è·µ
>
> **ğŸ“… æœ€åæ›´æ–°**: 2025-01-11
> **æ–‡æ¡£ç‰ˆæœ¬**: 2.0ï¼ˆç²¾ç®€ç‰ˆï¼‰

---

## ğŸ“‹ ç›®å½•

1. [æŒä¹…åŒ–æ¦‚è¿°](#1-æŒä¹…åŒ–æ¦‚è¿°)
2. [ExtraDataç»„ä»¶è¯¦è§£](#2-extradataç»„ä»¶è¯¦è§£)
3. [æœ¬åœ°æ–‡ä»¶å­˜å‚¨](#3-æœ¬åœ°æ–‡ä»¶å­˜å‚¨)
4. [æ•°æ®ç»“æ„è®¾è®¡](#4-æ•°æ®ç»“æ„è®¾è®¡)
5. [ç‰ˆæœ¬æ§åˆ¶ä¸è¿ç§»](#5-ç‰ˆæœ¬æ§åˆ¶ä¸è¿ç§»)
6. [æ€§èƒ½ä¼˜åŒ–ç­–ç•¥](#6-æ€§èƒ½ä¼˜åŒ–ç­–ç•¥)
7. [å¸¸è§é—®é¢˜FAQ](#7-å¸¸è§é—®é¢˜faq)

---

## 1. æŒä¹…åŒ–æ¦‚è¿°

### 1.1 MODSDKæŒä¹…åŒ–æ–¹æ¡ˆå¯¹æ¯”

| æ–¹æ¡ˆ | é€‚ç”¨åœºæ™¯ | å­˜å‚¨ä½ç½® | è·¨æœåŠ¡å™¨ | APIå¤æ‚åº¦ |
|------|---------|---------|---------|----------|
| **ExtraDataç»„ä»¶** | ç©å®¶/å®ä½“/ä¸–ç•Œçº§åˆ«æ•°æ® | ä¸–ç•Œå­˜æ¡£ç›®å½• | âŒ | â­ ç®€å• |
| **æœ¬åœ°æ–‡ä»¶** | å…¨å±€é…ç½®ã€æ—¥å¿— | `behavior_packs/YourMod/` | âŒ | â­â­ ä¸­ç­‰ |
| **æ•°æ®åº“ï¼ˆç¬¬ä¸‰æ–¹ï¼‰** | å¤§è§„æ¨¡æ•°æ®ã€è·¨æœåŠ¡å™¨ | å¤–éƒ¨MySQL/Redis | âœ… | â­â­â­ å¤æ‚ |

**æ¨èæ–¹æ¡ˆ**: ğŸ¥‡ ExtraDataï¼ˆå®˜æ–¹æ¨èï¼‰ â†’ ğŸ¥ˆ æœ¬åœ°æ–‡ä»¶ï¼ˆé…ç½®æ—¥å¿—ï¼‰ â†’ ğŸ¥‰ æ•°æ®åº“ï¼ˆè¶…å‡ºMODSDKèŒƒå›´ï¼‰

---

### 1.2 æ•°æ®æŒä¹…åŒ–ç”Ÿå‘½å‘¨æœŸ

```mermaid
graph LR
    A[æ¸¸æˆå¯åŠ¨] --> B[ä»ExtraDataè¯»å–]
    B --> C[åŠ è½½åˆ°å†…å­˜ç¼“å­˜]
    C --> D[è¿è¡Œæ—¶ä¿®æ”¹]
    D --> E{éœ€è¦æŒä¹…åŒ–?}
    E -->|æ˜¯| F[å†™å…¥ExtraData]
    E -->|å¦| D
    F --> G[è‡ªåŠ¨åŒæ­¥åˆ°ç¡¬ç›˜]
    G --> H[æœåŠ¡å™¨å…³é—­/é‡å¯]
    H --> A
```

---

## 2. ExtraDataç»„ä»¶è¯¦è§£

### 2.1 æ ¸å¿ƒæ¦‚å¿µ

**ExtraData**: ç½‘æ˜“å¼•æ“æä¾›çš„é”®å€¼å¯¹å­˜å‚¨ç³»ç»Ÿï¼Œæ”¯æŒä¸‰ç§ä½œç”¨åŸŸï¼š

| ä½œç”¨åŸŸ | APIæ ‡è¯† | ç”Ÿå‘½å‘¨æœŸ | å…¸å‹åœºæ™¯ |
|-------|--------|---------|---------|
| **ç©å®¶çº§** | `playerId` | ç©å®¶ç¦»çº¿åä¿ç•™ | ç­‰çº§ã€èƒŒåŒ…ã€æˆå°± |
| **å®ä½“çº§** | `entityId` | å®ä½“é”€æ¯æ—¶æ¸…ç† | NPCå¯¹è¯è¿›åº¦ã€æ€ªç‰©çŠ¶æ€ |
| **ä¸–ç•Œçº§** | `levelId` | ä¸–ç•Œå­˜æ¡£ç”Ÿå‘½å‘¨æœŸ | å…¨å±€é…ç½®ã€å•†å“åº“å­˜ |

**âš ï¸ å…³é”®é™åˆ¶**:
- âœ… ä»…æœåŠ¡ç«¯å¯ç”¨
- âœ… åªæ”¯æŒå­—ç¬¦ä¸²ç±»å‹
- âŒ å®¢æˆ·ç«¯éœ€é€šè¿‡RPCè¯·æ±‚

---

### 2.2 åŸºç¡€APIä¸æ•°æ®ç±»å‹

#### åˆ›å»ºç»„ä»¶ï¼ˆæœåŠ¡ç«¯ï¼‰

```python
# System.__init__æ–¹æ³•ä¸­
levelId = serverApi.GetLevelId()
self.extraDataComp = serverApi.GetEngineCompFactory().CreateExtraData(levelId)
```

#### æ•°æ®ç±»å‹è½¬æ¢è¡¨

| åŸå§‹ç±»å‹ | å­˜å‚¨æ–¹å¼ | è¯»å–æ–¹å¼ |
|---------|---------|---------|
| å­—ç¬¦ä¸² | ç›´æ¥å­˜å‚¨ | ç›´æ¥è¯»å– |
| æ•´æ•°/æµ®ç‚¹ | `str(value)` | `int()`/`float()` |
| åˆ—è¡¨/å­—å…¸ | `json.dumps()` | `json.loads()` |
| å¸ƒå°”å€¼ | `"True"`/`"False"` | `value == "True"` |

#### åŸºç¡€æ“ä½œä¼ªä»£ç 

```python
# å†™å…¥ï¼ˆä¼ªä»£ç ï¼‰
SetExtraData(entityId, key, str(value))

# è¯»å–ï¼ˆä¼ªä»£ç ï¼‰
valueStr = GetExtraData(entityId, key)
if valueStr:
    value = json.loads(valueStr)  # å¤æ‚ç±»å‹
else:
    value = defaultValue
```

---

### 2.3 ä¸‰ç§ä½œç”¨åŸŸå®æˆ˜ç¤ºä¾‹

#### ç©å®¶çº§ï¼šç­‰çº§ç³»ç»Ÿ

```python
def SavePlayerLevel(self, playerId, level):
    self.extraDataComp.SetExtraData(playerId, 'player_level', str(level))

def LoadPlayerLevel(self, playerId):
    levelStr = self.extraDataComp.GetExtraData(playerId, 'player_level')
    return int(levelStr) if levelStr else 1
```

#### ä¸–ç•Œçº§ï¼šå…¨å±€å•†å“åº“å­˜

```python
def UpdateGlobalStock(self, itemId, stock):
    levelId = serverApi.GetLevelId()
    stockDataStr = self.extraDataComp.GetExtraData(levelId, 'global_stock')
    stockDict = json.loads(stockDataStr) if stockDataStr else {}
    stockDict[itemId] = stock
    self.extraDataComp.SetExtraData(levelId, 'global_stock', json.dumps(stockDict))
```

---

### 2.4 å¤æ‚æ•°æ®ç»“æ„ï¼šç©å®¶èƒŒåŒ…ç¤ºä¾‹

**æ•°æ®ç»“æ„è®¾è®¡**:

```python
inventoryData = {
    'items': [
        {'slot': 0, 'itemName': 'minecraft:diamond', 'count': 64},
        {'slot': 1, 'itemName': 'minecraft:iron_sword', 'count': 1}
    ],
    'money': 1000
}
```

**å­˜å‚¨ä¸åŠ è½½**:

```python
def SaveInventory(self, playerId, inventoryData):
    jsonStr = json.dumps(inventoryData)
    self.extraDataComp.SetExtraData(playerId, 'inventory', jsonStr)

def LoadInventory(self, playerId):
    jsonStr = self.extraDataComp.GetExtraData(playerId, 'inventory')
    return json.loads(jsonStr) if jsonStr else {'items': [], 'money': 0}
```

---

### 2.5 æ ¸å¿ƒé™åˆ¶ä¸è§£å†³æ–¹æ¡ˆ

#### é™åˆ¶1ï¼šå­˜å‚¨å®¹é‡é™åˆ¶

| é—®é¢˜ | å»ºè®®é™åˆ¶ | è§£å†³æ–¹æ¡ˆ |
|------|---------|---------|
| å•ä¸ªKeyæœ€å¤§é•¿åº¦ | ~1MB | åˆ†å—å­˜å‚¨ï¼ˆè§ä¸‹ï¼‰ |
| æ€»æ•°æ®é‡ | æ— æ˜ç¡®é™åˆ¶ | ç›‘æ§+ä¼˜åŒ– |

**åˆ†å—å­˜å‚¨ä¼ªä»£ç **:

```python
# å†™å…¥ï¼šæ‹†åˆ†ä¸ºå¤šä¸ªchunk
chunkSize = 100
for i in range(0, len(largeList), chunkSize):
    chunk = largeList[i:i+chunkSize]
    SetExtraData(playerId, f'data_chunk_{i//chunkSize}', json.dumps(chunk))
SetExtraData(playerId, 'chunk_count', str(len(largeList)//chunkSize + 1))

# è¯»å–ï¼šåˆå¹¶æ‰€æœ‰chunk
chunkCount = int(GetExtraData(playerId, 'chunk_count') or "0")
allData = []
for i in range(chunkCount):
    chunkStr = GetExtraData(playerId, f'data_chunk_{i}')
    allData.extend(json.loads(chunkStr))
```

---

#### é™åˆ¶2ï¼šå†™å…¥æ€§èƒ½é™åˆ¶

**æ€§èƒ½å¯¹æ¯”**:

| ç­–ç•¥ | å†™å…¥é¢‘ç‡ | TPSå½±å“ | æ•°æ®ä¸¢å¤±é£é™© |
|------|---------|---------|-------------|
| ç«‹å³å†™å…¥ | æ¯æ¬¡ä¿®æ”¹ | -10~20% | æ—  |
| 10ç§’ç¼“å­˜ | æ¯10ç§’ | <1% | 10ç§’å†…æ•°æ® |
| ä¸‹çº¿ä¿å­˜ | ä»…ä¸‹çº¿æ—¶ | æä½ | å´©æºƒå…¨ä¸¢å¤± |

**æ¨èæ–¹æ¡ˆ**ï¼š10ç§’å®šæ—¶ä¿å­˜ + ç©å®¶ä¸‹çº¿æ—¶ä¿å­˜

**å®ç°ä¼ªä»£ç **:

```python
# å†…å­˜ç¼“å­˜
self.playerDataCache = {}

def UpdatePlayerData(self, playerId, key, value):
    if playerId not in self.playerDataCache:
        self.playerDataCache[playerId] = {}
    self.playerDataCache[playerId][key] = value
    # ä¸ç«‹å³å†™å…¥ExtraData

def AutoSaveAllPlayers(self):
    """å®šæ—¶å™¨ï¼šæ¯10ç§’è°ƒç”¨"""
    for playerId, data in self.playerDataCache.items():
        jsonStr = json.dumps(data)
        self.extraDataComp.SetExtraData(playerId, 'player_data', jsonStr)
```

---

#### é™åˆ¶3ï¼šå®¢æˆ·ç«¯è®¿é—®é™åˆ¶

**RPCé€šä¿¡æµç¨‹**:

```mermaid
sequenceDiagram
    Client->>Server: NotifyToServer('RequestData', {playerId})
    Server->>ExtraData: GetExtraData(playerId, 'data')
    ExtraData-->>Server: è¿”å›æ•°æ®
    Server->>Client: NotifyToClient(playerId, 'ReceiveData', {data})
    Client->>Client: æ›´æ–°UIæ˜¾ç¤º
```

**å®ç°ä¼ªä»£ç **:

```python
# å®¢æˆ·ç«¯
def RequestData(self):
    playerId = clientApi.GetLocalPlayerId()
    self.NotifyToServer('RequestDataEvent', {'playerId': playerId})

def OnReceiveData(self, args):
    data = args['data']
    # æ›´æ–°UI

# æœåŠ¡ç«¯
def OnRequestData(self, args):
    playerId = args['playerId']
    dataStr = self.extraDataComp.GetExtraData(playerId, 'player_data')
    data = json.loads(dataStr) if dataStr else {}
    self.NotifyToClient(playerId, 'ReceiveDataEvent', {'data': data})
```

---

## 3. æœ¬åœ°æ–‡ä»¶å­˜å‚¨

### 3.1 ä½¿ç”¨åœºæ™¯ä¸é™åˆ¶

**é€‚ç”¨**ï¼š
- âœ… å…¨å±€é…ç½®ï¼ˆå•†å“ä»·æ ¼ã€æ´»åŠ¨æ—¶é—´ï¼‰
- âœ… æ—¥å¿—æ–‡ä»¶ï¼ˆè°ƒè¯•ã€é”™è¯¯è®°å½•ï¼‰
- âœ… å¤§å‹é™æ€æ•°æ®ï¼ˆåœ°å›¾æ•°æ®ã€NPCå¯¹è¯ï¼‰

**ä¸é€‚ç”¨**ï¼š
- âŒ ç©å®¶æ•°æ®ï¼ˆç”¨ExtraDataï¼‰
- âŒ å®ä½“æ•°æ®ï¼ˆç”¨ExtraDataï¼‰

---

### 3.2 æ–‡ä»¶è·¯å¾„ä¸è¯»å†™è§„èŒƒ

#### æ¨èç›®å½•ç»“æ„

```
behavior_packs/YourMod/
â”œâ”€â”€ config/              # é…ç½®æ–‡ä»¶
â”‚   â”œâ”€â”€ shop_items.json
â”‚   â””â”€â”€ settings.json
â”œâ”€â”€ logs/                # æ—¥å¿—æ–‡ä»¶
â”‚   â””â”€â”€ debug.log
â””â”€â”€ data/                # æ•°æ®æ–‡ä»¶
    â””â”€â”€ npc_dialogues.json
```

#### è¯»å–é…ç½®æ–‡ä»¶ä¼ªä»£ç 

```python
import json, os

def LoadConfig(self, filename):
    modPath = os.path.dirname(__file__)
    configPath = os.path.join(modPath, 'config', filename)

    try:
        with open(configPath, 'r', encoding='utf-8') as f:
            return json.load(f)
    except (IOError, ValueError) as e:
        print(f"[Config] åŠ è½½å¤±è´¥: {e}")
        return {}
```

#### æ—¥å¿—å†™å…¥ä¼ªä»£ç 

```python
import time

def Log(self, level, message):
    timestamp = time.strftime('%Y-%m-%d %H:%M:%S')
    logLine = f'[{timestamp}] [{level}] {message}\n'

    try:
        with open(self.logFilePath, 'a', encoding='utf-8') as f:
            f.write(logLine)
    except IOError as e:
        print(f"[Log] å†™å…¥å¤±è´¥: {e}")
```

---

### 3.3 æ–‡ä»¶æ“ä½œæ³¨æ„äº‹é¡¹

| é—®é¢˜ | è§£å†³æ–¹æ¡ˆ |
|------|---------|
| ä¸­æ–‡ä¹±ç  | å§‹ç»ˆä½¿ç”¨`encoding='utf-8'` |
| æ–‡ä»¶ä¸å­˜åœ¨ | ä½¿ç”¨`try-except`æ•è·`IOError` |
| è·¯å¾„åˆ†éš”ç¬¦ | ä½¿ç”¨`os.path.join()`è·¨å¹³å°å…¼å®¹ |
| JSONæ ¼å¼é”™è¯¯ | æ•è·`ValueError`å¼‚å¸¸ |

---

## 4. æ•°æ®ç»“æ„è®¾è®¡

### 4.1 è®¾è®¡åŸåˆ™

| åŸåˆ™ | åä¾‹ | æ­£ä¾‹ |
|------|------|------|
| **æ‰å¹³åŒ–ç»“æ„** | `{'attributes': {'combat': {'strength': 10}}}` | `{'combat_strength': 10}` |
| **ç‰ˆæœ¬æ§åˆ¶** | `{'level': 10}` | `{'_version': 2, 'level': 10}` |
| **å­—æ®µå‘½å** | `{'a': 1, 'b': 2}` | `{'player_level': 1, 'player_exp': 2}` |

---

### 4.2 å¸¸è§æ•°æ®ç»“æ„æ¨¡æ¿

#### ç©å®¶å±æ€§

```python
{
    '_version': 1,
    'level': 10,
    'exp': 5000,
    'money': 1000,
    'vip_level': 2,
    'last_login': '2025-01-11 10:00:00'
}
```

#### æˆå°±è¿›åº¦

```python
{
    '_version': 1,
    'kill_zombie_100': 45,  # è¿›åº¦ï¼š45/100
    'place_block_1000': 567
}
```

#### å•†åŸè´­ä¹°å†å²

```python
{
    '_version': 1,
    'records': [
        {'itemId': 'sword_001', 'count': 1, 'price': 100, 'timestamp': 1704960000}
    ],
    'total_spent': 600
}
```

---

## 5. ç‰ˆæœ¬æ§åˆ¶ä¸è¿ç§»

### 5.1 æ•°æ®è¿ç§»ç­–ç•¥

**å‘åå…¼å®¹æµç¨‹**:

```mermaid
graph TD
    A[è¯»å–æ•°æ®] --> B{æ£€æŸ¥_version}
    B -->|v1| C[æ‰§è¡Œv1â†’v2è¿ç§»]
    B -->|v2| D[æ‰§è¡Œv2â†’v3è¿ç§»]
    B -->|v3| E[ç›´æ¥ä½¿ç”¨]
    C --> D
    D --> E
    E --> F[ä¿å­˜è¿ç§»åçš„æ•°æ®]
```

---

### 5.2 è¿ç§»å®ç°ä¼ªä»£ç 

```python
def LoadPlayerData(self, playerId):
    dataStr = self.extraDataComp.GetExtraData(playerId, 'player_data')

    if not dataStr:
        # æ–°ç©å®¶ï¼šè¿”å›æœ€æ–°ç‰ˆæœ¬é»˜è®¤å€¼
        return {'_version': 3, 'level': 1, 'coins': 1000, 'vip_level': 0}

    data = json.loads(dataStr)
    version = data.get('_version', 1)

    # é€æ­¥è¿ç§»
    if version == 1:
        data = self._MigrateV1ToV2(data)
        version = 2
    if version == 2:
        data = self._MigrateV2ToV3(data)
        version = 3

    # ä¿å­˜è¿ç§»åçš„æ•°æ®
    self.SavePlayerData(playerId, data)
    return data

def _MigrateV1ToV2(self, data):
    """v1â†’v2: æ·»åŠ vip_levelå­—æ®µ"""
    data['vip_level'] = 0
    data['_version'] = 2
    return data

def _MigrateV2ToV3(self, data):
    """v2â†’v3: é‡å‘½åmoneyä¸ºcoins"""
    data['coins'] = data.pop('money', 0)
    data['_version'] = 3
    return data
```

---

## 6. æ€§èƒ½ä¼˜åŒ–ç­–ç•¥

### 6.1 ä¼˜åŒ–ç­–ç•¥çŸ©é˜µ

| ç­–ç•¥ | æ€§èƒ½æå‡ | å®ç°éš¾åº¦ | é€‚ç”¨åœºæ™¯ | æ¨èåº¦ |
|------|---------|---------|---------|-------|
| **å†…å­˜ç¼“å­˜** | 100å€ï¼ˆ1kâ†’100k TPSï¼‰ | â­ | æ‰€æœ‰é¡¹ç›® | ğŸ¥‡ å¼ºçƒˆæ¨è |
| **å®šæ—¶æ‰¹é‡ä¿å­˜** | 10å€ | â­ | æ‰€æœ‰é¡¹ç›® | ğŸ¥‡ å¼ºçƒˆæ¨è |
| **å¢é‡åŒæ­¥** | 3-5å€ | â­â­ | é¢‘ç¹å˜æ›´çš„å¤§æ•°æ® | ğŸ¥ˆ æ¨è |
| **åˆ†å—å­˜å‚¨** | 2-3å€ | â­â­ | >100KBæ•°æ® | ğŸ¥ˆ å¤§æ•°æ®å¿…é€‰ |
| **å‹ç¼©å­˜å‚¨** | èŠ‚çœ70%ç©ºé—´ | â­â­â­ | >100KBæ•°æ® | ğŸ¥‰ å¯é€‰ |

---

### 6.2 å¢é‡åŒæ­¥ä¼ªä»£ç 

```python
# è®°å½•ä¸Šæ¬¡ä¿å­˜çš„å¿«ç…§
self.lastSavedSnapshot = {}

def SaveIncremental(self, playerId):
    currentData = self.playerDataCache.get(playerId, {})
    lastData = self.lastSavedSnapshot.get(playerId, {})

    # è®¡ç®—å·®å¼‚
    changedKeys = {k: v for k, v in currentData.items()
                   if k not in lastData or lastData[k] != v}

    if not changedKeys:
        return  # æ— å˜åŒ–ï¼Œè·³è¿‡

    # ä»…ä¿å­˜å˜åŒ–çš„å­—æ®µ
    for key, value in changedKeys.items():
        fieldKey = f'player_{playerId}_{key}'
        self.extraDataComp.SetExtraData(playerId, fieldKey, str(value))

    # æ›´æ–°å¿«ç…§
    self.lastSavedSnapshot[playerId] = currentData.copy()
```

---

### 6.3 å‹ç¼©å­˜å‚¨ï¼ˆé«˜çº§ï¼‰

**å‹ç¼©æ•ˆæœ**: 100KB â†’ 30KBï¼ˆå‡å°‘70%ï¼‰

**å®ç°ä¼ªä»£ç **:

```python
import zlib, base64

def CompressData(self, data):
    jsonStr = json.dumps(data)
    compressed = zlib.compress(jsonStr.encode('utf-8'))
    return base64.b64encode(compressed).decode('ascii')

def DecompressData(self, encoded):
    compressed = base64.b64decode(encoded.encode('ascii'))
    jsonStr = zlib.decompress(compressed).decode('utf-8')
    return json.loads(jsonStr)
```

---

## 7. å¸¸è§é—®é¢˜FAQ

### Q1: ExtraDataæ•°æ®ä»€ä¹ˆæ—¶å€™ä¼šä¸¢å¤±ï¼Ÿ

| åœºæ™¯ | æ•°æ®æ˜¯å¦ä¸¢å¤± | åŸå›  |
|------|------------|------|
| æ­£å¸¸å…³é—­æœåŠ¡å™¨ | âœ… ä¸ä¸¢å¤± | è‡ªåŠ¨ä¿å­˜ |
| æœåŠ¡å™¨å´©æºƒ | âš ï¸ æœªä¿å­˜çš„ç¼“å­˜ä¸¢å¤± | æ¥ä¸åŠå†™å…¥ç¡¬ç›˜ |
| ç©å®¶ä¸‹çº¿ | âœ… ä¸ä¸¢å¤± | è‡ªåŠ¨ä¿å­˜ |

**å»ºè®®**: 10ç§’å®šæ—¶ä¿å­˜ + ç©å®¶ä¸‹çº¿æ—¶ä¿å­˜ + å…³é”®æ“ä½œç«‹å³ä¿å­˜

---

### Q2: å¦‚ä½•è°ƒè¯•ExtraDataå­˜å‚¨å¤±è´¥ï¼Ÿ

**æ£€æŸ¥æ¸…å•**:

```python
# 1. æ£€æŸ¥è¿”å›å€¼
success = self.extraDataComp.SetExtraData(playerId, key, value)
if not success:
    print(f"[Error] ä¿å­˜å¤±è´¥: {playerId} {key}")

# 2. æ£€æŸ¥æ•°æ®å¤§å°
jsonStr = json.dumps(data)
print(f"æ•°æ®å¤§å°: {len(jsonStr)} å­—èŠ‚")
if len(jsonStr) > 1024*1024:  # 1MB
    print("[Warning] æ•°æ®è¿‡å¤§ï¼Œå»ºè®®åˆ†å—")

# 3. æ£€æŸ¥JSONæ ¼å¼
try:
    json.dumps(data)
except (TypeError, ValueError) as e:
    print(f"[Error] JSONåºåˆ—åŒ–å¤±è´¥: {e}")
```

---

### Q3: ExtraDataèƒ½å­˜å‚¨ç©å®¶ç¦»çº¿åçš„æ•°æ®å—ï¼Ÿ

**ç­”æ¡ˆ**: âœ… å¯ä»¥ï¼

ExtraDataç»‘å®šåˆ°ç©å®¶IDï¼Œå³ä½¿ç©å®¶ç¦»çº¿ï¼Œæ•°æ®ä»ä¿ç•™åœ¨ä¸–ç•Œå­˜æ¡£ä¸­ï¼Œä¸‹æ¬¡ç™»å½•å¯è¯»å–ã€‚

---

### Q4: å¦‚ä½•å¤‡ä»½ExtraDataæ•°æ®ï¼Ÿ

**å¤‡ä»½æ–¹æ¡ˆ**:

| æ–¹æ³• | è·¯å¾„ | ä¼˜ç‚¹ | ç¼ºç‚¹ |
|------|------|------|------|
| **ä¸–ç•Œå­˜æ¡£å¤‡ä»½** | `worlds/<ä¸–ç•Œå>/db/` | å®Œæ•´å¤‡ä»½ | ä½“ç§¯å¤§ |
| **å¯¼å‡ºåˆ°JSON** | è‡ªå®šä¹‰è·¯å¾„ | å¯è¯»æ€§å¼º | éœ€æ‰‹åŠ¨å®ç° |

**æ¨è**: å®šæœŸå¤‡ä»½æ•´ä¸ªä¸–ç•Œå­˜æ¡£

---

### Q5: å¦‚ä½•å®ç°è·¨æœåŠ¡å™¨æ•°æ®åŒæ­¥ï¼Ÿ

**ç­”æ¡ˆ**: ExtraDataä¸æ”¯æŒè·¨æœåŠ¡å™¨ã€‚

**è§£å†³æ–¹æ¡ˆ**:
- ä½¿ç”¨å¤–éƒ¨æ•°æ®åº“ï¼ˆMySQL/Redisï¼‰
- å®ç°HTTP APIæœåŠ¡å™¨ä¸­è½¬
- ä½¿ç”¨äº‘å­˜å‚¨ï¼ˆå¦‚é˜¿é‡Œäº‘OSSï¼‰

**âš ï¸ è¶…å‡ºMODSDKèŒƒå›´ï¼Œéœ€è‡ªè¡Œå®ç°ã€‚**

---

## ğŸ“š æ¨èé˜…è¯»

å®Œæˆæœ¬æ–‡æ¡£å­¦ä¹ åï¼Œå»ºè®®ç»§ç»­é˜…è¯»ï¼š

- [ä¸šåŠ¡ç³»ç»Ÿå®ç°æ¡ˆä¾‹.md](ä¸šåŠ¡ç³»ç»Ÿå®ç°æ¡ˆä¾‹.md) - ExtraDataåœ¨å®æˆ˜ä¸­çš„åº”ç”¨
- [æ€§èƒ½ä¼˜åŒ–å®Œæ•´æŒ‡å—.md](æ€§èƒ½ä¼˜åŒ–å®Œæ•´æŒ‡å—.md) - æ•°æ®å­˜å‚¨æ€§èƒ½ä¼˜åŒ–
- [å¼€å‘è§„èŒƒ.md](../æ ¸å¿ƒå·¥ä½œæµæ–‡æ¡£/å¼€å‘è§„èŒƒ.md) - æ•°æ®æŒä¹…åŒ–å¼€å‘è§„èŒƒ

---

**æ–‡æ¡£ç‰ˆæœ¬**: 2.0ï¼ˆç²¾ç®€ç‰ˆï¼‰
**æœ€åæ›´æ–°**: 2025-01-11
**è´¡çŒ®è€…**: NeteaseMod-Claudeå·¥ä½œæµå›¢é˜Ÿ

**çŸ¥è¯†æ¥æºå£°æ˜**ï¼š
æœ¬æ–‡æ¡£åŸºäºä»¥ä¸‹åˆæ³•æ¥æºç¼–å†™ï¼š
- âœ… MODSDKå®˜æ–¹å¼€å‘æ–‡æ¡£ï¼ˆExtraData Component APIï¼‰
- âœ… Python 2.7æ–‡ä»¶æ“ä½œæ ‡å‡†åº“æ–‡æ¡£
- âœ… é€šç”¨è½¯ä»¶å·¥ç¨‹æ•°æ®æŒä¹…åŒ–æœ€ä½³å®è·µï¼ˆå¦‚ç¼“å­˜ç­–ç•¥ã€ç‰ˆæœ¬æ§åˆ¶ç­‰ï¼‰

æ‰€æœ‰ä»£ç ç¤ºä¾‹å‡ä¸ºç‹¬ç«‹è®¾è®¡ï¼Œæœªå¼•ç”¨ä»»ä½•éå®˜æ–¹ä»£ç å®ç°ã€‚
