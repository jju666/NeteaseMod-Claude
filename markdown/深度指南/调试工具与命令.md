# è°ƒè¯•å·¥å…·ä¸å‘½ä»¤

> **ğŸ“ å¯¼èˆª**: [ğŸ  é¦–é¡µ](../README.md) > [ğŸ“‚ æ–‡æ¡£](../README.md#æ–‡æ¡£å¯¼èˆª) > è°ƒè¯•å·¥å…·ä¸å‘½ä»¤
>
> **æ–‡æ¡£è¯´æ˜**: æ·±å…¥è®²è§£MODSDKå¼€å‘ä¸­çš„è°ƒè¯•æŠ€å·§å’Œå·¥å…·
>
> **ğŸ“… æœ€åæ›´æ–°**: 2025-01-11
> **æ–‡æ¡£ç‰ˆæœ¬**: 1.0

---

## ğŸ“‹ ç›®å½•

1. [è°ƒè¯•æ¦‚è¿°](#1-è°ƒè¯•æ¦‚è¿°)
2. [æ—¥å¿—ç³»ç»Ÿè¯¦è§£](#2-æ—¥å¿—ç³»ç»Ÿè¯¦è§£)
3. [Minecraftå†…ç½®è°ƒè¯•å‘½ä»¤](#3-minecraftå†…ç½®è°ƒè¯•å‘½ä»¤)
4. [è‡ªå®šä¹‰è°ƒè¯•å·¥å…·](#4-è‡ªå®šä¹‰è°ƒè¯•å·¥å…·)
5. [è¿œç¨‹è°ƒè¯•æŠ€å·§](#5-è¿œç¨‹è°ƒè¯•æŠ€å·§)
6. [æ€§èƒ½åˆ†æå·¥å…·](#6-æ€§èƒ½åˆ†æå·¥å…·)
7. [å¸¸è§é—®é¢˜FAQ](#7-å¸¸è§é—®é¢˜faq)

---

## 1. è°ƒè¯•æ¦‚è¿°

### 1.1 ä¸ºä»€ä¹ˆéœ€è¦è°ƒè¯•ï¼Ÿ

**å¸¸è§é—®é¢˜**ï¼š
- âŒ ä»£ç é€»è¾‘é”™è¯¯ï¼ˆå¦‚äº‹ä»¶æœªè§¦å‘ã€æ•°æ®è®¡ç®—é”™è¯¯ï¼‰
- âŒ æ€§èƒ½é—®é¢˜ï¼ˆå¦‚æ¸¸æˆå¡é¡¿ã€TPSä¸‹é™ï¼‰
- âŒ ç½‘ç»œé—®é¢˜ï¼ˆå¦‚å®¢æˆ·ç«¯-æœåŠ¡ç«¯ä¸åŒæ­¥ï¼‰

**è°ƒè¯•ç›®æ ‡**ï¼š
- âœ… å¿«é€Ÿå®šä½é—®é¢˜æ ¹æº
- âœ… éªŒè¯ä¿®å¤æ–¹æ¡ˆæœ‰æ•ˆæ€§
- âœ… ä¼˜åŒ–æ€§èƒ½ç“¶é¢ˆ

---

### 1.2 è°ƒè¯•å·¥å…·åˆ†ç±»

| å·¥å…·ç±»å‹ | é€‚ç”¨åœºæ™¯ | æ¨èåº¦ |
|---------|---------|-------|
| **æ—¥å¿—è¾“å‡º** | è¿½è¸ªä»£ç æ‰§è¡Œæµç¨‹ | ğŸ¥‡ å¿…å¤‡ |
| **Minecraftå‘½ä»¤** | æŸ¥çœ‹æ¸¸æˆçŠ¶æ€ã€å®ä½“ä¿¡æ¯ | ğŸ¥‡ å¿…å¤‡ |
| **è‡ªå®šä¹‰è°ƒè¯•UI** | å®æ—¶ç›‘æ§æ•°æ® | ğŸ¥ˆ æ¨è |
| **è¿œç¨‹è°ƒè¯•** | è¿æ¥IDEè°ƒè¯•å™¨ | ğŸ¥‰ é«˜çº§ |
| **æ€§èƒ½åˆ†æ** | å®šä½æ€§èƒ½ç“¶é¢ˆ | ğŸ¥ˆ æ¨è |

---

### 1.3 è°ƒè¯•æµç¨‹

```mermaid
graph TD
    A[å‘ç°é—®é¢˜] --> B{é—®é¢˜ç±»å‹?}
    B -->|é€»è¾‘é”™è¯¯| C[æ·»åŠ æ—¥å¿—è¾“å‡º]
    B -->|æ€§èƒ½é—®é¢˜| D[ä½¿ç”¨æ€§èƒ½åˆ†æå·¥å…·]
    B -->|æ•°æ®é”™è¯¯| E[ä½¿ç”¨Minecraftå‘½ä»¤æŸ¥è¯¢]

    C --> F[é‡ç°é—®é¢˜]
    D --> F
    E --> F

    F --> G[åˆ†ææ—¥å¿—/æ•°æ®]
    G --> H{æ‰¾åˆ°æ ¹å› ?}
    H -->|æ˜¯| I[ä¿®å¤ä»£ç ]
    H -->|å¦| J[æ·»åŠ æ›´å¤šæ—¥å¿—]
    J --> F

    I --> K[æµ‹è¯•éªŒè¯]
    K --> L{é—®é¢˜è§£å†³?}
    L -->|æ˜¯| M[åˆ é™¤è°ƒè¯•ä»£ç ]
    L -->|å¦| F
```

---

## 2. æ—¥å¿—ç³»ç»Ÿè¯¦è§£

### 2.1 åŸºç¡€æ—¥å¿—è¾“å‡º

#### æ–¹æ³•1ï¼šä½¿ç”¨printè¯­å¥

**æœ€ç®€å•çš„è°ƒè¯•æ–¹æ³•**ï¼š

```python
# -*- coding: utf-8 -*-
def OnPlayerJoin(self, args):
    playerId = args['playerId']
    print("[DEBUG] ç©å®¶åŠ å…¥:", playerId)  # è¾“å‡ºåˆ°æ§åˆ¶å°

    playerName = args.get('name', 'Unknown')
    print("[DEBUG] ç©å®¶åç§°:", playerName)
```

**è¾“å‡ºä½ç½®**ï¼š
- æœåŠ¡ç«¯ï¼šæœåŠ¡å™¨æ§åˆ¶å°ï¼ˆå‘½ä»¤è¡Œçª—å£ï¼‰
- å®¢æˆ·ç«¯ï¼šå®¢æˆ·ç«¯æ—¥å¿—æ–‡ä»¶ï¼ˆ`logs/latest.log`ï¼‰

---

#### æ–¹æ³•2ï¼šä½¿ç”¨MODSDKæ—¥å¿—API

```python
import mod.server.extraServerApi as serverApi

# è·å–æ—¥å¿—ç»„ä»¶
logger = serverApi.GetEngineCompFactory().CreateLog(serverApi.GetLevelId())

# ä¸åŒçº§åˆ«çš„æ—¥å¿—
logger.Info("è¿™æ˜¯ä¸€æ¡ä¿¡æ¯æ—¥å¿—")
logger.Warning("è¿™æ˜¯ä¸€æ¡è­¦å‘Šæ—¥å¿—")
logger.Error("è¿™æ˜¯ä¸€æ¡é”™è¯¯æ—¥å¿—")
```

**æ—¥å¿—çº§åˆ«è¯´æ˜**ï¼š

| çº§åˆ« | ç”¨é€” | ç¤ºä¾‹ |
|------|------|------|
| **Info** | æ­£å¸¸æµç¨‹è®°å½• | "ç©å®¶åŠ å…¥æœåŠ¡å™¨" |
| **Warning** | æ½œåœ¨é—®é¢˜æç¤º | "ç©å®¶ä½™é¢ä¸è¶³" |
| **Error** | ä¸¥é‡é”™è¯¯ | "é…ç½®æ–‡ä»¶åŠ è½½å¤±è´¥" |

---

### 2.2 ç»“æ„åŒ–æ—¥å¿—ç³»ç»Ÿ

**é—®é¢˜**ï¼šéšæ„ä½¿ç”¨printå¯¼è‡´æ—¥å¿—æ··ä¹±ï¼Œéš¾ä»¥æŸ¥æ‰¾

**è§£å†³æ–¹æ¡ˆ**ï¼šå»ºç«‹ç»“æ„åŒ–æ—¥å¿—ç®¡ç†å™¨

```python
# -*- coding: utf-8 -*-
"""
æ—¥å¿—ç®¡ç†å™¨ - ç»Ÿä¸€æ—¥å¿—è¾“å‡ºæ ¼å¼
"""

import time

class LogManager:
    """æ—¥å¿—ç®¡ç†å™¨ï¼ˆå•ä¾‹æ¨¡å¼ï¼‰"""

    _instance = None

    # æ—¥å¿—çº§åˆ«
    DEBUG = 0
    INFO = 1
    WARNING = 2
    ERROR = 3

    # æ—¥å¿—çº§åˆ«åç§°
    LEVEL_NAMES = {
        DEBUG: 'DEBUG',
        INFO: 'INFO',
        WARNING: 'WARNING',
        ERROR: 'ERROR'
    }

    @staticmethod
    def GetInstance():
        if LogManager._instance is None:
            LogManager._instance = LogManager()
        return LogManager._instance

    def __init__(self):
        # å½“å‰æ—¥å¿—çº§åˆ«ï¼ˆåªè¾“å‡ºå¤§äºç­‰äºæ­¤çº§åˆ«çš„æ—¥å¿—ï¼‰
        self.currentLevel = LogManager.INFO

        # æ—¥å¿—å‰ç¼€ï¼ˆç”¨äºåŒºåˆ†ä¸åŒæ¨¡å—ï¼‰
        self.prefix = "[MyMod]"

    def SetLevel(self, level):
        """è®¾ç½®æ—¥å¿—çº§åˆ«"""
        self.currentLevel = level
        print("{} æ—¥å¿—çº§åˆ«è®¾ç½®ä¸º: {}".format(self.prefix, self.LEVEL_NAMES[level]))

    def SetPrefix(self, prefix):
        """è®¾ç½®æ—¥å¿—å‰ç¼€"""
        self.prefix = prefix

    def _Log(self, level, message):
        """å†…éƒ¨æ—¥å¿—è¾“å‡º"""
        if level < self.currentLevel:
            return  # æ—¥å¿—çº§åˆ«ä¸å¤Ÿï¼Œè·³è¿‡

        timestamp = time.strftime('%H:%M:%S')
        levelName = self.LEVEL_NAMES[level]

        logLine = '[{}] {} [{}] {}'.format(timestamp, self.prefix, levelName, message)
        print(logLine)

    def Debug(self, message):
        """è°ƒè¯•æ—¥å¿—ï¼ˆä»…å¼€å‘æ—¶ä½¿ç”¨ï¼‰"""
        self._Log(LogManager.DEBUG, message)

    def Info(self, message):
        """ä¿¡æ¯æ—¥å¿—"""
        self._Log(LogManager.INFO, message)

    def Warning(self, message):
        """è­¦å‘Šæ—¥å¿—"""
        self._Log(LogManager.WARNING, message)

    def Error(self, message):
        """é”™è¯¯æ—¥å¿—"""
        self._Log(LogManager.ERROR, message)

# åˆ›å»ºå…¨å±€æ—¥å¿—å®ä¾‹
logger = LogManager.GetInstance()
logger.SetPrefix("[ShopMod]")

# ä½¿ç”¨ç¤ºä¾‹
logger.Debug("è¿™æ˜¯è°ƒè¯•ä¿¡æ¯ï¼ˆé»˜è®¤ä¸æ˜¾ç¤ºï¼‰")
logger.Info("æœåŠ¡å™¨å¯åŠ¨æˆåŠŸ")
logger.Warning("ç©å®¶ä½™é¢ä¸è¶³: player_001")
logger.Error("é…ç½®æ–‡ä»¶åŠ è½½å¤±è´¥")
```

**è¾“å‡ºç¤ºä¾‹**ï¼š
```
[10:30:15] [ShopMod] [INFO] æœåŠ¡å™¨å¯åŠ¨æˆåŠŸ
[10:30:20] [ShopMod] [WARNING] ç©å®¶ä½™é¢ä¸è¶³: player_001
[10:30:25] [ShopMod] [ERROR] é…ç½®æ–‡ä»¶åŠ è½½å¤±è´¥
```

---

### 2.3 æ—¥å¿—è¾“å‡ºæŠ€å·§

#### æŠ€å·§1ï¼šè¾“å‡ºå˜é‡ç±»å‹å’Œå€¼

```python
def ProcessPlayerData(self, playerId, data):
    # âœ… è¯¦ç»†è¾“å‡ºå˜é‡ä¿¡æ¯
    logger.Debug("playerIdç±»å‹: {}, å€¼: {}".format(type(playerId), playerId))
    logger.Debug("dataç±»å‹: {}, å†…å®¹: {}".format(type(data), data))

    # âŒ ä¸å¤Ÿè¯¦ç»†
    # print(playerId, data)
```

---

#### æŠ€å·§2ï¼šè¾“å‡ºå‡½æ•°è°ƒç”¨æ ˆ

```python
import traceback

def CriticalFunction(self):
    try:
        # å…³é”®é€»è¾‘
        result = self.DoSomething()
    except Exception as e:
        # è¾“å‡ºå®Œæ•´å¼‚å¸¸å †æ ˆ
        logger.Error("å‘ç”Ÿå¼‚å¸¸: {}".format(e))
        logger.Error("è°ƒç”¨æ ˆ:\n{}".format(traceback.format_exc()))
```

---

#### æŠ€å·§3ï¼šè¾“å‡ºå¯¹è±¡çŠ¶æ€

```python
def DebugEntityState(self, entityId):
    """è¾“å‡ºå®ä½“å®Œæ•´çŠ¶æ€ï¼ˆç”¨äºè°ƒè¯•ï¼‰"""
    logger.Debug("===== å®ä½“çŠ¶æ€ =====")
    logger.Debug("Entity ID: {}".format(entityId))

    # è¾“å‡ºä½ç½®
    posComp = serverApi.GetEngineCompFactory().CreatePos(entityId)
    pos = posComp.GetPos()
    logger.Debug("ä½ç½®: {}".format(pos))

    # è¾“å‡ºç”Ÿå‘½å€¼
    attrComp = serverApi.GetEngineCompFactory().CreateAttr(entityId)
    health = attrComp.GetAttrValue(serverApi.GetMinecraftEnum().AttrType.HEALTH)
    logger.Debug("ç”Ÿå‘½å€¼: {}".format(health))

    logger.Debug("==================")
```

---

### 2.4 æ—¥å¿—æ–‡ä»¶æŒä¹…åŒ–

**é—®é¢˜**ï¼šæ§åˆ¶å°æ—¥å¿—é‡å¯åæ¶ˆå¤±

**è§£å†³æ–¹æ¡ˆ**ï¼šå†™å…¥æ–‡ä»¶

```python
# -*- coding: utf-8 -*-
import os
import time

class FileLogger:
    """æ–‡ä»¶æ—¥å¿—è®°å½•å™¨"""

    def __init__(self, logFilePath):
        self.logFilePath = logFilePath

        # ç¡®ä¿æ—¥å¿—ç›®å½•å­˜åœ¨
        logDir = os.path.dirname(logFilePath)
        if not os.path.exists(logDir):
            os.makedirs(logDir)

    def Log(self, level, message):
        """å†™å…¥æ—¥å¿—æ–‡ä»¶"""
        timestamp = time.strftime('%Y-%m-%d %H:%M:%S')
        logLine = '[{}] [{}] {}\n'.format(timestamp, level, message)

        try:
            # è¿½åŠ æ¨¡å¼å†™å…¥
            with open(self.logFilePath, 'a', encoding='utf-8') as f:
                f.write(logLine)
        except IOError as e:
            print("[FileLogger] å†™å…¥æ—¥å¿—å¤±è´¥:", e)

    def Info(self, message):
        self.Log('INFO', message)

    def Warning(self, message):
        self.Log('WARNING', message)

    def Error(self, message):
        self.Log('ERROR', message)

# ä½¿ç”¨ç¤ºä¾‹
modPath = os.path.dirname(__file__)
logPath = os.path.join(modPath, 'logs', 'debug.log')
fileLogger = FileLogger(logPath)

fileLogger.Info("æœåŠ¡å™¨å¯åŠ¨æˆåŠŸ")
fileLogger.Error("é…ç½®æ–‡ä»¶åŠ è½½å¤±è´¥")
```

**æ—¥å¿—æ–‡ä»¶ç¤ºä¾‹**ï¼ˆ`behavior_packs/YourMod/logs/debug.log`ï¼‰ï¼š
```
[2025-01-11 10:30:15] [INFO] æœåŠ¡å™¨å¯åŠ¨æˆåŠŸ
[2025-01-11 10:30:20] [WARNING] ç©å®¶ä½™é¢ä¸è¶³
[2025-01-11 10:30:25] [ERROR] é…ç½®æ–‡ä»¶åŠ è½½å¤±è´¥
```

---

## 3. Minecraftå†…ç½®è°ƒè¯•å‘½ä»¤

### 3.1 å¸¸ç”¨è°ƒè¯•å‘½ä»¤æ¸…å•

| å‘½ä»¤ | åŠŸèƒ½ | ç¤ºä¾‹ |
|------|------|------|
| `/scoreboard` | æŸ¥çœ‹/è®¾ç½®è®¡åˆ†æ¿æ•°æ® | `/scoreboard players list` |
| `/data` | æŸ¥çœ‹å®ä½“NBTæ•°æ® | `/data get entity @p` |
| `/tag` | ç®¡ç†å®ä½“æ ‡ç­¾ | `/tag @s add debug_mode` |
| `/execute` | æ¡ä»¶æ‰§è¡Œå‘½ä»¤ | `/execute if entity @p[tag=debug]` |
| `/gametest` | è¿è¡Œæ¸¸æˆæµ‹è¯• | `/gametest run myTest` |

---

### 3.2 å®ä½“ä¿¡æ¯æŸ¥è¯¢

#### å‘½ä»¤1ï¼šæŸ¥çœ‹ç©å®¶ä½ç½®

```
/execute as @p run say æˆ‘çš„ä½ç½®: ~ ~ ~
```

**è¾“å‡º**ï¼š`æˆ‘çš„ä½ç½®: 100 64 200`

---

#### å‘½ä»¤2ï¼šæŸ¥çœ‹å®ä½“å±æ€§

```
/data get entity @p Health
```

**è¾“å‡º**ï¼š`player_001çš„ç”Ÿå‘½å€¼ä¸º20.0`

---

#### å‘½ä»¤3ï¼šåˆ—å‡ºæ‰€æœ‰å®ä½“

```
/execute as @e run say æˆ‘æ˜¯ @s
```

**è¾“å‡º**ï¼š
```
minecraft:zombieè¯´: æˆ‘æ˜¯ @s
minecraft:playerè¯´: æˆ‘æ˜¯ @s
```

---

### 3.3 è‡ªå®šä¹‰è°ƒè¯•å‘½ä»¤

**åœºæ™¯**ï¼šæ·»åŠ MODä¸“ç”¨çš„è°ƒè¯•å‘½ä»¤

#### ç¤ºä¾‹ï¼š/debugshopå‘½ä»¤

```python
# -*- coding: utf-8 -*-
"""
è‡ªå®šä¹‰è°ƒè¯•å‘½ä»¤ï¼š/debugshop
åŠŸèƒ½ï¼šè¾“å‡ºç©å®¶å•†åŸæ•°æ®
"""

import mod.server.extraServerApi as serverApi

ServerSystem = serverApi.GetServerSystemCls()

class ShopServerSystem(ServerSystem):
    def __init__(self, namespace, systemName):
        super(ShopServerSystem, self).__init__(namespace, systemName)

        # æ³¨å†Œè‡ªå®šä¹‰å‘½ä»¤
        self.RegisterCommand('debugshop', self.OnDebugShopCommand)

    def RegisterCommand(self, cmdName, callback):
        """æ³¨å†Œè‡ªå®šä¹‰å‘½ä»¤"""
        # ç›‘å¬ç©å®¶è¾“å…¥å‘½ä»¤äº‹ä»¶
        self.ListenForEvent(
            serverApi.GetEngineNamespace(),
            serverApi.GetEngineSystemName(),
            'PlayerInputCommandEvent',
            self,
            self.OnPlayerInputCommand
        )

        # ä¿å­˜å‘½ä»¤å›è°ƒ
        if not hasattr(self, 'customCommands'):
            self.customCommands = {}
        self.customCommands[cmdName] = callback

    def OnPlayerInputCommand(self, args):
        """ç›‘å¬ç©å®¶è¾“å…¥å‘½ä»¤"""
        playerId = args['playerId']
        command = args['command']

        # æ£€æŸ¥æ˜¯å¦ä¸ºè‡ªå®šä¹‰å‘½ä»¤
        if command.startswith('/'):
            cmdName = command[1:].split(' ')[0]
            if cmdName in self.customCommands:
                # è°ƒç”¨å‘½ä»¤å›è°ƒ
                self.customCommands[cmdName](playerId, command)

                # å–æ¶ˆé»˜è®¤å‘½ä»¤å¤„ç†
                args['cancel'] = True

    def OnDebugShopCommand(self, playerId, command):
        """
        /debugshopå‘½ä»¤å¤„ç†

        å‘½ä»¤æ ¼å¼ï¼š/debugshop [playerId]
        """
        parts = command.split(' ')

        # ç¡®å®šç›®æ ‡ç©å®¶
        if len(parts) > 1:
            targetPlayerId = parts[1]
        else:
            targetPlayerId = playerId

        # è·å–ç©å®¶å•†åŸæ•°æ®
        shopData = self._GetPlayerShopData(targetPlayerId)

        # è¾“å‡ºåˆ°èŠå¤©çª—å£
        self._SendMessage(playerId, "===== å•†åŸæ•°æ® =====")
        self._SendMessage(playerId, "ç©å®¶ID: {}".format(targetPlayerId))
        self._SendMessage(playerId, "ä½™é¢: {}".format(shopData.get('balance', 0)))
        self._SendMessage(playerId, "è´­ä¹°æ¬¡æ•°: {}".format(len(shopData.get('purchaseHistory', []))))
        self._SendMessage(playerId, "==================")

    def _SendMessage(self, playerId, message):
        """å‘ç©å®¶å‘é€èŠå¤©æ¶ˆæ¯"""
        chatComp = serverApi.GetEngineCompFactory().CreateMsg(playerId)
        chatComp.NotifyOneMessage(playerId, message, "Â§e[è°ƒè¯•]Â§r")

    def _GetPlayerShopData(self, playerId):
        """è·å–ç©å®¶å•†åŸæ•°æ®ï¼ˆç¤ºä¾‹ï¼‰"""
        # å®é™…é¡¹ç›®ä¸­åº”ä»ExtraDataè¯»å–
        return {
            'balance': 1000,
            'purchaseHistory': ['item1', 'item2']
        }
```

**ä½¿ç”¨ç¤ºä¾‹**ï¼š
```
/debugshop           # æŸ¥çœ‹è‡ªå·±çš„å•†åŸæ•°æ®
/debugshop player_001  # æŸ¥çœ‹æŒ‡å®šç©å®¶çš„å•†åŸæ•°æ®
```

**è¾“å‡º**ï¼š
```
[è°ƒè¯•] ===== å•†åŸæ•°æ® =====
[è°ƒè¯•] ç©å®¶ID: player_001
[è°ƒè¯•] ä½™é¢: 1000
[è°ƒè¯•] è´­ä¹°æ¬¡æ•°: 2
[è°ƒè¯•] ==================
```

---

## 4. è‡ªå®šä¹‰è°ƒè¯•å·¥å…·

### 4.1 å®æ—¶æ•°æ®ç›‘æ§UI

**åœºæ™¯**ï¼šåœ¨æ¸¸æˆä¸­å®æ—¶æŸ¥çœ‹SystemçŠ¶æ€

#### ç¤ºä¾‹ï¼šæ€§èƒ½ç›‘æ§UI

```python
# -*- coding: utf-8 -*-
"""
å®¢æˆ·ç«¯è°ƒè¯•UIï¼šå®æ—¶æ˜¾ç¤ºæ€§èƒ½æ•°æ®
"""

import mod.client.extraClientApi as clientApi

ClientSystem = clientApi.GetClientSystemCls()

class DebugClientSystem(ClientSystem):
    def __init__(self, namespace, systemName):
        super(DebugClientSystem, self).__init__(namespace, systemName)

        # åˆ›å»ºè°ƒè¯•UI
        self.debugUI = None
        self._CreateDebugUI()

        # å®šæ—¶æ›´æ–°UI
        self.CreateTimer(1.0, self.UpdateDebugUI)

    def _CreateDebugUI(self):
        """åˆ›å»ºè°ƒè¯•UIï¼ˆä¼ªä»£ç ï¼Œå®é™…éœ€è¦ä½¿ç”¨ScreenNodeï¼‰"""
        # å®é™…é¡¹ç›®ä¸­åº”ä½¿ç”¨MODSDKçš„UIç³»ç»Ÿ
        print("[DebugUI] è°ƒè¯•UIå·²åˆ›å»º")

    def UpdateDebugUI(self):
        """æ›´æ–°è°ƒè¯•ä¿¡æ¯"""
        # è·å–FPSï¼ˆå¸§ç‡ï¼‰
        fps = self._GetFPS()

        # è·å–å®ä½“æ•°é‡
        entityCount = self._GetEntityCount()

        # è·å–TPSï¼ˆæœåŠ¡å™¨æ¯ç§’Tickæ•°ï¼‰
        tps = self._GetTPS()

        # è¾“å‡ºåˆ°æ§åˆ¶å°ï¼ˆå®é™…é¡¹ç›®ä¸­åº”æ›´æ–°UIï¼‰
        debugInfo = "FPS: {} | å®ä½“æ•°: {} | TPS: {}".format(fps, entityCount, tps)
        print("[DebugUI]", debugInfo)

        # é‡æ–°åˆ›å»ºå®šæ—¶å™¨
        self.CreateTimer(1.0, self.UpdateDebugUI)

    def _GetFPS(self):
        """è·å–å½“å‰å¸§ç‡ï¼ˆç¤ºä¾‹ï¼‰"""
        # å®é™…é¡¹ç›®ä¸­åº”ä½¿ç”¨å¼•æ“APIè·å–
        return 60

    def _GetEntityCount(self):
        """è·å–å®ä½“æ•°é‡"""
        # å®é™…é¡¹ç›®ä¸­åº”ä½¿ç”¨GetEngineActor()
        return 100

    def _GetTPS(self):
        """è·å–æœåŠ¡å™¨TPSï¼ˆç¤ºä¾‹ï¼‰"""
        # éœ€è¦ä»æœåŠ¡ç«¯åŒæ­¥è·å–
        return 20
```

---

### 4.2 ä»£ç æ€§èƒ½è®¡æ—¶å™¨

**åœºæ™¯**ï¼šæµ‹é‡å‡½æ•°æ‰§è¡Œè€—æ—¶

```python
# -*- coding: utf-8 -*-
import time

class PerformanceTimer:
    """æ€§èƒ½è®¡æ—¶å™¨"""

    def __init__(self, name):
        self.name = name
        self.startTime = None

    def Start(self):
        """å¼€å§‹è®¡æ—¶"""
        self.startTime = time.time()

    def Stop(self):
        """åœæ­¢è®¡æ—¶å¹¶è¾“å‡ºç»“æœ"""
        if self.startTime is None:
            print("[PerformanceTimer] é”™è¯¯ï¼šæœªè°ƒç”¨Start()")
            return

        elapsed = time.time() - self.startTime
        print("[PerformanceTimer] {} è€—æ—¶: {:.3f}ç§’".format(self.name, elapsed))
        self.startTime = None

# ä½¿ç”¨ç¤ºä¾‹
timer = PerformanceTimer("åŠ è½½é…ç½®")
timer.Start()

# æ‰§è¡Œéœ€è¦è®¡æ—¶çš„ä»£ç 
config = self.LoadShopConfig()

timer.Stop()
```

**è¾“å‡ºç¤ºä¾‹**ï¼š
```
[PerformanceTimer] åŠ è½½é…ç½® è€—æ—¶: 0.025ç§’
```

---

### 4.3 ä¸Šä¸‹æ–‡ç®¡ç†å™¨ç‰ˆæœ¬ï¼ˆPython 2.7å…¼å®¹ï¼‰

```python
# -*- coding: utf-8 -*-
import time

class Timer(object):
    """æ€§èƒ½è®¡æ—¶å™¨ï¼ˆæ”¯æŒwithè¯­å¥ï¼‰"""

    def __init__(self, name):
        self.name = name
        self.startTime = None

    def __enter__(self):
        self.startTime = time.time()
        return self

    def __exit__(self, exc_type, exc_val, exc_tb):
        elapsed = time.time() - self.startTime
        print("[Timer] {} è€—æ—¶: {:.3f}ç§’".format(self.name, elapsed))

# ä½¿ç”¨ç¤ºä¾‹
with Timer("æ‰¹é‡å¤„ç†æˆå°±"):
    for playerId in playerList:
        self.ProcessAchievements(playerId)
```

**è¾“å‡ºç¤ºä¾‹**ï¼š
```
[Timer] æ‰¹é‡å¤„ç†æˆå°± è€—æ—¶: 0.150ç§’
```

---

## 5. è¿œç¨‹è°ƒè¯•æŠ€å·§

### 5.1 ä»€ä¹ˆæ˜¯è¿œç¨‹è°ƒè¯•ï¼Ÿ

**å®šä¹‰**ï¼šå°†IDEè°ƒè¯•å™¨ï¼ˆå¦‚VSCodeã€PyCharmï¼‰è¿æ¥åˆ°è¿è¡Œä¸­çš„MinecraftæœåŠ¡å™¨ï¼Œæ”¯æŒæ–­ç‚¹ã€å•æ­¥æ‰§è¡Œç­‰åŠŸèƒ½ã€‚

**ä¼˜åŠ¿**ï¼š
- âœ… å¯ä»¥è®¾ç½®æ–­ç‚¹ï¼Œæš‚åœä»£ç æ‰§è¡Œ
- âœ… å¯ä»¥å•æ­¥æ‰§è¡Œï¼ŒæŸ¥çœ‹å˜é‡å€¼
- âœ… æ¯”æ—¥å¿—è¾“å‡ºæ›´é«˜æ•ˆ

**åŠ£åŠ¿**ï¼š
- âŒ é…ç½®å¤æ‚ï¼ˆéœ€è¦IDEæ”¯æŒï¼‰
- âŒ å¯èƒ½å½±å“æ¸¸æˆæ€§èƒ½

---

### 5.2 è¿œç¨‹è°ƒè¯•é…ç½®ï¼ˆVSCode + ptvsdï¼‰

#### æ­¥éª¤1ï¼šå®‰è£…ptvsdåº“

```bash
pip install ptvsd
```

---

#### æ­¥éª¤2ï¼šåœ¨MODä»£ç ä¸­å¯ç”¨è°ƒè¯•æœåŠ¡å™¨

```python
# -*- coding: utf-8 -*-
"""
å¯ç”¨è¿œç¨‹è°ƒè¯•ï¼ˆä»…å¼€å‘ç¯å¢ƒï¼‰
"""

import mod.server.extraServerApi as serverApi

ServerSystem = serverApi.GetServerSystemCls()

class MyServerSystem(ServerSystem):
    def __init__(self, namespace, systemName):
        super(MyServerSystem, self).__init__(namespace, systemName)

        # âš ï¸ ä»…åœ¨å¼€å‘ç¯å¢ƒå¯ç”¨è¿œç¨‹è°ƒè¯•
        if self._IsDevMode():
            self._EnableRemoteDebug()

    def _IsDevMode(self):
        """æ£€æŸ¥æ˜¯å¦ä¸ºå¼€å‘æ¨¡å¼"""
        # å¯ä»¥é€šè¿‡é…ç½®æ–‡ä»¶æˆ–ç¯å¢ƒå˜é‡åˆ¤æ–­
        return True  # ç¤ºä¾‹ï¼šå§‹ç»ˆå¼€å¯

    def _EnableRemoteDebug(self):
        """å¯ç”¨è¿œç¨‹è°ƒè¯•"""
        try:
            import ptvsd

            # ç›‘å¬5678ç«¯å£ï¼ˆå¯è‡ªå®šä¹‰ï¼‰
            ptvsd.enable_attach(address=('0.0.0.0', 5678))
            print("[RemoteDebug] è¿œç¨‹è°ƒè¯•å·²å¯ç”¨ï¼Œç«¯å£: 5678")
            print("[RemoteDebug] è¯·åœ¨IDEä¸­é™„åŠ è°ƒè¯•å™¨")

            # å¯é€‰ï¼šç­‰å¾…è°ƒè¯•å™¨è¿æ¥åå†ç»§ç»­æ‰§è¡Œ
            # ptvsd.wait_for_attach()

        except ImportError:
            print("[RemoteDebug] æœªå®‰è£…ptvsdåº“ï¼Œè·³è¿‡è¿œç¨‹è°ƒè¯•")
        except Exception as e:
            print("[RemoteDebug] å¯ç”¨è¿œç¨‹è°ƒè¯•å¤±è´¥:", e)
```

---

#### æ­¥éª¤3ï¼šåœ¨VSCodeä¸­é…ç½®è°ƒè¯•

åˆ›å»º`.vscode/launch.json`ï¼š

```json
{
  "version": "0.2.0",
  "configurations": [
    {
      "name": "Python: é™„åŠ åˆ°MinecraftæœåŠ¡å™¨",
      "type": "python",
      "request": "attach",
      "connect": {
        "host": "localhost",
        "port": 5678
      },
      "pathMappings": [
        {
          "localRoot": "${workspaceFolder}/behavior_packs/YourMod",
          "remoteRoot": "/path/to/minecraft/behavior_packs/YourMod"
        }
      ]
    }
  ]
}
```

---

#### æ­¥éª¤4ï¼šå¼€å§‹è°ƒè¯•

1. å¯åŠ¨MinecraftæœåŠ¡å™¨ï¼ˆä¼šç›‘å¬5678ç«¯å£ï¼‰
2. åœ¨VSCodeä¸­æŒ‰F5ï¼Œé€‰æ‹©"Python: é™„åŠ åˆ°MinecraftæœåŠ¡å™¨"
3. åœ¨ä»£ç ä¸­è®¾ç½®æ–­ç‚¹
4. è§¦å‘æ–­ç‚¹ï¼ˆå¦‚ç©å®¶åŠ å…¥æœåŠ¡å™¨ï¼‰

---

### 5.3 è¿œç¨‹è°ƒè¯•æ³¨æ„äº‹é¡¹

**æ³¨æ„1ï¼šä»…åœ¨å¼€å‘ç¯å¢ƒå¯ç”¨**

```python
# âœ… ä½¿ç”¨é…ç½®å¼€å…³
if config.get('debug_mode', False):
    self._EnableRemoteDebug()

# âŒ ç”Ÿäº§ç¯å¢ƒä¸è¦å¯ç”¨
# self._EnableRemoteDebug()  # ä¼šå¯¼è‡´ç«¯å£æ³„éœ²
```

---

**æ³¨æ„2ï¼šæ–­ç‚¹ä¼šé˜»å¡æ¸¸æˆ**

- å½“ä»£ç æš‚åœåœ¨æ–­ç‚¹æ—¶ï¼Œæ•´ä¸ªæœåŠ¡å™¨ä¼šåœæ­¢
- ä»…ç”¨äºå•äººæµ‹è¯•ï¼Œä¸è¦åœ¨å¤šäººæœåŠ¡å™¨ä½¿ç”¨

---

**æ³¨æ„3ï¼šPython 2.7å…¼å®¹æ€§**

- ptvsdæ—§ç‰ˆæœ¬æ”¯æŒPython 2.7
- å®‰è£…å‘½ä»¤ï¼š`pip install ptvsd==4.3.2`

---

## 6. æ€§èƒ½åˆ†æå·¥å…·

### 6.1 æ€§èƒ½ç“¶é¢ˆæ£€æµ‹

**åœºæ™¯**ï¼šæ¸¸æˆå¡é¡¿ï¼Œéœ€è¦æ‰¾å‡ºå“ªä¸ªå‡½æ•°è€—æ—¶æœ€å¤š

#### æ–¹æ³•1ï¼šæ‰‹åŠ¨è®¡æ—¶

```python
import time

class PerformanceProfiler:
    """æ€§èƒ½åˆ†æå™¨"""

    def __init__(self):
        # è®°å½•æ¯ä¸ªå‡½æ•°çš„è€—æ—¶
        self.timings = {}

    def Profile(self, funcName):
        """è£…é¥°å™¨ï¼šè‡ªåŠ¨è®°å½•å‡½æ•°è€—æ—¶"""
        def Decorator(func):
            def Wrapper(*args, **kwargs):
                startTime = time.time()
                result = func(*args, **kwargs)
                elapsed = time.time() - startTime

                # ç´¯è®¡è€—æ—¶
                if funcName not in self.timings:
                    self.timings[funcName] = {'count': 0, 'total': 0.0}

                self.timings[funcName]['count'] += 1
                self.timings[funcName]['total'] += elapsed

                return result
            return Wrapper
        return Decorator

    def PrintReport(self):
        """è¾“å‡ºæ€§èƒ½æŠ¥å‘Š"""
        print("===== æ€§èƒ½åˆ†ææŠ¥å‘Š =====")
        for funcName, stats in sorted(self.timings.items(), key=lambda x: x[1]['total'], reverse=True):
            avgTime = stats['total'] / stats['count']
            print("{}: æ€»è€—æ—¶{:.3f}ç§’, è°ƒç”¨{}æ¬¡, å¹³å‡{:.3f}ç§’".format(
                funcName, stats['total'], stats['count'], avgTime
            ))
        print("========================")

# åˆ›å»ºå…¨å±€åˆ†æå™¨
profiler = PerformanceProfiler()

# ä½¿ç”¨ç¤ºä¾‹
@profiler.Profile('ProcessAchievements')
def ProcessAchievements(self, playerId):
    # ä¸šåŠ¡é€»è¾‘
    time.sleep(0.01)  # æ¨¡æ‹Ÿè€—æ—¶æ“ä½œ

# å®šæœŸè¾“å‡ºæŠ¥å‘Š
def OnServerTick(self):
    # æ¯100 tickè¾“å‡ºä¸€æ¬¡æŠ¥å‘Š
    if self.tickCount % 100 == 0:
        profiler.PrintReport()
```

**è¾“å‡ºç¤ºä¾‹**ï¼š
```
===== æ€§èƒ½åˆ†ææŠ¥å‘Š =====
ProcessAchievements: æ€»è€—æ—¶1.250ç§’, è°ƒç”¨100æ¬¡, å¹³å‡0.013ç§’
UpdatePlayerData: æ€»è€—æ—¶0.500ç§’, è°ƒç”¨200æ¬¡, å¹³å‡0.003ç§’
========================
```

---

### 6.2 TPSç›‘æ§

**TPSï¼ˆTicks Per Secondï¼‰**ï¼šæœåŠ¡å™¨æ¯ç§’æ‰§è¡Œçš„æ¸¸æˆåˆ»æ•°

- æ­£å¸¸å€¼ï¼š20 TPS
- å¡é¡¿ï¼š<20 TPS

#### å®ç°TPSç›‘æ§

```python
# -*- coding: utf-8 -*-
import time

class TPSMonitor:
    """TPSç›‘æ§å™¨"""

    def __init__(self):
        self.lastCheckTime = time.time()
        self.tickCount = 0
        self.currentTPS = 20.0

    def OnTick(self):
        """æ¯ä¸ªTickè°ƒç”¨ä¸€æ¬¡"""
        self.tickCount += 1

        # æ¯ç§’ç»Ÿè®¡ä¸€æ¬¡TPS
        now = time.time()
        elapsed = now - self.lastCheckTime

        if elapsed >= 1.0:
            self.currentTPS = self.tickCount / elapsed
            print("[TPS] å½“å‰TPS: {:.2f}".format(self.currentTPS))

            # é‡ç½®è®¡æ•°å™¨
            self.tickCount = 0
            self.lastCheckTime = now

    def GetCurrentTPS(self):
        """è·å–å½“å‰TPS"""
        return self.currentTPS

# åœ¨ServerSystemä¸­ä½¿ç”¨
class MyServerSystem(ServerSystem):
    def __init__(self, namespace, systemName):
        super(MyServerSystem, self).__init__(namespace, systemName)
        self.tpsMonitor = TPSMonitor()

    def Update(self):
        """æ¯Tickæ‰§è¡Œä¸€æ¬¡"""
        self.tpsMonitor.OnTick()
```

---

## 7. å¸¸è§é—®é¢˜FAQ

### Q1: æ—¥å¿—è¾“å‡ºä¸­æ–‡ä¹±ç æ€ä¹ˆåŠï¼Ÿ

**ç­”æ¡ˆ**ï¼šç¡®ä¿æ–‡ä»¶ç¼–ç ä¸ºUTF-8

```python
# æ–‡ä»¶å¼€å¤´æ·»åŠ ç¼–ç å£°æ˜
# -*- coding: utf-8 -*-

# æ–‡ä»¶æ“ä½œæŒ‡å®šç¼–ç 
with open(logPath, 'a', encoding='utf-8') as f:
    f.write(message)
```

---

### Q2: å¦‚ä½•åœ¨ç”Ÿäº§ç¯å¢ƒç¦ç”¨è°ƒè¯•æ—¥å¿—ï¼Ÿ

**ç­”æ¡ˆ**ï¼šä½¿ç”¨æ—¥å¿—çº§åˆ«æ§åˆ¶

```python
# å¼€å‘ç¯å¢ƒ
logger.SetLevel(LogManager.DEBUG)  # è¾“å‡ºæ‰€æœ‰æ—¥å¿—

# ç”Ÿäº§ç¯å¢ƒ
logger.SetLevel(LogManager.INFO)   # ä»…è¾“å‡ºINFOåŠä»¥ä¸Šçº§åˆ«
```

---

### Q3: å¦‚ä½•æŸ¥çœ‹MODæ˜¯å¦æ­£å¸¸åŠ è½½ï¼Ÿ

**ç­”æ¡ˆ**ï¼šåœ¨`__init__`æ–¹æ³•ä¸­è¾“å‡ºæ—¥å¿—

```python
def __init__(self, namespace, systemName):
    super(MyServerSystem, self).__init__(namespace, systemName)
    print("[MyMod] Systemå·²åŠ è½½:", systemName)
```

å¦‚æœæ§åˆ¶å°æ²¡æœ‰è¾“å‡ºï¼Œè¯´æ˜MODæœªæ­£ç¡®åŠ è½½ã€‚

---

### Q4: è¿œç¨‹è°ƒè¯•æ— æ³•è¿æ¥ï¼Ÿ

**æ£€æŸ¥æ¸…å•**ï¼š
- âœ… æ˜¯å¦å®‰è£…äº†ptvsdï¼Ÿï¼ˆ`pip install ptvsd==4.3.2`ï¼‰
- âœ… ç«¯å£æ˜¯å¦è¢«å ç”¨ï¼Ÿï¼ˆå°è¯•æ›´æ¢ç«¯å£ï¼‰
- âœ… é˜²ç«å¢™æ˜¯å¦é˜»æ­¢ï¼Ÿï¼ˆå…³é—­é˜²ç«å¢™æˆ–å¼€æ”¾ç«¯å£ï¼‰
- âœ… IDEé…ç½®æ˜¯å¦æ­£ç¡®ï¼Ÿï¼ˆæ£€æŸ¥launch.jsonï¼‰

---

### Q5: å¦‚ä½•è°ƒè¯•å®¢æˆ·ç«¯ä»£ç ï¼Ÿ

**ç­”æ¡ˆ**ï¼šå®¢æˆ·ç«¯æ—¥å¿—æŸ¥çœ‹æ–¹å¼

```python
# å®¢æˆ·ç«¯æ—¥å¿—è¾“å‡º
print("[ClientDebug] æ¶ˆæ¯å†…å®¹")

# æ—¥å¿—æ–‡ä»¶ä½ç½®
# Windows: C:/Users/YourName/AppData/Local/Packages/.../LocalState/logs/latest.log
# ä½¿ç”¨tail -fç›‘æ§æ—¥å¿—å˜åŒ–
```

---

## ğŸ“š æ¨èé˜…è¯»

å®Œæˆæœ¬æ–‡æ¡£å­¦ä¹ åï¼Œå»ºè®®ç»§ç»­é˜…è¯»ï¼š

- [æ€§èƒ½ä¼˜åŒ–å®Œæ•´æŒ‡å—.md](æ€§èƒ½ä¼˜åŒ–å®Œæ•´æŒ‡å—.md) - æ·±å…¥çš„æ€§èƒ½åˆ†ææŠ€å·§
- [å¼€å‘è§„èŒƒ.md](å¼€å‘è§„èŒƒ.md) - é¿å…å¸¸è§é”™è¯¯
- [é—®é¢˜æ’æŸ¥.md](é—®é¢˜æ’æŸ¥.md) - å¸¸è§é—®é¢˜è§£å†³æ–¹æ¡ˆ

---

**æ–‡æ¡£ç‰ˆæœ¬**: 1.0
**æœ€åæ›´æ–°**: 2025-01-11
**è´¡çŒ®è€…**: NeteaseMod-Claudeå·¥ä½œæµå›¢é˜Ÿ

**çŸ¥è¯†æ¥æºå£°æ˜**ï¼š
æœ¬æ–‡æ¡£åŸºäºä»¥ä¸‹åˆæ³•æ¥æºç¼–å†™ï¼š
- âœ… MODSDKå®˜æ–¹å¼€å‘æ–‡æ¡£
- âœ… MinecraftåŸºå²©ç‰ˆå‘½ä»¤å‚è€ƒ
- âœ… Python 2.7æ ‡å‡†åº“æ–‡æ¡£ï¼ˆtimeã€tracebackç­‰ï¼‰
- âœ… é€šç”¨è½¯ä»¶å·¥ç¨‹è°ƒè¯•æœ€ä½³å®è·µï¼ˆå¦‚æ—¥å¿—åˆ†çº§ã€æ€§èƒ½åˆ†æç­‰ï¼‰

æ‰€æœ‰ä»£ç ç¤ºä¾‹å‡ä¸ºç‹¬ç«‹è®¾è®¡ï¼Œæœªå¼•ç”¨ä»»ä½•éå®˜æ–¹ä»£ç å®ç°ã€‚
