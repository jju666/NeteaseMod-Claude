# /explain-why - æ·±åº¦è§£é‡Šå¼€å‘è§„èŒƒåŸç†

## å‘½ä»¤è¯´æ˜

å½“ä½ å¯¹æŸæ¡å¼€å‘è§„èŒƒæ„Ÿåˆ°å›°æƒ‘ï¼Œæˆ–æƒ³æ·±å…¥äº†è§£"ä¸ºä»€ä¹ˆè¦è¿™æ ·åš"æ—¶ï¼Œä½¿ç”¨æ­¤å‘½ä»¤ã€‚

## æ‰§è¡Œæµç¨‹

### ç¬¬1æ­¥ï¼šç†è§£ç”¨æˆ·é—®é¢˜

ç”¨æˆ·ä¼šæå‡ºç±»ä¼¼ä»¥ä¸‹çš„é—®é¢˜ï¼š
- "ä¸ºä»€ä¹ˆå¿…é¡»åŒç«¯éš”ç¦»ï¼Ÿ"
- "ä¸ºä»€ä¹ˆ`__init__`ä¸­ä¸èƒ½è°ƒç”¨APIï¼Ÿ"
- "ä¸ºä»€ä¹ˆè¦ä½¿ç”¨RegisterViewï¼Ÿ"
- "ä¸ºä»€ä¹ˆæœåŠ¡å™¨æƒå¨å¾ˆé‡è¦ï¼Ÿ"

### ç¬¬2æ­¥ï¼šæŸ¥é˜…æ ¸å¿ƒæ–‡æ¡£

æ ¹æ®é—®é¢˜ç±»å‹ï¼ŒæŸ¥é˜…å¯¹åº”çš„æ ¸å¿ƒæ–‡æ¡£ï¼š

| é—®é¢˜ç±»å‹ | æŸ¥é˜…æ–‡æ¡£ | æŸ¥æ‰¾ç« èŠ‚ |
|---------|---------|---------|
| åŒç«¯éš”ç¦»ã€`__init__`é™åˆ¶ | `../../markdown/core/å¼€å‘è§„èŒƒ.md` æˆ– `.claude/core-docs/å¼€å‘è§„èŒƒ.md` | CRITICALè§„èŒƒç« èŠ‚ |
| ECSæ¶æ„ã€System/Componentè®¾è®¡ | `../../markdown/core/æ·±å…¥ç†è§£ECSæ¶æ„.md` æˆ– `.claude/core-docs/æ·±å…¥ç†è§£ECSæ¶æ„.md` | å¯¹åº”ç« èŠ‚ |
| æ€§èƒ½ä¼˜åŒ–ã€RegisterView | `../../markdown/core/æ€§èƒ½ä¼˜åŒ–å®Œæ•´æŒ‡å—.md` æˆ– `.claude/core-docs/æ€§èƒ½ä¼˜åŒ–å®Œæ•´æŒ‡å—.md` | RegisterViewä¼˜åŒ–ç« èŠ‚ |
| äº‹ä»¶ç³»ç»Ÿ | `../../markdown/core/äº‹ä»¶ç³»ç»Ÿå®Œæ•´å‚è€ƒ.md` æˆ– `.claude/core-docs/äº‹ä»¶ç³»ç»Ÿå®Œæ•´å‚è€ƒ.md` | äº‹ä»¶ä¼˜å…ˆçº§ã€æ€§èƒ½ä¼˜åŒ– |
| ç½‘ç»œé€šä¿¡ | `../../markdown/core/ç½‘ç»œæ¶æ„ä¸é€šä¿¡.md` æˆ– `.claude/core-docs/ç½‘ç»œæ¶æ„ä¸é€šä¿¡.md` | RPCé€šä¿¡ã€æ•°æ®åŒæ­¥ |

**âš ï¸ æ™ºèƒ½é™çº§ç­–ç•¥**ï¼š
1. ä¼˜å…ˆå°è¯•è¯»å– `../../markdown/core/xxx.md`ï¼ˆé¡¹ç›®å®šåˆ¶ç‰ˆï¼‰
2. å¦‚æœä¸å­˜åœ¨ï¼Œé™çº§è¯»å– `.claude/core-docs/xxx.md`ï¼ˆä¸Šæ¸¸åŸºçº¿ï¼Œè½¯è¿æ¥ï¼‰

### ç¬¬3æ­¥ï¼šæå–æ ¸å¿ƒåŸç†

ä»æ–‡æ¡£ä¸­æå–ï¼š
1. **è§„èŒƒå†…å®¹**ï¼ˆWhatï¼‰
2. **åº•å±‚åŸç†**ï¼ˆWhyï¼‰- é‡ç‚¹å…³æ³¨"ä¸ºä»€ä¹ˆé‡è¦"ç« èŠ‚
3. **é”™è¯¯ç¤ºä¾‹**ï¼ˆWhat happens if notï¼‰
4. **æ­£ç¡®åšæ³•**ï¼ˆHowï¼‰

### ç¬¬4æ­¥ï¼šç»“æ„åŒ–è¾“å‡º

ä½¿ç”¨ä»¥ä¸‹æ ¼å¼è¾“å‡ºè§£é‡Šï¼š

```markdown
## ğŸ“– è§„èŒƒè¯´æ˜

{è§„èŒƒçš„å®Œæ•´æè¿°}

---

## ğŸ” æ·±å±‚åŸç†

### ä¸ºä»€ä¹ˆè¿™æ ·è®¾è®¡ï¼Ÿ

{ä»æ¶æ„å±‚é¢è§£é‡ŠåŸå› ï¼Œå¦‚ï¼š}
- å¼•æ“çš„è¿è¡Œæœºåˆ¶å†³å®šäº†...
- ECSæ¶æ„çš„æ ¸å¿ƒç†å¿µæ˜¯...
- ç½‘ç»œé€šä¿¡çš„ç‰¹æ€§è¦æ±‚...

### ä¸éµå®ˆä¼šå¯¼è‡´ä»€ä¹ˆé—®é¢˜ï¼Ÿ

{å…·ä½“çš„é”™è¯¯åœºæ™¯å’Œåæœ}

#### é”™è¯¯ç¤ºä¾‹ï¼š
\`\`\`python
# é”™è¯¯ä»£ç ç¤ºä¾‹
\`\`\`

**åæœ**ï¼š{å…·ä½“çš„è¿è¡Œæ—¶é”™è¯¯æˆ–æ€§èƒ½é—®é¢˜}

---

## âœ… æ­£ç¡®åšæ³•

\`\`\`python
# æ­£ç¡®ä»£ç ç¤ºä¾‹
\`\`\`

**åŸå› **ï¼š{ä¸ºä»€ä¹ˆè¿™æ ·åšæ˜¯æ­£ç¡®çš„}

---

## ğŸ“š æ‰©å±•é˜…è¯»

- å‚è€ƒæ–‡æ¡£ï¼š{ç›¸å…³æ–‡æ¡£è·¯å¾„}
- ç›¸å…³è§„èŒƒï¼š{å…¶ä»–ç›¸å…³çš„CRITICALè§„èŒƒ}
- å®æˆ˜æ¡ˆä¾‹ï¼š{ä¸šåŠ¡ç³»ç»Ÿå®ç°æ¡ˆä¾‹ä¸­çš„ç›¸å…³å†…å®¹}
```

---

## ç¤ºä¾‹å¯¹è¯

### ç¤ºä¾‹1ï¼šåŒç«¯éš”ç¦»è§„èŒƒ

**ç”¨æˆ·**ï¼š
```
/explain-why ä¸ºä»€ä¹ˆå¿…é¡»åŒç«¯éš”ç¦»ï¼Ÿ
```

**AIè¾“å‡º**ï¼š

````markdown
## ğŸ“– è§„èŒƒè¯´æ˜

**åŒç«¯éš”ç¦»ï¼ˆClient-Server Separationï¼‰**æ˜¯MODSDKå¼€å‘çš„æ ¸å¿ƒè§„èŒƒï¼š

- âœ… å®¢æˆ·ç«¯Systemï¼ˆ`ClientSystem`ï¼‰ä»…è´Ÿè´£UIå±•ç¤ºå’Œæœ¬åœ°æ•ˆæœ
- âœ… æœåŠ¡ç«¯Systemï¼ˆ`ServerSystem`ï¼‰è´Ÿè´£æ‰€æœ‰ä¸šåŠ¡é€»è¾‘å’Œæ•°æ®ç®¡ç†
- âŒ å®¢æˆ·ç«¯Systemä¸å¾—åŒ…å«ä¸šåŠ¡é€»è¾‘
- âŒ æœåŠ¡ç«¯Systemä¸å¾—æ“ä½œUI

---

## ğŸ” æ·±å±‚åŸç†

### ä¸ºä»€ä¹ˆè¿™æ ·è®¾è®¡ï¼Ÿ

#### 1. ç½‘ç»œæ¶æ„çš„æœ¬è´¨ç‰¹æ€§

Minecrafté‡‡ç”¨**å®¢æˆ·ç«¯-æœåŠ¡å™¨æ¶æ„ï¼ˆC/Sæ¶æ„ï¼‰**ï¼š

```
å®¢æˆ·ç«¯1 â†â†’ æœåŠ¡å™¨ â†â†’ å®¢æˆ·ç«¯2
  (æ˜¾ç¤º)    (æƒå¨)    (æ˜¾ç¤º)
```

- **æœåŠ¡å™¨æ˜¯å”¯ä¸€çš„æƒå¨æ¥æº**ï¼šæ‰€æœ‰ç©å®¶çœ‹åˆ°çš„æ¸¸æˆçŠ¶æ€å¿…é¡»ä¸€è‡´
- **å®¢æˆ·ç«¯ä»…ç”¨äºå±•ç¤º**ï¼šæ¯ä¸ªç©å®¶çš„å®¢æˆ·ç«¯åªè´Ÿè´£æ¸²æŸ“è‡ªå·±çš„è§†è§’

#### 2. é˜²æ­¢æ•°æ®ä¸åŒæ­¥

å¦‚æœå®¢æˆ·ç«¯åŒ…å«ä¸šåŠ¡é€»è¾‘ï¼š

```python
# âŒ é”™è¯¯ï¼šå®¢æˆ·ç«¯ä¿®æ”¹ç©å®¶é‡‘å¸
class ShopClientSystem(ClientSystem):
    def BuyItem(self, playerId, price):
        # ç›´æ¥ä¿®æ”¹æœ¬åœ°æ•°æ®
        self.playerMoney -= price  # ä»…æœ¬åœ°ç”Ÿæ•ˆï¼
        # å…¶ä»–ç©å®¶çœ‹ä¸åˆ°ï¼ŒæœåŠ¡å™¨ä¹Ÿä¸çŸ¥é“
```

**åæœ**ï¼š
- å®¢æˆ·ç«¯Aè®¤ä¸ºè‡ªå·±æœ‰1000é‡‘å¸
- æœåŠ¡å™¨è®¤ä¸ºå®¢æˆ·ç«¯Aæœ‰500é‡‘å¸
- å®¢æˆ·ç«¯BæŸ¥è¯¢æ—¶æ˜¾ç¤º500é‡‘å¸
- **æ•°æ®ä¸ä¸€è‡´** â†’ æ¸¸æˆé€»è¾‘æ··ä¹±

#### 3. é˜²æ­¢ä½œå¼Š

å®¢æˆ·ç«¯ä»£ç å¯ä»¥è¢«ç©å®¶ä¿®æ”¹ï¼š

```python
# âŒ å±é™©ï¼šå®¢æˆ·ç«¯éªŒè¯ä»·æ ¼
class ShopClientSystem(ClientSystem):
    def BuyItem(self, itemId):
        price = self.GetItemPrice(itemId)  # å®¢æˆ·ç«¯è¯»å–ä»·æ ¼
        # ç©å®¶å¯ä»¥ä¿®æ”¹å®¢æˆ·ç«¯ä»£ç ï¼Œå°†ä»·æ ¼æ”¹ä¸º0ï¼
        if self.playerMoney >= price:
            self.NotifyToServer('BuyItem', {'itemId': itemId})
```

**ä½œå¼Šæ–¹å¼**ï¼šç©å®¶ä¿®æ”¹å®¢æˆ·ç«¯MODæ–‡ä»¶ï¼Œå°†æ‰€æœ‰å•†å“ä»·æ ¼æ”¹ä¸º0

---

### ä¸éµå®ˆä¼šå¯¼è‡´ä»€ä¹ˆé—®é¢˜ï¼Ÿ

#### é—®é¢˜1ï¼šæ•°æ®ä¸åŒæ­¥

**é”™è¯¯ä»£ç **ï¼š
```python
# å®¢æˆ·ç«¯System
class InventoryClientSystem(ClientSystem):
    def AddItem(self, itemName, count):
        # âŒ å®¢æˆ·ç«¯ç›´æ¥ä¿®æ”¹èƒŒåŒ…
        self.inventory.append({'item': itemName, 'count': count})
        self.UpdateUI()  # ä»…æœ¬åœ°UIæ›´æ–°
```

**åæœ**ï¼š
- å®¢æˆ·ç«¯æ˜¾ç¤ºèƒŒåŒ…æœ‰"é’»çŸ³å‰‘"
- æœåŠ¡å™¨æ•°æ®ä¸­æ²¡æœ‰"é’»çŸ³å‰‘"
- ç©å®¶é‡æ–°ç™»å½•å"é’»çŸ³å‰‘"æ¶ˆå¤±ï¼ˆä»¥æœåŠ¡å™¨æ•°æ®ä¸ºå‡†ï¼‰

#### é—®é¢˜2ï¼šä½œå¼Šæ¼æ´

**é”™è¯¯ä»£ç **ï¼š
```python
# å®¢æˆ·ç«¯System
class CombatClientSystem(ClientSystem):
    def Attack(self, targetId):
        # âŒ å®¢æˆ·ç«¯è®¡ç®—ä¼¤å®³
        damage = self.CalculateDamage()  # ç©å®¶å¯ä¿®æ”¹æ­¤å‡½æ•°è¿”å›9999
        self.NotifyToServer('Attack', {'targetId': targetId, 'damage': damage})
```

**åæœ**ï¼šç©å®¶å¯ä»¥ä¿®æ”¹å®¢æˆ·ç«¯ä»£ç ï¼Œé€ æˆ999999ä¼¤å®³ç§’æ€æ‰€æœ‰æ€ªç‰©

---

## âœ… æ­£ç¡®åšæ³•

### æ­£ç¡®çš„åŒç«¯åä½œæ¨¡å¼

```python
# ========== å®¢æˆ·ç«¯Systemï¼ˆä»…UIäº¤äº’ï¼‰ ==========
class ShopClientSystem(ClientSystem):
    def OnBuyButtonClick(self, itemId):
        """ç©å®¶ç‚¹å‡»è´­ä¹°æŒ‰é’®"""
        playerId = clientApi.GetLocalPlayerId()

        # ä»…å‘é€è¯·æ±‚ï¼Œä¸åŒ…å«ä»»ä½•ä¸šåŠ¡é€»è¾‘
        self.NotifyToServer('PurchaseRequestEvent', {
            'playerId': playerId,
            'itemId': itemId
        })

        # æ˜¾ç¤º"è´­ä¹°ä¸­..."æç¤º
        self.ShowLoadingUI()

    def OnPurchaseResult(self, args):
        """æ¥æ”¶æœåŠ¡ç«¯ç»“æœ"""
        if args['success']:
            self.ShowSuccessMessage(args['message'])
            self.UpdateBalanceUI(args['newBalance'])
        else:
            self.ShowErrorMessage(args['message'])

# ========== æœåŠ¡ç«¯Systemï¼ˆæ‰€æœ‰ä¸šåŠ¡é€»è¾‘ï¼‰ ==========
class ShopServerSystem(ServerSystem):
    def OnPurchaseRequest(self, args):
        """å¤„ç†è´­ä¹°è¯·æ±‚"""
        playerId = args['playerId']
        itemId = args['itemId']

        # æœåŠ¡ç«¯éªŒè¯ï¼šä»·æ ¼ã€ä½™é¢ã€åº“å­˜
        itemConfig = self.GetItemConfig(itemId)  # æœåŠ¡ç«¯è¯»å–é…ç½®
        price = itemConfig['price']

        playerBalance = self.GetPlayerBalance(playerId)
        if playerBalance < price:
            # ä½™é¢ä¸è¶³ï¼Œé€šçŸ¥å®¢æˆ·ç«¯
            self.NotifyToClient(playerId, 'PurchaseResultEvent', {
                'success': False,
                'message': 'ä½™é¢ä¸è¶³'
            })
            return

        # æ‰£é™¤é‡‘å¸
        newBalance = playerBalance - price
        self.SetPlayerBalance(playerId, newBalance)

        # å‘æ”¾é“å…·
        self.GiveItemToPlayer(playerId, itemConfig['rewardItem'])

        # é€šçŸ¥å®¢æˆ·ç«¯æˆåŠŸ
        self.NotifyToClient(playerId, 'PurchaseResultEvent', {
            'success': True,
            'message': 'è´­ä¹°æˆåŠŸ',
            'newBalance': newBalance
        })
```

**ä¸ºä»€ä¹ˆè¿™æ ·åšæ˜¯æ­£ç¡®çš„**ï¼š
1. âœ… **æœåŠ¡å™¨æƒå¨**ï¼šä»·æ ¼ã€ä½™é¢ã€åº“å­˜å…¨éƒ¨åœ¨æœåŠ¡ç«¯éªŒè¯
2. âœ… **é˜²ä½œå¼Š**ï¼šå®¢æˆ·ç«¯æ— æ³•ä¿®æ”¹ä»·æ ¼æˆ–ä½™é¢
3. âœ… **æ•°æ®ä¸€è‡´**ï¼šæ‰€æœ‰ç©å®¶çœ‹åˆ°çš„æ•°æ®éƒ½æ¥è‡ªæœåŠ¡å™¨
4. âœ… **å®¢æˆ·ç«¯è½»é‡**ï¼šä»…è´Ÿè´£UIäº¤äº’ï¼Œæ€§èƒ½å¥½

---

## ğŸ“š æ‰©å±•é˜…è¯»

### ç›¸å…³æ–‡æ¡£
- [å¼€å‘è§„èŒƒ.md - CRITICALè§„èŒƒç¬¬1æ¡](../../markdown/core/å¼€å‘è§„èŒƒ.md#2-criticalè§„èŒƒ-å¿…è¯»)
- [ç½‘ç»œæ¶æ„ä¸é€šä¿¡.md - åŒç«¯é€šä¿¡æ¨¡å¼](../../markdown/core/ç½‘ç»œæ¶æ„ä¸é€šä¿¡.md#2-åŒç«¯é€šä¿¡æ¨¡å¼)
- [ä¸šåŠ¡ç³»ç»Ÿå®ç°æ¡ˆä¾‹.md - å•†åŸç³»ç»Ÿæ¡ˆä¾‹](../../markdown/core/ä¸šåŠ¡ç³»ç»Ÿå®ç°æ¡ˆä¾‹.md#2-æ¡ˆä¾‹1å•†åŸç³»ç»Ÿ)

### ç›¸å…³è§„èŒƒ
- CRITICALè§„èŒƒç¬¬3æ¡ï¼š`__init__`ä¸­ä¸èƒ½è°ƒç”¨APIï¼ˆåŒæ ·æ˜¯æ¶æ„é™åˆ¶ï¼‰
- CRITICALè§„èŒƒç¬¬6æ¡ï¼šæœåŠ¡å™¨æƒå¨éªŒè¯ï¼ˆåŒç«¯éš”ç¦»çš„åº”ç”¨ï¼‰

### å®˜æ–¹æ–‡æ¡£å‚è€ƒ
- MODSDKå¼€å‘æ–‡æ¡£ - SystemåŸºç¡€
- MinecraftåŸºå²©ç‰ˆå¤šäººæ¸¸æˆæ¶æ„

````

---

### ç¤ºä¾‹2ï¼šRegisterViewæ€§èƒ½ä¼˜åŒ–

**ç”¨æˆ·**ï¼š
```
/explain-why ä¸ºä»€ä¹ˆè¦ä½¿ç”¨RegisterViewï¼Ÿ
```

**AIè¾“å‡º**ï¼š

````markdown
## ğŸ“– è§„èŒƒè¯´æ˜

**RegisterViewï¼ˆç»„ä»¶è¿‡æ»¤æœºåˆ¶ï¼‰**æ˜¯Systemæ€§èƒ½ä¼˜åŒ–çš„æ ¸å¿ƒAPIï¼š

```python
# Systemçš„Updateæ–¹æ³•ä¼šå¯¹æ‰€æœ‰Entityæ‰§è¡Œ
def Update(self):
    for entity in allEntities:
        # å¤„ç†é€»è¾‘
```

**ä½¿ç”¨RegisterViewå**ï¼š

```python
# ä»…å¯¹åŒ…å«ç‰¹å®šComponentçš„Entityæ‰§è¡Œ
self.RegisterView(namespace, systemName, 'Minecraft:health', 'Minecraft:attack')

def OnViewEntityEnter(self, args):
    # ä»…å½“EntityåŒæ—¶æ‹¥æœ‰healthå’Œattackç»„ä»¶æ—¶è§¦å‘
```

---

## ğŸ” æ·±å±‚åŸç†

### ä¸ºä»€ä¹ˆéœ€è¦RegisterViewï¼Ÿ

#### 1. Entityæ•°é‡çš„è§„æ¨¡é—®é¢˜

ä¸€ä¸ªMinecraftä¸–ç•Œä¸­å¯èƒ½æœ‰ï¼š
- 100ä¸ªç©å®¶
- 500åªæ€ªç‰©
- 200ä¸ªæ‰è½ç‰©
- 100ä¸ªç®­çŸ¢
- **æ€»è®¡ï¼š900ä¸ªEntity**

å¦‚æœSystemçš„Updateæ–¹æ³•éå†æ‰€æœ‰Entityï¼š

```python
# âŒ ä¸ä½¿ç”¨RegisterView
def Update(self):
    allEntities = self.GetAllEntities()  # 900ä¸ªEntity
    for entityId in allEntities:
        # å‡è®¾ä½ çš„Systemåªå¤„ç†ç©å®¶
        if self.IsPlayer(entityId):  # 900æ¬¡æ£€æŸ¥
            # åªæœ‰100ä¸ªç©å®¶çœŸæ­£éœ€è¦å¤„ç†
            self.ProcessPlayer(entityId)
```

**æ€§èƒ½å¼€é”€**ï¼š
- æ¯Tickæ£€æŸ¥900ä¸ªEntity
- æœåŠ¡å™¨20 TPS â†’ æ¯ç§’18,000æ¬¡æ— æ•ˆæ£€æŸ¥
- **CPUèµ„æºæµªè´¹90%**

#### 2. RegisterViewçš„è¿‡æ»¤æœºåˆ¶

```python
# âœ… ä½¿ç”¨RegisterView
def __init__(self, namespace, systemName):
    super(VIPServerSystem, self).__init__(namespace, systemName)

    # æ³¨å†Œè¿‡æ»¤å™¨ï¼šä»…ç›‘å¬æ‹¥æœ‰"player"å’Œ"vip"ç»„ä»¶çš„Entity
    self.RegisterView(
        'YourModNamespace', 'VIPServerSystem',
        'Minecraft:player',  # å¿…é¡»æœ‰playerç»„ä»¶
        'YourMod:vip'        # å¿…é¡»æœ‰vipç»„ä»¶
    )

def OnViewEntityEnter(self, args):
    """Entityè¿›å…¥è§†å›¾ï¼ˆæ»¡è¶³è¿‡æ»¤æ¡ä»¶ï¼‰"""
    entityId = args['entityId']
    # ä»…å¤„ç†VIPç©å®¶ï¼Œå…¶ä»–Entityä¸ä¼šè§¦å‘æ­¤æ–¹æ³•

def OnViewEntityLeave(self, args):
    """Entityç¦»å¼€è§†å›¾ï¼ˆä¸å†æ»¡è¶³æ¡ä»¶ï¼‰"""
    entityId = args['entityId']
```

**æ€§èƒ½ä¼˜åŠ¿**ï¼š
- ä»…åœ¨Entityæ»¡è¶³æ¡ä»¶æ—¶è§¦å‘å›è°ƒ
- ä¸éœ€è¦æ¯Tickéå†æ‰€æœ‰Entity
- **CPUä½¿ç”¨ç‡é™ä½90%**

---

### ä¸éµå®ˆä¼šå¯¼è‡´ä»€ä¹ˆé—®é¢˜ï¼Ÿ

#### é—®é¢˜ï¼šæœåŠ¡å™¨TPSä¸‹é™

**é”™è¯¯ä»£ç **ï¼ˆæœªä½¿ç”¨RegisterViewï¼‰ï¼š

```python
class VIPServerSystem(ServerSystem):
    def Update(self):
        """æ¯Tickæ‰§è¡Œä¸€æ¬¡"""
        allEntities = serverApi.GetEngineActor()  # 1000ä¸ªEntity

        for entityId, info in allEntities.items():
            # æ£€æŸ¥æ˜¯å¦ä¸ºç©å®¶
            playerComp = serverApi.GetEngineCompFactory().CreatePlayer(entityId)
            if not playerComp.isEntityPlayer():
                continue  # 900ä¸ªéç©å®¶Entityè·³è¿‡

            # æ£€æŸ¥æ˜¯å¦æœ‰VIPç»„ä»¶
            vipComp = self.GetVIPComponent(entityId)
            if vipComp:
                # å¤„ç†VIPé€»è¾‘
                self.ProcessVIPPlayer(entityId)
```

**æ€§èƒ½æµ‹è¯•ç»“æœ**ï¼š

| åœºæ™¯ | ä¸ä½¿ç”¨RegisterView | ä½¿ç”¨RegisterView | æ€§èƒ½æå‡ |
|------|------------------|-----------------|---------|
| 100ä¸ªEntity | 20 TPS | 20 TPS | æ— å½±å“ |
| 500ä¸ªEntity | 18 TPS | 20 TPS | 11% |
| 1000ä¸ªEntity | 15 TPS | 20 TPS | **33%** |
| 2000ä¸ªEntity | 10 TPSï¼ˆå¡é¡¿ï¼‰ | 20 TPS | **100%** |

**åæœ**ï¼š
- æœåŠ¡å™¨å¡é¡¿ï¼ˆTPS < 20ï¼‰
- ç©å®¶ä½“éªŒå·®ï¼ˆå»¶è¿Ÿé«˜ï¼‰
- å¯èƒ½å¯¼è‡´æœåŠ¡å™¨å´©æºƒ

---

## âœ… æ­£ç¡®åšæ³•

### å®Œæ•´çš„RegisterViewä½¿ç”¨ç¤ºä¾‹

```python
# -*- coding: utf-8 -*-
import mod.server.extraServerApi as serverApi

ServerSystem = serverApi.GetServerSystemCls()

class VIPServerSystem(ServerSystem):
    """VIPç³»ç»Ÿ - ä½¿ç”¨RegisterViewä¼˜åŒ–"""

    def __init__(self, namespace, systemName):
        super(VIPServerSystem, self).__init__(namespace, systemName)

        # æ³¨å†Œè¿‡æ»¤å™¨ï¼šä»…ç›‘å¬VIPç©å®¶
        self.RegisterView(
            namespace, systemName,
            'Minecraft:player',  # å¿…é¡»æ˜¯ç©å®¶
            'YourMod:vip'        # å¿…é¡»æœ‰VIPç»„ä»¶
        )

        print("[VIPSystem] RegisterViewå·²æ³¨å†Œ")

    def OnViewEntityEnter(self, args):
        """
        VIPç©å®¶è¿›å…¥è§†å›¾ï¼ˆæ»¡è¶³è¿‡æ»¤æ¡ä»¶ï¼‰

        è§¦å‘æ—¶æœºï¼š
        1. ç©å®¶åŠ å…¥æœåŠ¡å™¨å¹¶æ‹¥æœ‰VIPç»„ä»¶
        2. ç©å®¶è´­ä¹°VIPåæ·»åŠ VIPç»„ä»¶
        """
        entityId = args['entityId']
        print("[VIPSystem] VIPç©å®¶è¿›å…¥:", entityId)

        # å¤„ç†VIPé€»è¾‘
        self.ApplyVIPBenefits(entityId)

    def OnViewEntityLeave(self, args):
        """
        VIPç©å®¶ç¦»å¼€è§†å›¾ï¼ˆä¸å†æ»¡è¶³æ¡ä»¶ï¼‰

        è§¦å‘æ—¶æœºï¼š
        1. ç©å®¶ä¸‹çº¿
        2. ç©å®¶VIPåˆ°æœŸï¼ˆç§»é™¤VIPç»„ä»¶ï¼‰
        """
        entityId = args['entityId']
        print("[VIPSystem] VIPç©å®¶ç¦»å¼€:", entityId)

        # æ¸…ç†VIPçŠ¶æ€
        self.RemoveVIPBenefits(entityId)

    def ApplyVIPBenefits(self, entityId):
        """åº”ç”¨VIPç‰¹æƒ"""
        # æå‡é£è¡Œé€Ÿåº¦
        attrComp = serverApi.GetEngineCompFactory().CreateAttr(entityId)
        attrComp.SetAttrValue(
            serverApi.GetMinecraftEnum().AttrType.MOVEMENT,
            0.2  # æå‡ç§»åŠ¨é€Ÿåº¦
        )

    def RemoveVIPBenefits(self, entityId):
        """ç§»é™¤VIPç‰¹æƒ"""
        attrComp = serverApi.GetEngineCompFactory().CreateAttr(entityId)
        attrComp.SetAttrValue(
            serverApi.GetMinecraftEnum().AttrType.MOVEMENT,
            0.1  # æ¢å¤é»˜è®¤é€Ÿåº¦
        )
```

**ä¸ºä»€ä¹ˆè¿™æ ·åšæ˜¯æ­£ç¡®çš„**ï¼š
1. âœ… **æ€§èƒ½ä¼˜åŒ–**ï¼šä»…å¤„ç†VIPç©å®¶ï¼Œä¸éå†æ‰€æœ‰Entity
2. âœ… **äº‹ä»¶é©±åŠ¨**ï¼šEntityæ»¡è¶³æ¡ä»¶æ—¶è‡ªåŠ¨è§¦å‘ï¼Œæ— éœ€è½®è¯¢
3. âœ… **ä»£ç ç®€æ´**ï¼šä¸éœ€è¦æ‰‹åŠ¨è¿‡æ»¤Entity

---

## ğŸ“š æ‰©å±•é˜…è¯»

### ç›¸å…³æ–‡æ¡£
- [æ€§èƒ½ä¼˜åŒ–å®Œæ•´æŒ‡å—.md - RegisterViewæ·±åº¦ä¼˜åŒ–](../../markdown/core/æ€§èƒ½ä¼˜åŒ–å®Œæ•´æŒ‡å—.md#2-registerviewæ·±åº¦ä¼˜åŒ–)
- [æ·±å…¥ç†è§£ECSæ¶æ„.md - Systemç”Ÿå‘½å‘¨æœŸ](../../markdown/core/æ·±å…¥ç†è§£ECSæ¶æ„.md#4-systemç³»ç»Ÿè¡Œä¸º)
- [é—®é¢˜æ’æŸ¥.md - é—®é¢˜14ï¼šSystemæœªä½¿ç”¨RegisterViewå¯¼è‡´æ€§èƒ½ä¸‹é™](../../markdown/core/é—®é¢˜æ’æŸ¥.md#é—®é¢˜14-systemæœªä½¿ç”¨registerviewå¯¼è‡´æ€§èƒ½ä¸‹é™)

### ç›¸å…³è§„èŒƒ
- Systemå¼€å‘è§„èŒƒç¬¬4æ¡ï¼šä¼˜å…ˆä½¿ç”¨RegisterView
- æ€§èƒ½ä¼˜åŒ–å»ºè®®ç¬¬1æ¡ï¼šé¿å…åœ¨Updateä¸­éå†æ‰€æœ‰Entity

### æ€§èƒ½åŸºå‡†æµ‹è¯•
- å‚è€ƒï¼š`æ€§èƒ½ä¼˜åŒ–å®Œæ•´æŒ‡å—.md` ä¸­çš„æ€§èƒ½å¯¹æ¯”è¡¨
````

---

## æ³¨æ„äº‹é¡¹

### 1. æ–‡æ¡£æŸ¥é˜…ç­–ç•¥

**æ™ºèƒ½é™çº§**ï¼š
```python
# ä¼ªä»£ç é€»è¾‘
def ReadCoreDoc(docName):
    # 1. ä¼˜å…ˆè¯»å–é¡¹ç›®å®šåˆ¶ç‰ˆ
    projectDoc = Read("../../markdown/core/" + docName)
    if projectDoc.exists:
        return projectDoc.content

    # 2. é™çº§è¯»å–ä¸Šæ¸¸åŸºçº¿ï¼ˆè½¯è¿æ¥ï¼‰
    baselineDoc = Read(".claude/core-docs/" + docName)
    return baselineDoc.content
```

### 2. è¾“å‡ºæ ¼å¼

âœ… ä½¿ç”¨Markdownæ ¼å¼åŒ–è¾“å‡º
âœ… åŒ…å«ä»£ç ç¤ºä¾‹ï¼ˆæ­£ç¡® vs é”™è¯¯ï¼‰
âœ… å¼•ç”¨å…·ä½“çš„æ–‡æ¡£ç« èŠ‚
âœ… æä¾›æ€§èƒ½å¯¹æ¯”æ•°æ®ï¼ˆå¦‚æœé€‚ç”¨ï¼‰

### 3. çŸ¥è¯†æ¥æº

âš ï¸ **ä»…å¼•ç”¨åˆæ³•æ–‡æ¡£**ï¼š
- âœ… `markdown/core/` ç›®å½•ä¸‹çš„æ–‡æ¡£
- âœ… `.claude/core-docs/` ç›®å½•ä¸‹çš„æ–‡æ¡£ï¼ˆè½¯è¿æ¥ï¼‰
- âœ… MODSDKå®˜æ–¹æ–‡æ¡£ï¼ˆåœ¨çº¿æŸ¥è¯¢ï¼‰
- âŒ ä¸å¾—å¼•ç”¨åˆ†ææŠ¥å‘Šæˆ–éå®˜æ–¹æ¥æº

---

## å®Œæˆæ ‡å‡†

è¾“å‡ºçš„è§£é‡Šå¿…é¡»åŒ…å«ï¼š
1. âœ… è§„èŒƒçš„å®Œæ•´æè¿°
2. âœ… æ·±å±‚åŸç†ï¼ˆæ¶æ„å±‚é¢çš„Whyï¼‰
3. âœ… é”™è¯¯ç¤ºä¾‹å’Œåæœ
4. âœ… æ­£ç¡®åšæ³•
5. âœ… æ‰©å±•é˜…è¯»é“¾æ¥

---

**å‘½ä»¤ç±»å‹**: çŸ¥è¯†æŸ¥è¯¢å‘½ä»¤
**é¢„æœŸæ‰§è¡Œæ—¶é—´**: 30-60ç§’ï¼ˆéœ€è¦è¯»å–å¤šä¸ªæ–‡æ¡£ï¼‰
**çŸ¥è¯†è¦†ç›–ç‡**: 95%ï¼ˆåŸºäºå®Œæ•´çš„å·¥ä½œæµçŸ¥è¯†åº“ï¼‰
